select distinct s.sql_text from gv$session l join gv$sql s
on (l.sql_id = s.sql_id and l.inst_id = s.inst_id and l.sql_child_number = s.child_number)
where l.osuser = 'canakalv' and l.machine='dc2prjasvap1021';


CREATE OR REPLACE FUNCTION get_stat (p_stat IN VARCHAR2) RETURN NUMBER AS
  l_return  NUMBER;
BEGIN
  SELECT ms.value
  INTO   l_return
  FROM   v$mystat ms,
         v$statname sn
  WHERE  ms.statistic# = sn.statistic#
  AND    sn.name = p_stat;
  RETURN l_return;
END get_stat;
/


SQL Monitor report:
SET SERVEROUTPUT OFF
SET AUTOT TRACE STAT
SET ARRAYSIZE 1000
alter session set "_sqlmon_max_planlines"=20000;

show parameter STATISTICS_LEVEL
show parameter CONTROL_MANAGEMENT_PACK_ACCESS

select /*+ MONITOR VIJAY_SPM_TEST1 */


SET AUTOT OFF

SET LINESIZE 200
COLUMN sql_text FORMAT A80

SELECT sql_id, status, sql_text
FROM   Gv$sql_monitor
WHERE   sql_text like '%VIJAY_SPM_TEST1%';


select s.sql_id, s.sql_child_number
from gv$session s, gv$sql l
where s.inst_id = l.inst_id and s.sql_id = l.sql_id and s.sql_child_number=l.child_number
and UPPER(l.sql_Text) like '%VIJAY_TEST%';

select l.sql_id, l.sql_text
from  gv$sql l
where 1=1
and UPPER(l.sql_Text) like '%VIJAY_SPM_TEST%';


set pagesize 0 echo off timing off linesize 1000 trimspool on trim on long 2000000 longchunksize 2000000
select DBMS_SQLTUNE.REPORT_SQL_MONITOR(
   sql_id=>'4rfkwbk6hnkaw',
   type => 'ACTIVE',
   report_level=>'ALL') as report
from dual;


select DBMS_SQLTUNE.REPORT_SQL_MONITOR(
   session_id=>sys_context('userenv','sid'),
   report_level=>'ALL') as report
from dual;





get_stat('session pga memory');

x/24 --> to look back x hours
x/(24*60)  --> to look back x minutes
x/(24*60*60) --> to look back x seconds


alter session set plsql_warnings='enable:all';
show param plsql_warnings
