smb://169.254.103.60/c$

dc2prwfn4arwb11/ 11.3.164.186:/adpr/listener_wfn4/xml/vijay # vi runsql.sql
wifi: 98007742
https://wfn-fit.nj.adp.com/public/index.htm
NKurtz@PPA10LSR11 / adpadp10
at&t wifi password: 98007742
sql server host: 51.20.145.189

select count(1) from tab;
\\dc01esisilon01-fs1.es.oneadp.com\cpsfileshare\dev

http://dc1prgcapp03.whc:6777/dbtoolkit.html  demo ADPdemo!

powercfg /hibernate off
smb://169.254.103.60/c$

WIRELESS CARD TICKET: 1922810  6/28 
office phone billing number: 870297113

https://confluence.es.ad.adp.com/display/AR/DataCloud+Coverage+Calendar
https://confluence.es.ad.adp.com/display/ADPTLM/Oracle+Client+32-bit+troubleshooting

jdbc:oracle:thin:@
oracle sales: 1 800 529 0165
\US152203
DQdq;123
custom catalog: http://cdladprdev04:8080/integration/#/custom
cdladprdev04  > scripts/generate_customs
\dev\ADPR\Nas_Customs\

wfc31q wfc32q wfc33q wfc34d wfc51q wfc52q wfc26q
wfc31d wfc32d

wfn app server: 11.3.164.186
Ent App server: 11.3.254.77
Vantage app server: 10.136.8.185   10.136.8.188

   fwdq8UC8  wczr70ZY  n5VtX084   rZXvL82v   -- fyT8BdcJ
mbugateway.esi.adp.com  11.129.59.39   vcanaka	11.129.34.168, 169
ssh vcanaka@11.129.34.168
11.3.35.85
11.3.35.86

catalog generator server on crw11d: 51.16.98.116


Superdome server and database info:
Chen, Ming (CORP): (6:05 PM)
ctclabsd (IP: 51.20.252.177); ORACLE_SID=dcr01y01, may need to export ORACLE_HOME=/app/oracle/product/database/1212/db2


sqlplus ADPIDMCORE01/ADPidw1pr0d@dc1prtlf4-scan.whc.dc01.us.adp:1521/cri11p_svc1
select count(1) from t_fact_payrl_tm;

sqlplus ADPIDMCORE01/adpidmcore01_y@cri11y
   
   I29IZ7JW (cdl)
   1vWNmsBw
   0Jq6e8Jm (I29IZ7JW)  L69p5NKC
   FXkOuOh8  z1jza9hz 
  
   FXkOuOh8  z1jza9hz
   0Jq6e8Jm
ls -lrt *INX.sql | sort -k 5 -n
dc: 4rO7HbUp / gz6Tt8Es :  rJemmz69
DC: T1EDwjWb    rJemmz69
l3v42I6t / 66R47WoX
18J69G40 / 869amxR9  FXkOuOh8
v121mx8x /cDZ7kW37  os04gQsU
z1jza9hz  qwzBRSh6
q6Rn7jHv
informatica Infor123
ct4u1u08


http://ukdihcmpfauthapi01dit1-dc1.ad.esi.adp.com:81/users/RUxFQkxJTi1BRFBS/tablepermissions
ORGOID  UK201312191752759

http://cdldvtitavap136.es.ad.adp.com:91/users/YmZsYWNr/tablepermissions
ORGOID  UK201312191752759



informatica fit: http://cdldvbivap0050.es.ad.adp.com:6007/administrator/#admin
51.20.147.79

Ent app  server: 11.3.254.77  11.3.250.69
MAS app server: 11.3.250.192
ssh canakalv@11.1.164.222

grep vpd_procedure *definition.xml | sed -e 's/<vpd_procedure>//' | sed -e 's/<\/vpd_procedure>//' | cut -d: -f2- | sed -e 's/$/\n\//'
find . -name *definition.xml | xargs grep vpd_procedure | sed -e 's/<vpd_procedure>//' | sed -e 's/<\/vpd_procedure>//' | cut -d: -f2- | sed -e 's/$/\n\/\n@t10.sql\n/'  > vj.sql

workorder.cbre.com
vijaya.canakala@adp.com
Passw@rd1
xPve@pnf2
  req: Request Number: S442297
yQxe#ldt1
Request Number: S474852

S420665
Stash Confluence Admins <Stash_Confluence_Admins@ADP.com>

BSM Users:
BPMUserADPR@ADPRWFN8C4 - BPM MAS PROD2
BPMUserADPR@ADPRWFN8C8 - BPM MAS PILOT
BPMUserADPR@ADPRWFN8C3 - MAS PROD1
BPMUserADPR@ADPRWFN8C6 - MAS PROD3

https://confluence.es.ad.adp.com/display/AA/Analytics+and+Lifion

Prod equivalant Vantage clients in DIT and FIT:
  TMOBILE DIT2
  GCA  IN FIT1   560k ps_job
GCA (FIT1 client is VANFITAC19)     
AllesPrac@VANFITAC19/adpadp11

<properties.oracle URL="jdbc:-Oracle:thin:@cdlpftbf1-scan.es.ad.adp.com:1521/cri02y_svc1" password="adpiv2" user="ADPIDMCORE01_M"/>

sqlplus adpidmcore05/dw1ipe70@Ctclbtaf3-scan.es.ad.adp.com:1521/cri05y
sqlplus ADPDC_VPD01/adpdcvpd013q@cdldftef1-scan:1521/cri03q_svc1


united mileage plus number: EC984176



IAT: 
sqlplus ADPIDMCORE01/iatdwADP1@cri11s
CRI11S=(DESCRIPTION =
    (ADDRESS_LIST = (LOAD_BALANCE = yes) (FAILOVER = ON)
    (ADDRESS = (PROTOCOL = TCP)(HOST = dc2rttmf9-scan.whc.dc02.us.adp)(PORT = 1521)))
    (CONNECT_DATA = (service_name = cri11s_svc1)))

	
UAT: 
sqlplus ADPIDMCORE01/DWs7emau@cri11u
TNS ENTRY:
cri11u =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (LOAD_BALANCE = off)
      (FAILOVER = ON)
      (ADDRESS = (PROTOCOL = TCP)(HOST = dc1prtkf7-scan.whc.dc01.us.adp)(PORT = 1521))
    )
    (CONNECT_DATA =
      (service_name = cri11u_svc1)
    )
  )

PROD:  UID/ PASS: 
sqlplus ADPIDMCORE01/ADPidw1pr0d@cri11p

TNS ENTRY:
cri11p_svc1 =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (LOAD_BALANCE = yes)
      (FAILOVER = ON)
      (ADDRESS = (PROTOCOL = TCP)(HOST = dc1prtlf4-scan.whc.dc01.us.adp)(PORT = 1521))
    )
    (CONNECT_DATA =
      (service_name = cri11p_svc1)
    )
  )


http://teamsites.adpcorp.com/Sites/ADPR/TEST/Forms/ADPR%202015%20MR4.aspx
select SYNONYM_NAME, TABLE_NAME from user_synonyms where synonym_name in
('MV_CATKEY','MV_CATTABLEROLE','MV_COLUMN_NO_LABEL','MV_LABEL_GENERIC','MV_LABEL_SPECIFIC','MV_RELAT','MV_TABLE');


alter session set ddl_lock_timeout=300;
exec PKG_REPORTING_MAINTENANCE.SWITCHTOBACKUPSET1MV;
exec PKG_REPORTING_MAINTENANCE.DROPMV;

@nextgen_col_ng_active.sql
@nextgen_col_ng_active152.sql
exec PKG_REPORTING_MAINTENANCE.DEPLOYMV;
exec PKG_REPORTING_MAINTENANCE.SWITCHTOLIVEMV;

select c.client_code, b.ver_code, I.INST_SID--, COUNT(1)
from catclient c, batclientproduct b, batclientenvironment e, BATINSTANCE I
where b.client_code = e.client_code
and c.client_code = b.client_code and c.pod_code = (select pod_code from batpod where pod_current = 't')
and b.prd_code = e.prd_code
AND e.inst_key = i.inst_key
and b.prd_code ='EET' --and b.ver_code = '185'
--and b.prd_code ='PAYX2' and b.ver_code = '185'
group by i.inst_sid;



Queue depth:
select * from batreq where req_status = 'REQ' and req_active = 't' and req_ext_run_id is null order by 4 desc;

Monitoring sql:
select count(*) from batsched b inner join qryquery q on b.qry_key = q.qry_key where b.SCH_NEXT_RUNTIME + 0.04 < sysdate and sch_status = 'active' and qry_active = 't'
and q.qry_status=90;


http://cdlldap1.nj.adp.com/ldap/passwdreset/
https://dc1plinux03.ga.adp.com/ldap/passwdreset/
http://10.5.135.24/ldap/passwdreset/
http://dc1plinux03.ga.adp.com/ldap/passwdreset/

ADPRQA202@QS01FIT1 / adpadp10
https://adpvantage-fit.nj.adp.com/
 ADPRDITUAUSER@adp adpadp30

 Global.Procurement@adp.com

 GIT: https://cdlprttnstash01.es.ad.adp.com/projects/AD

 IAT:
https://testvantage.adp.com/
user id : bbunny
pwd : ADPADP05

10.5.149.127
db server: 10.5.149.110
wfc21q, 22q

DIT Users for ADPR
Standalone ADPR admin user: ADPRDITADMIN@ADP/adpadp14
Environment URL: https://reportsdit.nj.adp.com/Reporting/index.do

Vantage UA admin user: SRASTOGIDITUA@ADP/adpadp10
Environment URL: https://adpvantage-dit.nj.adp.com

R13 Practitioner User ID/Pwd: ADPRQA@VANSIT4DIT/ adpadp10
Security Question Answers: Last word of the question

R13 Practitioner User ID/Pwd: SRASTOGI@VANSIT3DIT/adpadp10
Security Question Answers: last word of each question.


hyd party: srikanth 9000792936

TMS Standalone clients:

IAT:
https://wstms-iat.adp.com/public/index.htm
Practitioner (Admin) user: JCole@tmsiat5/adpadp12 (nickname, mothercity, fathercity)

UAT:
https://wstms-uat.adp.com/public/index.htm
Practitioner (Admin) user: JGembry@BVTNONVAN/adpadp14 (nickname, mothercity, fathercity)

Prod:
https://tms.adp.com/public/index.htm
Practitioner (Admin) user: JGembry@BVTNONVANP/adpadp14 (nickname, mothercity, fathercity)

https://wstms-fit.nj.adp.com/public/index.htm

Vantage fit url:
https://adpvantage-fit.nj.adp.com/public/index.htm

vjgreencard
india123
https://adp.fdbl.com/

If in the U.S., Form I-94#:	  53896275730

a)	https://reportsiat.adp.com
b)	https://wfn-iat.adp.com
c)	https://testvantage.adp.com
d)	https://intelligence-iat.adp.com

ADPR Active CO list:
http://sharepoint.adpcorp.com/Sites/ADPR/Lists/ADPR%20Work/COs%20Active.aspx

RC Website:
http://teamsites.adpcorp.com/Sites/HPS/Pages/HostingReleaseManagement.aspx

WFN Deployment Calendar:
http://teamsites.adpcorp.com/Sites/WFNReleases/Shared Documents/Roadmap/WFN 2015 Roadmap.xlsx

Vantage Deployment Calendar:
http://teamsites.adpcorp.com/Sites/HRIIUI/Lists/Calendar/calendar.aspx

TMS Deployment cal:
http://teamsites.adpcorp.com/Sites/WSCPTMSPDDevelopment/Release%20Planning/TalentMasterReleaseScheduleFY'16August262015.xlsx

'
PID
http://teamsites.adpcorp.com/Sites/PID


http://teamsites.adpcorp.com/Sites/HRIIUI/Shared%20Documents/Forms/AllItems.aspx?InitialTabId=Ribbon%2ERead&VisibilityContext=WSSTabPersistence

Vantage clients:
http://teamsites.adpcorp.com/Sites/HRII/QA%20%20Environment/Forms/AllItems.aspx
Vantage nextgen labels
http://teamsites.adpcorp.com/Sites/HRIIUI/Shared%20Documents/Forms/AllItems.aspx



sqlplus WN4OWNER/Aa1c_owner@ET767P

exec dbms_session.set_identifier('VIJAY_TEST_SESSION');
select client_identifier from v$session where sid = (select distinct sid from v$mystat);

Hints:
 /*+ OPT_PARAM('_unnest_subquery','false') */
 /*+ NO_MERGE(map) USE_HASH(map) */
 /*+ NO_MERGE ORDERED */
/*+ LEADING(TABLE1) NO_MERGE(TABLE1) NO_MERGE(TABLE2) NO_MERGE(TABLE3) */
QRY_INTERNAL_HINT             : /*+ LEADING(TABLE1) NO_MERGE(TABLE1) NO_MERGE(TABLE2) */
/*+ NO_MERGE LEADING(IT_TABLE2) */

MV backup pointing to what?


COS User:
This is a COS user so we can’t do a webservice call as it will always show the Client Org ID as FFFFFFFFFFFFFFFFFs.
CADAIR@ADP@CATALENTQ



migration sql:
select mtask_status, count(1) from migrationtask where mreq_key = 10700 <<from:manage migration tab>> group by mtask_status;

deploy a new migration server, deploy and setup in insight on the fly.



Vantage_EeTv8.0 Client:
iSI Client ID: QS02FIT2
COID: 05VFA9NY2D9PE5P8
DB Schema Owner: gd8owner
Password: hosting password
Data Source:
(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=cdldftaf2-scan.es.ad.adp.com)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=et801d_svc1) ) )

WFN_EeTv8.0 Client:
iSI Client ID: WFN8FITETI
COID: G3R8THZRGDZEAZHB
DB Schema Owner: wd8owner
Password: hosting password
Data Source:
(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=cdldftaf2-scan.es.ad.adp.com)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=et801d_svc1)))

Standalone eeTv8.0 Client:
iSI Client ID: EET80FIT2
COID: G3F7T09S0G2T25HB
DB Schema Owner: dh8owner
Password: hosting password
Data Source:
(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=OFF)(FAILOVER=OFF)(ADDRESS=(PROTOCOL=TCP)(HOST=cdldftaf2-scan.es.ad.adp.com)(PORT=1521)))(CONNECT_DATA=(service_name=et802d_svc1)))

select * from qryquery where qry_is_partner = 't' and qry_title like 'Invoice List Bill%' and qry_mode = 'SMP';

select distinct qry_title || '  ' || qry_is_partner || '  ' || qry_mode || '  ' || qry_status || '  ' || qry_active 
from qryquery q where qry_is_partner = 't'
and q.client_code = 'ADPADMIN'
--and qry_title like 'Invoice List Bill'
and qry_mode = 'STD'
and q.qry_status = 90  
and q.qry_active = 't' order by 1;





PAYX SMP Reports:
select count(1) as rptcnt  from qryquery q where q.client_code = 'ADPADMIN'
 and q.qry_mode = 'SMP'   and q.user_key in (select user_key from secuser where user_login = 'EDUK3ADMIN@ADP')
 and q.qry_status = 90   and q.qry_active = 't'   and q.qry_ext_templateid like '%WFN2%';

Vantage std reports:

select count( *)  from qryquery q where q.client_code = 'ADPADMIN'   and q.qry_mode = 'STD'   and q.user_key in (select user_key from secuser where user_login = 'FBRESSLER@ADP')   and q.qry_status = 90   and q.qry_active = 't'   and q.qry_ext_templateid like 'V153%';

select count(1) as rptcnt  from qryquery q where q.client_code = 'ADPADMIN'
 and q.qry_mode = 'STD' --and q.user_key in (select user_key from secuser where user_login = 'EDUK3ADMIN@ADP')
 and q.qry_status = 90   and q.qry_active = 't'   and q.qry_ext_templateid like 'WFN9%';


Custom catalog generation steps:
select * from spccustomclient where custom_key = 4381;
select * from spccustomclientcode where custom_key = 4381;
select * from spccustomsheet where custom_name = 'SYNOVUS';
select * from spccustomsheet where custom_name = 'SCHINDLER';

select * from release_vw where spc_key = 399;
select max(custom_key) from spccustomclient;


WFN std/smp REPORTS:
select q.qry_key
      ,q.qry_name
      ,q.qry_active
      ,q.qry_class
      ,q.qry_ext_templateid
      ,(select res_name from catresource where res_key = q.res_key) res_name
  from qryquery q
where q.client_code = 'ADPADMIN'
   and q.qry_mode = 'SMP'
   and q.user_key = (select user_key from secuser where user_login = 'EDUK3ADMIN@ADP')
   and q.qry_status = 90
   and q.qry_active = 't'
   and q.qry_ext_templateid like 'WFN9%'
order by 2,6,5;

infacmd.sh ping -dn Domain_FIT91

SELECT EXTRACT(HOUR FROM NUMTODSINTERVAL(sysdate - trunc(sysdate), 'DAY')) FROM DUAL;

check database:
historical sql, concurrent sessions,

/*+ NO_MERGE LEADING(IT_TABLE3) */

:e
Ctrl-Shift-6
:bd
:sh
:n :p

SELECT /*+ OPT_PARAM('_push_join_predicate' 'false') */
F5 monitor:
11.3.254.76/ReportingBE/F5monitor.php


Vantage SVN:
https://nad2d01.es.ad.adp.com/svn/HRCore/trunk/HRII2.0/VANDB2.06

TMS:
https://vantage-fit.nj.adp.com/public/index.htm 
JQS01FIT1@QS01FIT1  adpadp18
ADPR was developed in such a way that CRTClientRunReport users cannot access the wizard steps in order to build his own report.

Password for dbmaint user:    <first four characters of databasename>k01yagsdf9kwpx7wfz15od90lq
Dbadm    --  will be used to run Application related Maintenance activities.   Like upgrades, adpr privileges.
Dbmaint  --  will be used to run any database related activities like stats, backups…etc.,

C:\app\CanakalV\product\11.2.0\client_3\network\admin\tnsnames.ora
C:\app\CanakalV12\product\12.1.0\client_2\Network\Admin\tnsnames.ora

active cos: http://collaboration.adpcorp.com/sites/ADPR/Lists/ADPR%20Work/COs%20Active.aspx
PM Dashboard: http://collaboration.adpcorp.com/Sites/ADPR/ADPR%20Documents/PM/ADPR%20Dashboard.xlsx

$ srvctl status database -d etb63ddg
Instance etb63d01 is running on node cdldftef1db01
Instance etb63d02 is running on node cdldftef1db02
$  srvctl status service -d etb63ddg
Service etb63d_svc1 is running on instance(s) etb63d01,etb63d02


request id from report id:
select req_key, req_status, req_timestamp from batreq where qry_key IN 
(select qry_key from qryquery where qry_key_versionof = '1602205675670') order by 3 desc;

SQL> select regexp_substr('SMITH,ALLEN,WARD,JONES','[^,]+', 1, level) from dual
  2  connect by regexp_substr('SMITH,ALLEN,WARD,JONES', '[^,]+', 1, level) is not null;


REGEXP_SUBSTR
----------------------
SMITH
ALLEN
WARD
JONES


select sid from v$mystat where rownum = 1;

172.20.*.* are DC1

(dc1) 10.136.11.170  --> use this to connect to dc1 boxes

INSIGHTFITPILOT@crw01q_svc1
INSIGHTIATPILOT@cra01s_svc1
sqlplus INSIGHTPRDPILOT/INSIGHTPRDPILOT@cra02p

MIGRATIONREQUEST  :main table that hold each migration request from wfn
MIGRATIONTASK  :table that will have the list of clients for each request


grant DEBUG CONNECT SESSION to adpr_cruvpd;
grant DEBUG ANY PROCEDURE to adpr_cruvpd;

769362258
http://www.nxtbook.com/nxtbooks/americanpayroll/understandingyourpay2014/#/50

select
from catclient c, batclientproduct bc, batclientenvironment be
where c.client_code = bc.client_code
and c.client_code = be.client_code
and bc.prd_code = be.prd_code
and c.pod_code = (select pod_code from batpod where pod_current = 't')
and

https://rally1.rallydev.com/slm/login.op
rally: is...

http://hpsfs01.es.ad.adp.com/adpr/ADPReportingMASstats.pl
https://commonag-isihelpdesk-fit.nj.adp.com/

AdprPract@GDS2 
adpadp46
https://adpvantage-fit.nj.adp.com/public/index.htm


ADPR is https://reportsfit.nj.adp.com/Reporting/public/adp/ADPRFIT02_01
mjanjuak3admin@adp
adpadp16

mjanjuafitua@adp
adpadp16

https://wfn-dit.nj.adp.com/portal
https://wfn-fit.nj.adp.com/
mjanjuafitua@adp  / adpadp15
FITWFN6

pCanada@CANFITWFN6 / adpadp12

https://wfn-dit.nj.adp.com
practitionerCA@ADPR8CACAC/adpadp10



chase
https://commonag-portal-fit.nj.adp.com/wps/myportal

\\HPSFS01\dev\ADPR\db_work\mv_rebuild_steps\generic_steps


-- WFN5 long parsing issue  (adpdb00598170)
alter session set optimizer_features_enable='11.2.0.4';


select rawtohex(dbms_crypto.hash(dbms_metadata.get_ddl('PACKAGE', 'MY_PKG', 'MY_USER'), 2)) hashval from dual;

exec dbms_output.put_line('S:'||dbms_crypto.hash(utl_raw.cast_to_raw('SafePassw0rDABCDEFGHIJ'),dbms_crypto.HASH_SH1)||utl_raw.cast_to_raw('ABCDEFGHIJ'))

ADPR01.001TMS10
Evidence of Insurability
ADP Reporting support line (877-450-9102)

https://adprinsight.adp.com/
https://adprinsightiat.adp.com/

https://wstms-dit.nj.adp.com/public/index.htm

FTP Translations site:
http://ftp.boulder.sdl.com/
ADP b2GPPXc3

http://svn.es.ad.adp.com/svn/WFN_Backend/branches/WFN5.0-Aug/Database/migration/scripts/wfn2to45
https://adpcorp.skillport.com/skillportfe/bcs/SinglePassUserCmd.cfm?loginusername=bcsadmin&loginpassword=bcsadmin&username=V570548&password=ADPLEARN

Mail service 5534
Associate help desk: 18553878776

securityportal

stand-alone adp site testing: http://10.95.0.18:89/r124/Reporting
           z1jza9hz          qwzBRSh6
           q6Rn7jHv          8RDyK087
    LINUX: UQuq;123 Solaris: I8yJeyBi
    LINUX: uKlyeGBC  Solaris: grlxazNw
--- linux: wNaw9FrQ  Solaris: kobhw6o2
-- old: qNaw9FrQ   JH1UxEmr
--- older: 615QF1Jo   B28srulu

s_M_SECUSER_UPDATE_EMAIL_webadmin_crw21p.log
1qPiUbiV

glassfish server: http://localhost:4848/common/index.jsf

Qmo95c3t

172.20.17.124  IAT Etl server infor3456
51.16.67.112  CDLADPR00030
51.16.64.147 CDLADPR00031

MV Refresh steps: \\HPSFS01\dev\ADPR\db_work\mv_rebuild_steps\generic_steps

excel formula to find out mismatches between 2 lists:
=IF(ISERROR(MATCH(A1,$B$1:$B$64,0)),A1,"")


UMD IRA Account: U1088246
A1D ROTH IRA : U1188141
A1D: U1060263

8920821

LAN connection

alter session set "_always_semi_join"=choose;

NAS PROD SERVER:
UAT SERVER:


---vantage tms nas r12 dit
sqlplus ADPRNASR12DIT/ADPRNASR12DIT@CRW01D   ## 10.5.170.105
--nas vantage tms r12 catalog:
sqlplus adprnasr12fit02/adprnasr12fit02@crw01q  ## 10.5.170.103

10.22.129.88 FIT Informatica server infor infor1234


nagulaps  ADPadp##  sudo su -   ADPadp##   cd /tmp


tms password: qu3r4adpr0n14
amtrust 769362258

schm=${3%/*}
schmpass=${3#*/}

BPM USER:   BPMUSERADPR@ADPRBPMR12

WFN4SCH000010,0001,WFC10Q,105,G3EJ3N9WYY1DY73S,XBNAPA,04,WNVPD0014345,CA
WFN4SCH000010,0001,WFC10Q,105,G3EJ3N9WYY1DND0V,RIFCO,04,WNVPD0014281,CA

if [ `uname` = 'SunOS' ]; then
 echo "Solaris"
 dt=`truss /usr/bin/date 2>&1 | grep ^time | awk -F"= " '{print $2}'`
elif [ `uname` = 'Linux' ]; then
 echo "LInux"
 dt=`date +%s`
else
 dt=0
fi

echo -n "fdsdf" # for same line

infor@plpar00 /apps/crt/adprcc/fit]
/home/infor/wfn4/scripts/adpr_client_extns.sh WFC10Q PYXIR3 CRW01Q CRTQ01

http://10.5.172.93/Reporting/toolsStatus.do

URL for  Payx R18.56.00 = https://payx-fit3-app.nj.adp.com
URL for Portal MAS/NAS = https://commonag-portal-fit.nj.adp.com
FIT ADP Associate URL: https://commonag-isihelpdesk-fit.nj.adp.com/
ADP Client URL: https://netsecureqa.nj.adp.com/



http://10.95.0.66/svnimp/
vantage 2.0 svn server: https://nad2d01.es.ad.adp.com/svn/HRCore/trunk/HRII2.0/hriidb/adpr

fit app server; 10.5.172.104

ve servers
172.24.32.231 - prod
172.20.17.124 - VE IAT
10.22.129.88 -FIT


CDC Servers in Prod:
172.24.32.227  *
172.24.32.228
	sudo su - cdcadm
	HRB SOR update job
5 5,17 * * *  /ibmcdc01/UTIL/newpod/getclnt.sh crtp01 >> /ibmcdc01/UTIL/newpod/log/hrbgetclient.log 2>&1


HRB url: https://hrbfit600.nj.eease.com/login/


EV:
This is the call for client DOLE url:
dc2prnasarap05:~ # curl -Is http://enterprisehrxml.us.adphc.com/dolp/EAA42E9061108E50/webservices/getwebservices/getwsdl/
HTTP/1.0 302 Found
Location: https://downtime2.adp.com/EntHRXML/index.html
Connection: close
Content-Length: 0


=LEFT(H1,FIND("|",SUBSTITUTE(H1,">","|",LEN(H1)-LEN(SUBSTITUTE(H1,">",""))))-1)

PAYX QUERY SCREENS
http://payxdevlnx1.es.ad.adp.com/cgi-bin/payxdb/payxdbserver.pl?screen=cocodemenu&sysdb=pyxyr1&ng=NG&sr=0075&ccode=001


VANTAGE SQL TROUBLSHOOTING
===========================
C:\Users\canakalv\Desktop\WORK\vantate sql troubleshooting.sql
C:\Users\canakalv\Desktop\WORK\securitypkg.sql



( CAST( x AS DATE ) - CAST( y AS DATE ) ) * 86400

Pay Group & File Number:	RKH - 205105

SD TICKET:
db hosting
Hosting.DB.OracleADPR        DB Prod Incidents Shared Apps
Hosting.DB.Middleware.GenRequest   Middleware Eng DBA Ops
ES.ADPR.DevNASEnvironment    ADPR Dev NAS Environment
ES.ADPR.DevMASEnvironment
10159917
ADP Reporting Team

DIT:
sqlplus dbadm/DBADM@HRI02D
sqlplus dbadm/DBADM@T50400H
sqlplus dbadm/Hri01dDB@VAN01D
sqlplus dbadm/Hri01dDB@van03d
sqlplus dbadm/Hri01dDB@VAN22D

FIT:
sqlplus dbadm/Hri01dDB@VAN01Q
sqlplus dbadm/VanQ02D6@VAN02Q
sqlplus dbadm/VanQ02D6@cdldftif4-scan.es.ad.adp.com:1521/van02q_rpt1
sqlplus dbadm/Hri01dDB@VAN03Q
sqlplus dbadm/VanQ02D6@VAN02Q
sqlplus dbadm/Hri01dDB@van21q
sqlplus DBADM/DBADM@HRA02Q

IPE:
sqlplus dbadm/OP5jYmRm@van02y

IAT:
sqlplus dbadm/ct4u1u08@van01s_ar1
sqlplus dbadm/ct4u1u08@VAN01S_AR1
sqlplus dbadm/ct4u1u08@VAN03S
Van01IaT
sqlplus dbadm/ct4u1u08@HRA01S


sqlplus dbadm/ct4u1u08@PF001S


select regexp_replace(username, 'CR$', '') from all_users where username like '%CR' order by 1;

sqlplus dbadm/Van01UaT@van01u
sqlplus dbadm/Hri01dDB@van01q

sqlplus dbadm/ct4u1u08
sqlplus dbadm/pf4t1t12
sqlplus  dbadm/f1rew011

sqlplus dbadm/ct4u1u08@van1x01p_bsvc1
sqlplus dbadm/ct4u1u08@EVJT1Q01
sqlplus DBADM/Hri01dDB@VAN01D  -- vantage 1.09/2.00
sqlplus DBADM/DBADM@HRI02D    -- vantage 1.07

begin DBADM.SET_REPORTING_CONTEXT ('G3C1522Z3GAGSP4J','G3DS2XKZ46QAFDEP', (case '1' when '1' then '%ALL%' else '900004707:p' end), '3'); execute immediate 'alter session set "_always_semi_join
"=choose'; end;

Practitioner mode: https://adpvantage-fit.nj.adp.com
UA mode: https://adpvantage-fit.nj.adp.com/public/paas/admin/FIT003_NEXT

nas_user='dbadm'
if [[ $cprd_code = 'NAS' ]]; then
  nas_pass='ct4u1u08'
  inst_password='ca1c2d4f20c6a94dc70bffb36babc7dd'
elif [[ $cprd_code = 'PF' ]]; then
  nas_pass='pf4t1t12'
  inst_password='e5bdcf5acd1420f5a2e000638092cc37'
elif [[ $cprd_code = 'HRA' ]]; then
  nas_pass=' hr4t1t12'
  inst_password='161b2aac3f722828884e740e283e48f1'
elif [[ $cprd_code = 'EPS' ]]; then
  nas_pass='f1rew011'
  inst_password='38d6779e0c01306c8370947b63f6f58a'
else
  nas_pass='ct4u1u08'
fi

KLZ5P03
sqlplus skipvpd/skipvpdadpadp@pxc01y_svc1
connect skipvpd/skipvpdadpadp@pxc15p

sqlplus skipvpd/skipvpdadpadp@wft51p

vpd_sec_usr/adpadp@wfc52p_svc1
skipvpd/skipvpdadpadp@wfc52p_svc1
ggate/ggate@wfc52p_svc1
wfn_reports_05/adpadp@wfc52p_svc1
app_central/adpadp@wfc52p_svc1
wfnsys/adpadp@$sysdb
ngapp/adpadp@$sysdb


VE IPE BOX: 172.20.17.124
infor/infor12345

wfn migrations location:
\\stormtrooper\dev\ADPR\WFN\WFN2_WFN4_Migrations\111012_wfn2_wfn4


http://servicecatalog:8080/usm/wpf?Node=icguinode.catalogitemdetails&Args=10661&ObjectID=10661&NspPath=

bi:
sqlplus adpiv2_dit04/adpiv2@cri01d

set colsep ','
select sys_context('USERENV', 'CURRENT_SCHEMA') from dual;
sqlplus ADPR_KAYLORI2/ADPR_KAYLORI2@cru02q
sqlplus system/manager@HWS03D

IBM cdc CUSTOMER ID: 0654919
24x7 Production DBA Support Number at 770-871-3314

wfn4 ipe environment: https://wfn-ipe.nj.adp.com/
wfn fit environment: https://wfn-fit.nj.adp.com/
vantage fit portal:https://hrii-fit.nj.adp.com/public/index.htm

vantage roadmaps: \\nad2d04\Vantage Roadmaps
vantage svn:
For Vantage 1.07:
https://nad2d01.es.ad.adp.com/svn/HRCore/trunk/HRII1.0/hriidb/adpr

For Vantage 2.0:
https://nad2d01.es.ad.adp.com/svn/HRCore/trunk/HRII2.0/hriidb/adpr

etime fit:
http://51.16.4.19:9081/etlmbackendwar/systemCheck.jsp

etime version validation:
select max(productversion) from we1owner.kcsupgradehistory;


http://collaboration.adpcorp.com/Sites/DBA/Product%20Documentation/Etime/production/etime_all_tnsnames.txt
 https://analytics.adp.com/adpa/motm/dist/index.html - credentials analytics/Th1nk!

portal logins:
https://commonag-portal-fit.nj.adp.com/
TDixonfit2@adp
adpadp12

satishprodadmin@adp
adpadp04

https://wfn-iat.adp.com/public/adp/admin/PORTALWFN41
sumeetstgua@adp
adpadp22
last word of the question

sumeetstgadmin@adp
!2adpadp
know,manager,pet
ADPRUATAdmin@adp	pass5word

SatishUATAdmin@adp  Adpadp01 (exceeded # of attempts)
--------------- vantage uat test client--------------------
Baseline  client	UAT POD1/VANUAT2

URL for baseline and smoke	http://testadpvantage.adp.com
Forced URL UAT  POD1	http://testadpvantage.adp.com

Login Credential	Practitioner	berniepract@vanuat2	adpadp11	   Security answer: Pet, niece, nephew
	Manger	Berniemgr@vanuat2	adpadp03	   Security answer: Pet, niece, nephew
	ADP User	BKaranjaUAT@adp	adpadp15	   Security answer: Pet-jake, niece-joan, nephew-nephew
	Registration Code	VANUAT2-VANUAT2


---------------------------------------------------------------
ADPRStgAdmin@adp pass4word

CRTLog.log
VCanakalaProdAdmin@adp
Lanka123
VijayaQA@adp
Lanka123

Portal URL:HYPERLINK "https://wfn-iat.adp.com/portal/admin.jsp"https://wfn-iat.adp.com  
IAT UA User : 
AADPRStagUAUser@adp    adpadp15

KSatishStgAA@adp
adpadp08	  niece friend manager

https://adprwfndit.nj.adp.com/Reporting/index.do
https://reportsdit.nj.adp.com/Reporting/index.do
VijayDITAdmin@adp
adpadp02

satishk3admin@adp
adpadp04
  last word of question


adprstgadmin@adp
pass4admin

vijaya_canakala@adp.com
HGhg;123

CCole@TMSFIT2/adpisi123
skondapalliscipe@adp(adpadp01)
ESantiagoIPE@adp adpadp03

SQL> !sqlplus ggate/ggate@'(DESCRIPTION = (ADDRESS_LIST = (LOAD_BALANCE = yes) (FAILOVER = ON) (ADDRESS = (PROTOCOL = TCP)(HOST = dc2prf018db-scan.whc)(PORT = 1521))) (CONNECT_DATA = (service_name = cru40p_svc1)))'


select app_id, c, round(ratio_to_report(c) over ()*100, 1) as selectivity
from (select APP_ID, count(*) as c from ts_pe_ps_pt_admin_apps group by APP_ID)
order by c;




how to collect hwse refresh trace:
----------------------------------
alter session set statistics_level=ALL;
alter session set tracefile_identifier='HWSE_REG0116';
alter session set max_dump_file_size=UNLIMITED;
alter session set nls_date_format='MM-DD-YYYY HH24:MI:SS';
exec dbms_monitor.session_trace_enable(NULL,NULL,TRUE,TRUE);
now refresh

JS Latch:
---------
SELECT 'Sessions waiting for JS latch: ' NAME,
(SELECT COUNT(*) FROM gv$latch a, gv$session b
WHERE a.inst_id =b.inst_id AND a.latch#  =b.p2
AND a.name ='JS broadcast kill buf latch'
AND username='HWSE_ADMIN' AND b.status='ACTIVE' AND b.event ='latch free') COUNT FROM dual
UNION ALL
SELECT 'Active refresh sessions: ' NAME,
(SELECT COUNT(*) FROM gv$session WHERE username='HWSE_ADMIN') COUNT FROM dual
 ORDER BY NAME;

----VPD CALLS:

1. login to 10.5.170.105
2. cd /apps/listener/log
3. grep -li 1308496339028 *.log
  open the file
   search for 1308496339028
   then search for Procedure call


call tms8_sec_context_0004.set_app_cont('RTULLIS1@DELPHICORP','ER','G3ZDE5W5N6SBZ4E6','G3ETZHZTM5C000F5','WS_EMP_BASIC_INFO_VW_0004','','','0');

call tms10_sec_context_0005.set_app_cont('JGEMBRY@TMSDEMO2','ER','G38N21W51PAHH6W6','G3KMJ95NBH39JZZS','WS_EMP_BASIC_INFO_VW_0005','','','0');
call tms10_sec_context_0002.set_app_cont('DDonahueTWRUAT@TOWERUAT','ER','G3REXMSG09JX8RR5','G3334201GQJRRQHZ','','','','0');

call tms10_sec_context_0020.set_app_cont('DBINNINGER@SNAPON','ER','8B4CEA3CE0F02684','0F18AC8F6B8002AD','','','104652,104654','');


-------------wfn3
call vpd_sec_usr.sp_set_app_id('ADPR');

--------- wfn4
sqlplus WFN4SCH000021/pxtadpadp@wfc21q
call  sp_set_vpd_ctx(spv_vpd_key => '*', spv_bypass_sec => 'Y', spv_application => 'ADPR',spv_prod_locale =>'US');

sqlplus wfn4sch000141/pxtadpadp@wfc21p
call  sp_set_vpd_ctx(spv_vpd_key => '*', spv_bypass_sec => 'Y', spv_application => 'ADPR',spv_prod_locale =>'US');
select count(1) from ST_TAX_FEDERAL_GTL_SUISDI;
     93919

sqlplus adpr_cruvpd/cruvpd@wfc21p
call sp_set_vpd_ctx_0001(spv_vpd_key => '*', spv_bypass_sec => 'Y', spv_application => 'ADPR',spv_prod_locale => 'US');
select count(1) from wfn4sch000141.ST_TAX_FEDERAL_GTL_SUISDI;
     93919

-- for wfn3
sqlplus WFN4SCH000141/pxtadpadp@wfc21y
call  sp_set_vpd_ctx(spv_vpd_key => '*', spv_bypass_sec => 'Y', spv_application => 'ADPR', spv_prod_locale =>'US'););



sqlplus WFN4SCH000021/pxtadpadp@wfc21q
call  sp_set_vpd_ctx(spv_vpd_key => '*', spv_bypass_sec => 'Y', spv_application => 'ADPR',spv_prod_locale =>'US');


sqlplus webrepadmin/webrepadmin@cru06q
sqlplus CLIENTONEQUERY/query@wsp01q   -- QH01FIT2
sqlplus TMSQUERY/query@wsp01q         -- SIT2
sqlplus TMSONEQUERY/query@wsp01q      -- TMSQA1
sqlplus TMSTWOQUERY/query@wsp01q      -- TMSFIT3
sqlplus TMSTHREEQUERY/query@wsp02q    -- TMSFIT1

sqlplus webrepadmin/webrepadmin@crc01s
sqlplus tmsquery/query@wsp01s   --IATVAN04
sqlplus tms2query/query@wsp01s  --TMSIAT3
sqlplus tmsq3uery/query@wsp01s  --PENVAN03
sqlplus tms4query/query@wsp01s  --PENVAN04

sqlplus webrepadmin/webrepadmin@hrc11y
sqlplus TMS81QUERY/query@qaprf_11ee_t1  -- TMSFIT2


sqlplus dbadm/VanQ02D6@VAN02Q_BSVC1
QN09

IPE Stuff:
---------
sqlplus webrepadmin/webrepadmin@hrc11y
sqlplus cruvpd/cruvpd@qaprf_11ee_t1
sqlplus TMS81QUERY/query@qaprf_11ee_t1
DBLINKHRC11YTOQAPF1ET1

CALL EET7_SEC_CONTEXT_0001.SET_APP_CONT('ETLMI446@64EETTLM44','ER','G30NK0NQZ9Z1XV1C','G3SZPMKPB9Q8BW92','');
call tms8_sec_context_0004.set_app_cont('JGEMBRY@TMSFIT3','ER','G3S815BDNZE89BTA','G341N9H4DCFMJ5XE','WS_EMP_COMP_PROFILE_VW_0004 WS_COMP_EVAL_VW_0004','','','0');

call ts_peo_sec_context.set_app_context('ASALAZAR@P83TEST','ER','G3GZG0ZXGFT5K836','G3X4JDQ85W8XDVYF','PEO_CHECK_DATA.CHECK_DT#=#PEO_CHECK_DATA.CHECK_DT,PEO_CHECK_DATA.PAYGROUP#=#''P83''');

call ts_peo_sec_context.set_app_context('AMCMANIS@P83TEST','ER','G3W4CJ9YWN7TD5ZR','G3X4JDQ85W8XDVYF','PEO_YTD_INFO.PAYGROUP#=#''P83'',PEO_YTD_INFO.FILE_NBR#=#''000266''');

call payx_r185_sec_context_0187.set_app_context('VJacobs@HandT','ER','PX185_CHK_COMBO_VW_0187
  PX185_EMPLOYEE_VW_0187',
 'PX185_CHK_COMBO_VW_0187.COMPANY_CODE#IN#(''RY9,RZD''),
 PX185_CHK_COMBO_VW_0187.PAY_DATE#>=#TO_DATE(''09/01/2012'', ''MM/DD/YYYY''),
 PX185_CHK_COMBO_VW_0187.PAY_DATE#<=#TO_DATE(''11/30/2012'', ''MM/DD/YYYY'')',
 'PX185_EMPLOYEE_VW_0187.PAYROLL_CYCLE#=#''N''','PX185_EMPLOYEE_VW_0187.EFF_DATE#=# TO_DATE(''12/03/2012'', ''MM/DD/YYYY'')')
;

select payx_r185_pol_for_View_0187.cocode_filter_for_view('a','b') from dual ;



exec isiwsinterfacetest.getclientresourcegroups('CANFITISTA');
exec isiwsinterfacetest.DELETEclientresourcegroup('BAUER123', 'ADPRFIT04_01');
exec isiwsinterfacetest.ADDclientresourcegroup('BAUER123', 'ADPRFIT02_01');

SET SERVEROUTPUT ON
DECLARE
  P_CLIENTID varchar2(100) default 'R0079C505';
  ORGOID      VARCHAR2(200);
  URL         VARCHAR2(200);
  PRODUCTCODE VARCHAR2(200);
  CTYPE       VARCHAR2(200);
  CRG1        isiWSInterface.TABTYPCLIENTRESOURCEGROUPS;
  v_Return    VARCHAR2(1000);
  v_ws_endpoint VARCHAR2(2000);
  cnt NUMBER DEFAULT 0;
BEGIN
  crg1     := isiWSInterface.tabtypClientResourceGroups();
  SELECT VALUE into v_ws_endpoint FROM config_pod_mapping WHERE id = 'WS_ENDPOINT';
  v_Return := isiWSInterface.getClientResourceGroups( CLIENTID => P_CLIENTID, ORGOID => NULL,
     URL => v_ws_endpoint, PRODUCTCODE => 'CRT', CTYPE => 'App', CRG => CRG1 );

  if (v_Return like 'NO RESOURCE GROUPS') then
      dbms_output.put_line(v_return);
      RETURN;
  END IF;
  IF (v_Return LIKE 'ERROR%') THEN
      dbms_output.put_line(v_Return);
      RETURN;
  END IF;
  IF CRG1.COUNT > 0
  THEN
    FOR i IN crg1.first .. crg1.last
    LOOP
      cnt := cnt + 1;
      dbms_output.put_line(p_clientid || ':' || crg1(i).resourceGroup);
    END LOOP;
  END IF;
END;
/


call ts_peo_sec_context.set_app_context('NCONN@EZV001','ER','G2ZGBPRKWDG0007W','G2ATYR3E2MQ00001','');

SELECT * FROM client_config_cmds WHERE clnt = 'TAYLORPR';
DELETE FROM client_config_cmds WHERE clnt = 'TAYLORPR';
COMMIT;
exec configure_isi_client.populate_client_config_cmds('G37A054N1094EVQR', '0');


Benefits portal url:
<https://hwsebenefits3.adp.com/benefitsOperations/benefitsPortal


Insight DIT:
https://adprinsightdit.nj.adp.com/AdprInsight/strong/insightHome.jsp

c20 box: 10.17.40.237


/var/spool/cron/atjobs
sqlplus webrepadmin/Crc01UaT@crc01u_van1
sqlplus webrepadmin/crc01Pr0d@crc01p_van1


webreppod@crc02q   wfn3.1 fit

CRTClientRunReport.sql on etl2 box bin directory

https://intelligence-fit.nj.adp.com
JKells@IEEE
adpadp11
BES is major accounts. TS is not major accounts.


webservice endpoints:
dit: http://10.5.125.146/services/jaxws/ISIJWSClientService
iat: http://172.24.208.104/services/jaxws/ISIJWSClientService
FIT: http://10.5.125.208/services/jaxws/ISIJWSClientService
prod: http://172.20.176.65/services/jaxws/ISIJWSClientService

Environment 	DNS (Use This) 	            F5 IP (New)
Dev 1 (7.5) 	netsecuredev1.ws.nj.adp.com 10.5.100.141
Dev 2 (7.0) 	netsecuredev2.ws.nj.adp.com 10.1.129.219
Dev 3 (7.10) 	netsecuredev3.ws.nj.adp.com 10.1.129.232
K0 	            netsecureeng.ws.nj.adp.com 	10.5.125.209
DIT          	netsecuredit.ws.nj.adp.com 	10.5.125.146
FIT/K3 	        netsecurefit.ws.nj.adp.com 	10.5.125.208
IPE 	        netsecureperf.ws.nj.adp.com 10.5.26.13
FIELD 	        netsecurefld.ws.nj.adp.com 	10.5.125.96
iAT 	        netsecurestaging.ws.adp.com 172.24.208.104
uAT 	        netsecureuat.ws.adp.com 	172.24.44.63
Production 	    netsecure.ws.adp.com 	    172.20.176.65

PROD: http://splunkprod.splunk.whc.dc01.us.adp/
https://adprdithrii.nj.adp.com/Reporting/index.do

https://adprwfnfit.nj.adp.com/Reporting/CRTLog.log

SVN:
http://10.95.0.66/svnadpi/trunk/app/ADPIntelligence
vcanakala/ADPadp11

catcolumn.col_size
# chars * 0.0819 = inches

PROD UA login
https://workforcenow.adp.com/public/index.htm
ADPRPRODUAUSER3@ADP/adpadp11--US(Mustafa)
adprproduauser@adp
adpadp02


ADPR-WFN-PROD URL:  https://workforcenowreporting.adp.com
select prd_code ||','||ver_code||','||attribute||','||value from CATVERSIONPARAM;

sqlplus webrepadmin/webrepadmin@cru06q   -- DIT HRII/WFN3 Catalog
-----wfn3 stuff----
webrepadmin@crc02d



with wfn_sysdb_clients as (
select upper(isi_client_id) client_code, organization_oid
from wfnsys.v_client_logon@dblinkcru40ptopxs01p
where id_code = parent_code
and schema_version like '10%'
)
select 'WFN4_PROD' pod, count(distinct c.client_code)
from webrepadmin.batclientproduct@dblinkcru40ptocrw11p bcp,
     webrepadmin.catclient@dblinkcru40ptocrw11p c
where bcp.client_code = c.client_code
and c.pod_code = 'WFN4_PROD'
and bcp.prd_code = 'WFN' and bcp.ver_code = '10'
and c.client_code in (select client_code from wfn_sysdb_clients)
union
select 'MAS_PROD1' pod, count(distinct c.client_code)
from ADPRMASPRD01.batclientproduct@dblinkcru40ptocrw11p bcp,
     ADPRMASPRD01.catclient@dblinkcru40ptocrw11p c
where bcp.client_code = c.client_code
and c.pod_code = 'MAS_PROD1'
and bcp.prd_code = 'WFN' and bcp.ver_code = '10'
and c.client_code in (select client_code from wfn_sysdb_clients)
union
select 'MAS_PROD2' pod, count(distinct c.client_code)
from ADPRMASPRD02.batclientproduct@dblinkcru40ptocrw12p bcp,
     ADPRMASPRD02.catclient@dblinkcru40ptocrw12p c
where bcp.client_code = c.client_code
and c.pod_code = 'MAS_PROD2'
and bcp.prd_code = 'WFN' and bcp.ver_code = '10'
and c.client_code in (select client_code from wfn_sysdb_clients)
union
select 'MAS_PROD3' pod, count(distinct c.client_code)
from ADPRMASPRD03.batclientproduct@dblinkcru40ptocrw13p bcp,
     ADPRMASPRD03.catclient@dblinkcru40ptocrw13p c
where bcp.client_code = c.client_code
and c.pod_code = 'MAS_PROD3'
and bcp.prd_code = 'WFN' and bcp.ver_code = '10'
and c.client_code in (select client_code from wfn_sysdb_clients)
;

POD                         COUNT(DISTINCTC.CLIENT_CODE)
--------------------------- ----------------------------
MAS_PROD1                                          13507
MAS_PROD2                                          21637
MAS_PROD3                                          12820
WFN4_PROD                                          12723








iat:
  sqlplus webrepadmin/webrepadmin@crc02s
  sqlplus WFN3SCH000062/pxtadpadp@wfc01s
  sqlplus ggate/ggate@pyxrr1
  select count(1) from wfnsys.v_client_logon;

iep:

qa:
  sqlplus webrepadmin/webrepadmin@crc02q
  sqlplus WFN3SCH000001/pxtadpadp@wfc03q



VE dit:
https://adprwfndit.nj.adp.com/Reporting/index.do
VijayDIT@VEDemoWEST
adpadp11

Vantage DIT env:
https://adprdithrii.nj.adp.com/Reporting/index.do

VCankala@R1ADPR
adpadp11

logi iat box: 172.20.242.209


hrii qa:
https://adprfithrii.nj.adp.com/Reporting


https://adprqa.nj.adp.com/webreppilot/Reporting/index.do
https://adprqa.nj.adp.com/hrb/Reporting/index.do
User:rajbodducsr@adp  adpadp777
rajbodduadp@adp  adpadp777
vnemooriadp@adp - adpadp777

https://testvantagereporting.adp.com/Reporting/index.do

https://stgreporting.adp.com/Reporting/index.do
adpreportingstag.adp.com
adpreportingstag1.adp.com
CRTStagAdmin@adp  adpadp999
VishnuStag@adp - adpadp103

https://wfn-iatreporting.adp.com/Reporting/index.do
Userid: ADPRStgAdmin@adp
Install pwd: adpadp
Login pwd: pass4word




https://adprwfndit.nj.adp.com/Reporting/index.do
50CFIT0060USER2@CCEPERF
adpadp03

10.5.172.59   : FIT WFN3 Listener server


configuring client:
exec configure_client('TESRDL', '1', '','t', '_0001', 'WFN', '3', 'f', '');
exec configure_client('TESRDL', '1', '','t', '_0001', 'WFNPAYX', '3', 'f', '');
exec configure_client('TESRDL', '1', '','t', '_0001', 'WFNEZLM', '3', 'f', '');
commit;

IPE:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
single url: https://reportsipe.nj.adp.com

http://51.16.69.239/Reporting

ADMIN + [SHIFT] + ENTER

emulate the user you want


wfn4:  sqlplus webrepadmin/webrepadmin@crw21y_svc1
wfn3.1: sqlplus  webrepadmin/webrepadmin@crc02y
hrii: sqlplus  webrepadmin/webrepadmin@hrc11y_svc1

crw21y=(DESCRIPTION = (ADDRESS_LIST = (LOAD_BALANCE = yes) (FAILOVER = ON) (ADDRESS = (PROTOCOL = TCP)(HOST = cdlpff011db-scan.intperf.prod.whc)(PORT = 1521))) (CONNECT_DATA = (service_name = crw21y_svc1)))

hrc11y=(DESCRIPTION = (ADDRESS_LIST = (LOAD_BALANCE = no) (FAILOVER = ON) (ADDRESS = (PROTOCOL = TCP)(HOST = 10.5.32.63)(PORT = 1521)) (ADDRESS = (PROTOCOL = TCP)(HOST = 10.5.32.65)(PORT = 1521))) (CONNECT_DATA = (service_name = hrc11y_svc1)))


WFN 4 IPE ENV:  https://adprwfn4ipe.nj.adp.com
default pod: ADPR-WFN4-IPE

HRII-IPE - ADPRIPE01_01
===================
Direct URL : https://adpripehrii.nj.adp.com
10.5.13.56 10.5.13.57 10.5.13.58 10.5.13.59  Port: 80

WFN3-IPE - ADPRIPE02_01
=====================
Direct URL: https://adprwfnipe.nj.adp.com
10.5.78.66 10.5.78.67   Port: 80

WFN4-IPE - ADPRIPE02_02
=====================
Direct URL : https://adprwfn4ipe.nj.adp.com
51.16.69.239  51.16.69.232  Port: 80




name change / security change: only those can affect standard (std) reports.


Nightly ISI job:
/apps/crt/isi/tables/install_isi_standard_tables.sh crtp01


User: adprditadmin@adp
Install Pwd: adpadp
Login Pwd: adpadp03

MHOLTRY5159@EZV
adpadp321

ADPI:
https://intelligence-dit.nj.adp.com/
https://intelligence-fit.nj.adp.com/
https://intelligence-iat.adp.com/
https://intelligence.adp.com/

----------------------------
https://webmail2.es.ad.adp.com/owa/
sqlplus ggate/m00sewyo@PEOD01
sqlplus ggate/M00sewyo@PEOQ01
a88ylane
DBLOGIN userid ggate@peop01, password a88ylane

userid ggate@cru20p, password ggate


PEOD01   PEOQ01   ASOD01  ASOQ01

logi server cdl003: 10.5.170.203
Administrator/ADPadp11
LogiXML/LMXigoL;123

logi server FIT cdladpr012: 10.5.170.212


India DBA Hotline:(734) 205 3314
4497396 9700 setup ticket itsc

orapki wallet display -wallet ewallet.p12 -summary
oracle@2008

orapki wallet display -wallet ewallet.p12 -summary
orapki cert display -cert newhrbcert.cer -complete
orapki wallet add -wallet ~/hrb_r25/baseline_cdc/hrb_ws/install/  -trusted_cert -cert newhrbcert.cer
orapki wallet display -wallet ewallet.p12 -summary
orapki wallet add -wallet ./  -trusted_cert -cert newhrbcert.cer

orapki wallet add -wallet /home/canakalv/test -trusted_cert -cert /home/canakalv/test/new/newhrbcert.cer -pwd oracle@2008

orapki wallet add -wallet /home/oracle/wallet -trusted_cert -cert <cert full path> -pwd oracle@2008

=CONCATENATE("UPDATE catcolumn SET col_askatruntimesql ='", c1, "' WHERE tab_code = '", A1, "' AND col_code = '",B1,"';")

=CONCATENATE("SELECT '", A1, "', COUNT(1) FROM ", A1,";")
=CONCATENATE("SELECT * FROM ", A1,";")
=CONCATENATE("CREATE TABLE ", A1, " AS SELECT * FROM &&source_schema..", A1,"@&&dblink;")
=CONCATENATE("SELECT distinct  '", A1, "', vpd_key  FROM ", A1,".security_user WHERE upper(user_id) like '%DIOOFSAC' order by 1, 2;")

select tname from tab where tabtype = 'TABLE' order by 1;

typeset -r cfgfile=${0%.*}.cfg

sqlfile=${0%.sh}.sql
logfile=${0%.sh}.log
echo > $sqlfil

webrepadmin@CRU07D_SVC1

wfn3 catalogs
DIT
webrepadmin/webrepadmin@crc02d
FIT
webrepadmin/webrepadmin@crc02q


=CONCATENATE("'",A1,"'",",")


NAS PROD URLS:
https://adpreporter.adp.com/Reporting/index.do
https://adpreporter1.adp.com/Reporting/index.do
https://adpreporting1.us.adp.com/Reporting/index.do


TMS FIT:
TMSFIT14 is a stand-alone Talent client in the FIT environment, on PAAS v2.3.4 (FIT003_NEXT).
Here is the URL:  https://wstms-fit.nj.adp.com/public/index.htm
A practitioner user is jgembry1@tmsfit14/adpadp22 (nickname, mothercity, fathercity)


informatica:
canakalv/vijay123


select 'SELECT '''|| USERNAME || ''', COUNT(1) FROM ' || USERNAME ||'.USER_TAB;'
FROM all_users where username like 'EZLM_REG%_POD02' ORDER BY 1;


https://adprqa.nj.adp.com/hrb/Reporting/tools.do
http://sharepoint.adpcorp.com/Sites/ADPR/ADPR%20Integration%20Doc%20Library/ADPR%20Integration%20Releases.xlsx

License # = C0VMGR40C522X61YD838V675GFMQZ0FGGSE3W-111-307-647-BD
Site Message - AUTOMATIC DATA PROCESSING INC
please make sure not to copy any additional spaces before or after each section.

toad datamodeller:
==================
License # = BZ8GUN8J73WK00U180ARSRAAVBGYK022CNKA1-111-307-754-2E
Site Message - AUTOMATIC DATA PROCESSING INC
please make sure not to copy any additional spaces before or after each section.



DavidGivens.. Portal.



Stormtrooper:
 \\10.22.128.110\dev\ADPR

iot tables are not replicatable. They need to be bulk-loaded only.

Raja@etl@2
http://roseicsdrtcqw1/cqweb/#/7.1.0/adpdb/RECORD/adpdb00335851&noframes=true&format=HTML&recordType=Defect
benefit plan summary:
   https://corpintra4.adpcorp.com/protected/flex/flex_pel_plan_comparison_sheet.asp

Logs file is generated with name *.log in the respective directory.
Check the generated .log file for any errors and notify roseland_cr_dev_group@adp.com if you see any errors.
Contact info:
  vijaya_canakala@adp.com   862-485-1895
	rajasekhar_boddu@adp.com  732-447-3719
  krithika_venkatesan@adp.com 848-250-9000
	vishnu_nemoori@adp.com 201-923-0010




10.17.132.23
showrev -p


sz=$(perl -e "print ((stat('$tnsfile'))[7])")
perl -pi.bak  -e 's/crtp01/cru40p/gi' *.sh
perl -ane 'print "SELECT * FROM DUAL\@$F[4];\n" if /dblinkcru40p/i' a.txt
ls -l | perl -F"\." -lane 'print $F[1]' | sort | uniq     ### this gives unique extensions in current directory

perl -F@ -ane 'print "SELECT * FROM DUAL\@$F[1];\n" if /dblinkcru40p/i' a.txt
perl -pi -e 's/newadprcc/adprcc/i' *.sh
perl -pi -e 's/\r\n/\n/g' *



R17 Hotfix
\\rosepisid6017b\CRUShare\Deployments\ADPR.PAYX.CAT.17.27.01\CatalogView
R185 Hotfix
\\rosepisid6017b\CRUShare\Deployments\ADPR.PAYX.CAT.R185.05.03\CatalogView
/apps/crt/payx/r17/views/v27.01
/apps/crt/payx/r185/views/v5.01


SELECT DISTINCT target_schema_name
FROM   adpr_client_extensions
WHERE  source_repl_instance = 'pxc05p_svc1'
AND    source_schema_name = 'VPDCLSCH0040000066'



crtp01=dc2prcrptdb1, crtp02=dc2prcrptdb2, crtp03=dc2prcrptdb3,crtp04=dc2prcrptdb4,crtp05=dc2prcrptdb5,crtp06=dc2prcrptdb6
cru03p=cru04p=dc2prf002db04 and dc2prf002db05,
cru10p=dc2prf004db01


8897802862
    00888546
    00888546
973-402-9112
    loan servicing questing regarding taxes..
new linix dev box: 10.17.132.35  crtlnxdev01

att: 438773342254 fedex
https://btobshop2.barnesandnoble.com/account/op.asp?x=1922104 : 129704911
\\stormtrooper\DEV\
nohup loop_longops.sh 2>&1  >/dev/null &

10.173.67.182  --> prasad's ip
10.60.222.102  --> don's ip


my ip: 10.1.141.53
vijetha: 732-668-6913

172.24.32.216  ggsvr01p
qa: 10.5.6.97
/ggate01/dbtools/payx/r18

gg servers:
gg server1:  172.24.32.206

cdcadm@dc2prcrptcdcap1
172.24.32.227   /ibmcdc01/UTIL/newpod

payx:
172.24.32.208
172.24.32.209

ezlm:
172.24.32.206
172.24.32.207
172.24.32.208
172.24.32.209
New servers: 11.3.149.8, 11.3.149.13, 11.3.149.14, 11.3.149.141
IAT :
payx
172.21.17.100

\\HPSFS01\dev\ADPR\db_work\mv_rebuild_steps\generic_steps

useradd -g dba hwseadmin
mkdir /home/hwseadmin
chown hwseadmin:dba /home/hwseadmin
passwd hwseadmin
hwse1234

groupadd crtgrp
useradd -g crtgrp cvsadmin
mkdir /home/cvsadmin
chown cvsadmin:crtgrp /home/cvsadmin
passwd cvsadmin

cvs co CVSROOT/modules
vi CVSROOT/modules
cvs ci -m "Module setup WFN7" CVSROOT/modules
cvs import -n -m "Import WFN7 basecode" wfn7
cvs rtag ADPR_16_000_WFN_03_000 wfn3
cvs tag -R 'ADPR02_001WFN07' wfn7/

 cvs [commit aborted]: could not open lock file /home/cvsadmin/r/wfn5/views/,tmp_plans.sql,: Permission denied
--> Check the views directory permission. It should have g+w


cvs update -j 1.7 -j 1.5 oldfile   --> to get older version of file and be able to commit
cvs update -r 1.5 oldfile          --> STICKY get older version of file and not allowed to commit/update it
cvs status oldfile
cvs update -A oldfile      --> clear stickty tag and get full update of the file.


Also do this:
  find $CVSROOT -type d -exec chmod g+sw {} \;

 sd ticet: 7684026

Brazil CVS:
:pserver:canakalv@10.95.0.66:/cvsroot
adpadp01
:pserver:canakalv@51.16.6.102:/r

Brazil SVN:
User: vijay
Pass: adpADP11@
http://10.95.0.66/svnimp/


How I started the cvs server:
---------------------------
export HOME=
cd /etc
ls xinetd.conf
2401 stream tcp nowait cvsadmin /usr/local/bin/cvs cvs -f --allow-root=/home/cvsadmin/r pserver

/etc/rc.d/xinetd restart
ls /etc/cvsnt/PServer
/usr/local/bin/cvslockd
netstat -na | grep 2401
netstat -na | grep 2402

when the service is running, you should have below o/p:
netstat -na | grep 2401
tcp        0      0 0.0.0.0:2401            0.0.0.0:*               LISTEN

use below commands to start it:
/etc/rc.d/xinetd restart
/usr/local/bin/cvslockd  -> you need to start lock deamon also.



/* initial onetime setup
mkdir /home/cvsadmin/r
cvs -d /home/cvsadmin/r init
chmod -R 777 /etc/cvsnt
cvsbkp
*/

create role qs02cr_role;
grant clientrole, qs02hp_role, role_developer to qs02cr_role;
grant qs02cr_role to dbadm;


////////////////// application///////////////////////
/apps/listener/conf/database.properties


payx 185: ngapp.client_database
wfn9: wfn_client  table
  schema_id  points to where client resides.
Admin tool.

-- Related files 15.3 changes renaming existing file.
--  company_options_sql, company_options_mapping

select * from catversionparam where prd_cdoe = 'WFN';
select * from catresource;
select * from catresourcetabe;
select * from catresourcesessionval;  --> create a record for valname
select * from catcolumn where col_restrictiongroup = 'PAYROLL';


reg12y_svc1

dataSource =isildap:172.24.32.158:2100
userName = cn="Directory Manager"password = th1nkPAT
begin DBADM.SET_REPORTING_CONTEXT ('G5DUL8ZT95YC5XVQ','G5TDB84JC001JMT4',
(case '0' when '1' then '%ALL%' else '2200431009:e,1200000301:p,2200478737:p' end), '3');
execute immediate 'alter session set "_always_semi_join"=choose'; end;
/


SELECT DISTINCT client_code FROM curr_isi_client_load WHERE client_code IN (
SELECT Upper(isi_client_id) FROM wfnsys.v_client_logon@dblinkcru40ptopxs01p WHERE id_code = parent_code AND schema_version LIKE '09%'
MINUS
SELECT DISTINCT '''' || client_code, client_orgoid FROM (
SELECT c.client_code, c.client_orgoid FROM adprmasprd01.batclientproduct@dblinkcru40ptocrw11p b, adprmasprd01.catclient@dblinkcru40ptocrw11p c
WHERE b.prd_code = 'WFN' AND b.ver_code = '9' AND c.client_code = b.client_code AND c.pod_code = 'MAS_PROD1'
UNION
SELECT c.client_code, c.client_orgoid FROM webrepadmin.batclientproduct@dblinkcru40ptocrw11p b, webrepadmin.catclient@dblinkcru40ptocrw11p c
WHERE b.prd_code = 'WFN' AND b.ver_code = '9' AND c.client_code = b.client_code AND c.pod_code = 'WFN4_PROD'
UNION
SELECT c.client_code, c.client_orgoid FROM adprmasprd02.batclientproduct@dblinkcru40ptocrw12p b, adprmasprd02.catclient@dblinkcru40ptocrw12p c
WHERE b.prd_code = 'WFN' AND b.ver_code = '9' AND c.client_code = b.client_code AND c.pod_code = 'MAS_PROD2'
UNION
SELECT c.client_code, c.client_orgoid FROM adprmasprd03.batclientproduct@dblinkcru40ptocrw13p b, adprmasprd03.catclient@dblinkcru40ptocrw13p c
WHERE b.prd_code = 'WFN' AND b.ver_code = '9' AND c.client_code = b.client_code AND c.pod_code = 'MAS_PROD3'
) ORDER BY 1
) ORDER BY 1
ex

https://www.livemeeting.com/cc/adpcorp_ccc/join?id=canakalv&role=present&pw=canakalv


Livemeeting: https://www.livemeeting.com/cc/adpcorp_ccc/join?id=canakalv
	800-377-0237/9746263

Chairperson Name:	VIJAY CANAKALA
Company:	ADP
Ready-Access Number:	8003770237
International Ready-Access Number:	+1 3032480812
7-Digit Access Code:	9746263
Temporary Chairperson Passcode:	718927
Lines available per conference:	24



http://10.136.8.188/ReportingWS/
http://10.136.8.188/Reporting/login.php

col tabs form a30
col count(1) form 99999
select substr(tab_code, instr(tab_code, '@')) tabs, count(1) from sectable where
tabset_key in (select tabset_key from secsession where session_id in (
select max(session_id) from secsession where user_key in (
select user_key from secuser where user_login = 'CMAGER@AISINGROUP') ) )
group by substr(tab_code, instr(tab_code, '@'));


drop synonym V_CLIENT_LOGON;
CREATE OR REPLACE SYNONYM V_CLIENT_LOGON FOR NGAPP.V_CLIENT_LOGON@DBLINKCRU20PTOPXS01P;

canakalv
india123
https://www.livemeeting.com/cc/adpcorp
https://www.livemeeting.com/cc/adpcorp/meet/canakalv

https://www.livemeeting.com/cc/adpcorp/join?id=SB5HBZ&role=present&pw=canakalv
https://www.livemeeting.com/cc/adpcorp/join?id=5GD5F4&role=attend&pw=6263

Meeting ID:  F56ST7
Presenter Entry Code:  canakalv
Attendee Entry Code:  6263

TMSTHREEQUERY.vw_adpr_properties@DBLINKCRU06QTOWSP02Q

drop public database link dblinkcrp01qtocrp01d;
create public database link dblinkcrp01qtocrp01d
connect to ggate identified by ggate using
'(DESCRIPTION = (ADDRESS_LIST = (LOAD_BALANCE = yes) (FAILOVER = ON) (ADDRESS = (PROTOCOL = TCP)(HOST = cdldftif2-scan.es.ad.adp.com)(PORT = 1521))) (CONNECT_DATA = (service_name = crp01d_svc1)))';
select * from dual@dblinkcrp01qtocrp01d;

drop public database link dblinkwfr12stowfc52s;
create public database link dblinkwfr12stowfc52s
connect to ggate identified by ggate using
'(DESCRIPTION = (ADDRESS_LIST = (LOAD_BALANCE = off) (FAILOVER = ON) (ADDRESS = (PROTOCOL = TCP)(HOST = wfc52s.wfn.iat.whc.dc01.us.adp)(PORT = 1521))) (CONNECT_DATA = (service_name = wfc52s_adpr_svc1)))';
select * from dual@dblinkwfr12stowfc52s;



drop public database link dblinkcrw11dtocrw11q;
create public database link dblinkcrw11dtocrw11q
connect to ggate identified by ggate using
'(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=yes)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=cdldftef2-scan.es.ad.adp.com)(PORT=1521)))(CONNECT_DATA=(service_name=crw11q_svc1)))';
select * from dual@dblinkcrw11dtocrw11q;


drop public database link DBLINKCRU40PTOPEOP01;
create public database link DBLINKCRU40PTOPEOP01
connect to ggate identified by a88ylane using '(DESCRIPTION= (ADDRESS_LIST= (ADDRESS= (PROTOCOL=TCP) (HOST=172.20.187.22) (PORT=1529)) (ADDRESS= (PROTOCOL=TCP) (HOST=172.20.187.22) (PORT=1528))) (CONNECT_DATA= (INSTANCE_NAME=PEOP01) (SERVER=dedicated) (SERVICE_NAME=PEOP01.WORLD)))';

create public database link DBLINKCRC02QTOHWS06Q
connect to ggate identified by ggate using 'hws06q';

create public database link DBLINKCRW01DTOWSP02D
connect to secusr identified by secusr using 'wsp02d';

create public database link DBLINKHRC11YTOQAPF1ET1
connect to secusr identified by secusr using 'qaprf_11ee_t1';

create public database link DBLINKCRU02QTOHWS06Q
connect to ggate identified by ggate using 'hws06q';

create public database link DBLINKCRTQ01TOWFC10Q
connect to ggate identified by ggate using 'wfc10q';


ggate/ggate@crtq01
drop public database link DBLINKCRS01Q1TOREG21Q;
create public database link DBLINKCRS01Q1TOREG21Q
connect to ggate identified by ggate using 
'(DESCRIPTION = (ADDRESS_LIST = (LOAD_BALANCE = off) (FAILOVER = ON) (ADDRESS = (PROTOCOL = TCP)(HOST = cdldftgf3-scan.es.ad.adp.com)(PORT = 1521))) (CONNECT_DATA = (service_name = reg21q_svc1)))';
select * from dual@DBLINKCRS01Q1TOREG21Q;
DBLINKCRTS01TOCRS01S
DBLINKCRTQ01TOCRS01Q




create public database link DBLINKCRQ01TOCRS01Q
connect to ggate identified by ggate using 'CRS01Q';
select * from dual@DBLINKCRQ01TOCRS01Q;

conn system@crh01p
create public database link CDBLINKCRH01PTOCRTP03
connect to cruvpd identified by cruvpd using 'crtp03';


create public database link DBLINKCRTU05DTOCRTQ01
connect to ggate identified by ggate using 'crtq01';

CREATE PUBLIC DATABASE LINK CDBLINKCRTD02TOCRTQ01
 CONNECT TO CRUVPD
 IDENTIFIED BY CRUVPD
 USING 'CRTQ01';

crtq01 db box: 10.17.132.24

crr01d db box (dbserver: cdlpfcruap3, ip: 10.5.6.97)  B28srulu -- old: 2J16ZFQ2
Connect to crts01 db box: 172.21.17.104 (dc1stcrptdb2)
Connect to crr01s db box: 172.20.240.23 (dc1rtf001db02)
 GG server for R18.5 crr01s ip: 172.21.17.100 (dc1stcrptgg1)
crtp03 db box: 172.24.32.173 (dc2prcrptdb3)
prod gg server:  172.24.32.216  ggsvr01p
crr01p db box: 172.24.224.20 (dc2prf002db01)
payx gg qa box: 10.5.127.212  canakalv 2J16ZFQ2

10.5.166.118
10.5.172.56  canakalv isps;dis  old:EXFS1d9Q
10.5.172.59  canakalv isps;dis  old:EXFS1d9Q

Password reset self-service utility: http://dc1plinux03.ga.adp.com/ldap/passwdreset/
Your password in the DCx LINUX environment has been reset to "615QF1Jo" "B28srulu".    old:"2J16ZFQ2".
Your password in the DCx SOLARIS environment has been reset to "1qPiUbiV"  old:"Qmo95c3t".  old: "rkdI59Bx".



gg server in development is on : 10.5.6.97
GG Server im production:
172.24.32.206,	172.24.32.207,	172.24.32.208,	172.24.32.209


cdc management console: \\hpsfs01\dev\ADPR\HRB\DC_move_2\CDC_6.5.2_Mgmt_Console_WDWS.zip
FIT IP  10.5.166.127 cdc server

Login to terminal servers below and then connect to CCDC mc
iAT                       172.20.242.175
         cdc: 172.20.242.126
prod                      172.24.226.215  KMBkmb;123
		cdc: 172.24.32.227



p=$(echo $2|tr '[:lower:]' '[:upper:]')

SELECT 'select ''' || referenced_name || ''', count(1) from ' || referenced_name ||';'
 FROM user_dependencies WHERE name = 'PX185_EMPLOYEE_VW'
 ORDER BY 1;


SELECT   uc.table_name, --uc.constraint_name,
        '('||ucc1.TABLE_NAME||'.'||ucc1.column_name||')' constraint_source,
--,       'REFERENCES'
        '('||ucc2.TABLE_NAME||'.'||ucc2.column_name||')' references_column
FROM     user_constraints uc
,        user_cons_columns ucc1
,        user_cons_columns ucc2
WHERE    uc.constraint_name = ucc1.constraint_name
AND      uc.r_constraint_name = ucc2.constraint_name
AND      uc.constraint_type = 'R'
ORDER BY 1, 2,3


 SELECT   uc.table_name, --uc.constraint_name,
          ucc1.column_name constraint_source,
--,       'REFERENCES'
          ucc2.TABLE_NAME,
          ucc2.column_name references_column
FROM     user_constraints uc
,        user_cons_columns ucc1
,        user_cons_columns ucc2
WHERE    uc.constraint_name = ucc1.constraint_name
AND      uc.r_constraint_name = ucc2.constraint_name
AND      uc.constraint_type = 'R'
ORDER BY 1, 2, 3, 4


-- unindexed foreign key constraints can cause severe problems.. query to find them
--  TM Contention Wait
SELECT * FROM (
SELECT c.table_name, cc.column_name, cc.position column_position
FROM   user_constraints c, user_cons_columns cc
WHERE  c.constraint_name = cc.constraint_name
AND    c.constraint_type = 'R'
MINUS
SELECT i.table_name, ic.column_name, ic.column_position
FROM   user_indexes i, user_ind_columns ic
WHERE  i.index_name = ic.index_name
)
ORDER BY table_name, column_position;




C:\Documents and Settings\canakalv\Local Settings\Temporary Internet Files\Content.Outlook\TA4WLXOW\ADPR-PROD-Cert.pfx

password reset request: http://dc1plinux03.ga.adp.com/ldap
grant debug any procedure, debug connect session to secusr;

ssh boddur@172.24.32.214  -- App server for RW client movements
172.24.32.194   crtphw01
ssh boddur@172.20.17.106
172.21.17.104  --> crts01 db node ip.

crtp01 172.24.32.150crtp02 172.24.32.186
crtp03 172.24.32.173
crtp04 172.24.32.188


\\rosepisid6017b\CRUShare\Upgrade
file:   PayXClientMove.xls


select * from all_registry_banners;

webrepadmin@crtp02               08.03.00.003
webreppilot@crtp02               09.00.00.033
webreppod@crtp02                 08.03.00.003
webrepadmin@crtq01               08.02.00.012
webrep@crtq01                    09.01.00.002H
webreppilot@crtq01               09.00.00.034
webreppod@crtq01                 08.01.02.001
webreppod@crty01                 09.01.00.002H

==================================================
set head off pages 0 lines 120
select 'select '''|| tname || ''', count(1) from ' || tname || ';' from tab
where --tabtype = 'VIEW'
tname like 'SYN%';


 ls -lrt *log | awk '{ if ($5>1) { print $NF}}'

exp base_nv_t17/base_nv_t17@crtp03 file=role_p.dmp tables=(BATSDGCONFIG_AUDIT) rows=yes statistics=none direct=y recordlength=64000

imp system/system@crtq01 file=BATSDGCONFIG_AUDIT.dmp fromuser=webrepadmin touser=webreppilot  ignore=y rows=y buffer=900000 statistics=none

imp system/hwse_comadm@cru01d file=UBS1_comadm.dmp fromuser=hwse_com14 touser=hwse_comadm
grants=n IGNORE=y ROWS=y INDEXES=y buffer=900000 statistics=none


select * from (
select table_name
,to_number(extractvalue(xmltype(
dbms_xmlgen.getxml(
'select /*+ parallel(e default) */ count(*) c from '||table_name|| ' e'))
,'/ROWSET/ROW/C')) cnt
from user_tables --order by table_name
)order by cnt;


select view_name
,to_number(extractvalue(xmltype(
dbms_xmlgen.getxml(
'select count(*) c from '||view_name))
,'/ROWSET/ROW/C')) count
from user_views where view_name like '%PX17%';

-- hwse table counts
select * from (
select table_name
,to_number(extractvalue(xmltype(
dbms_xmlgen.getxml(
'select /*+ parallel(e default) */ count(*) c from '||synonym_name|| ' e'))
,'/ROWSET/ROW/C')) count
from user_synonyms where synonym_name like 'B16%' order by synonym_name
) order by count;



select table_name
,to_number(extractvalue(xmltype(
dbms_xmlgen.getxml(
'select count(*) c from '||table_name))
,'/ROWSET/ROW/C')) count
from user_tables where table_name like '%LK%' and table_name not like 'MLOG%';

select table_name,to_number(extractvalue(xmltype(dbms_xmlgen.getxml(
'select count(*) c from '||table_name)),'/ROWSET/ROW/C')) count
from user_synonyms where table_owner = 'base_nv_t17';

set serveroutput on size 1000000
declare
 cnt number;
begin
  for i in (select synonym_name n from user_synonyms where table_owner = 'base_nv_t17')
  loop
    execute immediate 'select count(1) from ' || i.n into cnt;
    dbms_output.put_line(i.n || ' - ' || cnt);
  end loop;
end;
/


===============================================================
To see the company preferences link, the user must have “CRTClientPrefAdmin” profile.
  Use Company Preferences check box in reporting preferences.


===============================================================

Find out which url BATCLIENTPRODICT is redirecting the requests to:
select * from catparam where par_default like '%crtqa%'

alter session set events '32333 trace name context forever, level 10';
r80_hrb25_files_fields.sql
====================================
    hrb current setup:
 fit: webrep@crtq01, cruvpd@crtd02
 dit: adprditsm@crtq01 cruvpd@pyxy02
cqLanka=====================================
certs:
    https://crtqa.adp.com/webreppod/
    testbenrep@adp
    adpadp10

Payx r18:
    Environment: https://crtqa.adp.com/webreppod
    release: r8.1.2
    catalog: webreppod@crtq01
    datamart: cruvpd@crtq01
    payx r18

staging:
		 prod pod : https://stgreporting.adp.com           : 8.1
         pilot pod: https://stgreporting1.adp.com          : 8.2

		 webrepadmin: prod pod : 8.1
		 webreppod:   pilot pod: 8.2

++++++++++++++++++ installed perl modules +++++++++
perl -MFile::Find=find -MFile::Spec::Functions -Tlwe 'find { wanted => sub { print canonpath $_ if /\.pm\z/ }, no_chdir => 1 }, @INC'

============ create a new user ================
create user ws_adm identified by ws_adm
 default tablespace DATA1
 quota unlimited on DATA1;
alter user ws_adm quota unlimited on INDEX1;
grant dbapp, vpd_role to ws_adm;


create user &&newuser identified by &&newuser
 default tablespace DATA1
 quota unlimited on DATA1;
alter user &&newuser quota unlimited on INDEX1;
grant dbapp, vpd_role to &&newuser;

===================================================
set serveroutput on size 1000000
declare
  vcmd varchar2(1000);
  vcnt number;
begin
  for i in (select table_name from user_tables)
  loop
    vcmd := 'select count(1) from ' || i.table_name;
    execute immediate vcmd into vcnt;
    dbms_output.put_line(i.table_name || ' : ' || vcnt);
  end loop;
end;
/

declare
vclob varchar(32000);
begin
vclob := ' << CLOB DATA >>';
insert into ihcm_schema_defn(id, DATA) values (SYS_GUID(),vclob);
COMMIT;
exception
  when others then null;
end;
/

===================================================
sqlplus system/system123@crtd01
crtdb01: create context REPORTINGCONTEXT_WEBREPP using PKG_REPORTING_CONTEXT;
crtd01: create context REPORTINGCONTEXT_WRA using PKG_REPORTING_CONTEXT;
create context REPORTINGCONTEXT_WEBREPDIT using PKG_REPORTING_CONTEXT;

begin
execute immediate ('create or replace context Reporting_' || User || ' using PKG_REPORTING_CONTEXT');
end;
/
===================================================
metalink.oracle.com
user: alvaro_reguly@adp.com
password: meda1real
vijaya_canakala@adp.com
c3FkyBZY
vijaya.canakala@adp.com
Qmaer2xd

set autotrace traceonly explain statistics
ALTER SESSION SET sql_trace = TRUE|FALSE;
EXECUTE SYS.dbms_system.set_sql_trace_in_session (<SID>, <serial#>, TRUE|FALSE);
ALTER SESSION SET timed_statistics = TRUE|FALSE;
select owner ||'.'||OBJECT_NAME from dba_objects where LAST_DDL_TIME > trunc(sysdate);

set long 4000
select * from dba_mviews where OWNER = 'WEBREPADMIN' and MVIEW_NAME = 'MV_COLUMN';
select * from DBA_REGISTERED_SNAPSHOTS where OWNER = 'WEBREPADMIN' and NAME = 'MV_COLUMN';
variable st varchar2(1000);
exec :st := 'PX17_R6_CHK_COMBO_VW.PAY_DATE';
select instr(:st, 'PAY_DAT') from dual;
select sys_context('payx_r17_app_context','app_filter') from dual;
-------------------------------------------------------------------------------------
new payx r17 call stmt:
call  payx_r17_sec_context_0301.set_app_context('ACAREY@AINETWORKS','ER', '', '');


select last_date,last_sec,next_date,next_sec from user_jobs where instr(what ,'PAYX_USERID_SECURITY') > 0 ;
select last_date,last_sec,next_date,next_sec from user_jobs where instr(what ,'PAYX_R17_USERID_SECURITY') > 0 ;

select payx_r17_policies_for_view.date_filter_for_view('a', 'a') from dual;
select payx_r17_policies_for_view.cocode_filter_for_view('a', 'a') from dual;
select payx_r17_policies_for_view.cocode_filter_for_table('a', 'a') from dual;

call payx_r17_security_context_new.set_app_context('LROLFES@SOURCEGAS','ER','PX17_R6_CHK_COMBO_VW',
'PX17_R6_CHK_COMBO_VW.PAY_DATE#>=#TO_DATE(''01/01/2008'', ''MM/DD/YYYY''),PX17_R6_CHK_COMBO_VW.PAY_DATE#<=#TO_DATE(''12/31/2008'', ''MM/DD/YYYY''),PX17_R6_CHK_COMBO_VW.COMPANY_CODE#=#''F66''')

call payx_r17_security_context_new.set_app_context('mschmidt@sdbell','ER','PX17_R6_EMPLOYEE_VW ',
'PX17_R6_EMPLOYEE_VW.COMPANY_CODE#=#''J25''');

call payx_r17_security_context_new.set_app_context('mschmidt@sdbell','ER','PX17_R6_EMPLOYEE_VW PX17_R6_CHK_COMBO_VW',
'PX17_R6_CHK_COMBO_VW.COMPANY_CODE#=#''J25'',
PX17_R6_CHK_COMBO_VW.PAY_DATE#>=#TO_DATE(''09/01/2009'', ''MM/DD/YYYY''),
PX17_R6_CHK_COMBO_VW.PAY_DATE#<=#TO_DATE(''09/18/2009'', ''MM/DD/YYYY''),
PX17_R6_EMPLOYEE_VW.FILE_NUMBER#=#''012885''');


call payx_r17_security_context_new.set_app_context('KLUND@COCAI','ER','PX17_R6_EMPLOYEE_VW PX17_DEDUCTION_VW PX17_BENX_ENROLLMENT_VW',
'PX17_R6_EMPLOYEE_VW.COMPANY_CODE#=#''2UW'',PX17_R6_EMPLOYEE_VW.STATUS#=#''ACTIVE'',PX17_DEDUCTION_VW.DEDUCTION_CODE#IN#(''23,24,25,51,52,53,54'')') ;

-------------------------------------------------------------------------------------
Application version:
select DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION);

select * from (select DBV_PHPVERSION from admdbversion order by dbv_timestamp desc) where rownum < 2;

select DBV_PHPVERSION, DBV_TIMESTAMP from admdbversion where
replace(DBV_PHPVERSION, '.', '') = (select max(replace(DBV_PHPVERSION, '.', '')) from admdbversion);

09.04.05.000  2011-04-05 17:02:14

check version:
#!/usr/bin/ksh
logfile=${0%.sh}.log
rm -f $logfile
cat <<!|sqlplus -s webrepadmin/webrepadmin@crup02_aa |sed "/^Connected.$/d" | tee $logfile
set verify off feedback off echo off timing off
set head off pages 0 lines 120
select (select 'AA_Prod:' || DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION))
|| ' ' || (select pod_code || ' ' || POD_URL from batpod where pod_current='t') from dual;
conn webreppod/webreppod@crup02_aa
select (select 'AA_Pilot:' || DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION))
|| ' ' || (select pod_code || ' ' || POD_URL from batpod where pod_current='t') from dual;
conn webreppod/webreppod@crup02_dc2
select (select 'DC2_Prod:' || DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION))
|| ' ' || (select pod_code || ' ' || POD_URL from batpod where pod_current='t') from dual;
conn webreppilot/webreppilot@crup02_dc2
select (select 'DC2_Pilot:' || DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION))
|| ' ' || (select pod_code || ' ' || POD_URL from batpod where pod_current='t') from dual;
conn webrepadmin/webrepadmin@crc02p
select (select 'WFN3.0:' || DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION))
|| ' ' || (select pod_code || ' ' || POD_URL from batpod where pod_current='t') from dual;
conn webrepadmin/crc01Pr0d@crc01p_van1
select (select 'Vantage_Prod:' || DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION))
|| ' ' || (select pod_code || ' ' || POD_URL from batpod where pod_current='t') from dual;
conn webrepadmin/Crc01UaT@crc01u_van1
select (select 'Vantage_UAT:' || DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION))
|| ' ' || (select pod_code || ' ' || POD_URL from batpod where pod_current='t') from dual;
!


------------------------------------------------------------------------------------
172.20.89.26 is for elmp123
/elmp123/ggate/dirprm
172.24.90.149 is for elmp808
/elmp808/ggate/dirprm

------------------------------------------------------------------------------------
DC Servers:
dc2prcrptetl2  - 172.24.32.158
dc2prcrptetl1  - 172.24.32.154

172.24.32.173   crtp03
172.24.32.188   crtp04


naqvis
sjn@1975




staging dc1 etl1 172.20.17.106
staging dc1 etl2 172.20.17.107
prod    dc2 etl2 172.24.32.158
prod    dc2 etl1 172.24.32.154

dc1 app: to connect to staging...
	ssh boddur@172.20.17.75
dc1 db server:
	ssh boddur@172.20.17.117

dc1stcrptetl1  172.20.17.106  Use infor id
India;123
crtp01: 172.24.32.147
crtp02: 172.24.32.151


crtdb01:
ssh ggate@10.21.47.52  ggate
crtd02:
ssh canakalv@10.17.132.21  your password works
Staging:
ssh infor@172.18.103.45
dry run: /apps/ReportWriter/xml/ftprate
         /apps/ReportWriter/xml/ftprate/ADPR
            comes here first.. besure to create the complete_imp.log file
         /apps/ReportWriter/xml/ftprate/PAYX

Prod:
ssh ggate@172.18.21.44     123ggate   ggate123
ssh ggsupport@172.18.21.44  123ggate  ggate123

HWSE:
ggate/adpadp123 has been added to the server’ basqr5 (useradd -G dba -d /export/home/ggate -m ggate).
bladelogic box ip: 10.1.146.32  10.1.146.32
Url: https://stgreporting1.adp.com  has r8 today
Webreppod/webreppod@crts01
CRTADPAdminSTG@adp
adpadp999

-----------------------------------------------
RW to ADPR Migrations: Getting User data from CRU
-----------------------------------------------
Informatica setups:
Install PowerCenter client and ODBC drivers only

repository: cr_dev
user: vcanakala
pwd: summer1
informatica: cr_dev Administrator / cr_dev@51
hostname: 10.21.47.51
portnumber: 5001

powercenter 8:
canakalav  vijay123

powercenter9.1:
Administrator
Host file entry to be added: 10.5.170.214  cdladpr014

Domain: Domain_ADPR_FIT
Repository Name: pc_repo_serv
Gateway Host: cdladpr014
Gateway Port: 6005
Folder: d_canakalav

User & Password: canakalav & vijay@123
key: 039E-461C-7443-731D-8BE4-F102-C797-955E-BC68-2320-FE8D-FA20-6FBF

\\HPSFS01\dev\ADPR\PC91

PowerCenter 9.1 client --  910HF1_Client_Installer_win32-x86.zip
PowerExchange 9.1 -- PExchange91HF1.zip

User & Password: canakalav & vijay@123

Informatica host entries:
10.5.170.214  cdladpr014
172.20.17.124 dc1stcrptinfor1
172.24.32.231 dc2prcrptinfor1


prod:
vedge_Reg0001@cru21p  -  vedge_reg0025@cru21p
pc_repo@crtp01
pc_repo_serv_prod
Domain_ADPR_PROD

iat:
pc_repo_serv_iat
Domain_ADPR_IAT


==================================================================




add this to C:\WINDOWS\system32\drivers\etc\hosts
10.21.47.51   ADP

-----------------------------------------------
WSR: ibm webshphere replicator for hrb;
BCV is backup of LIVE IPAY DB
they restore backup and open db between 9pm-12 for adpr reporting informatica etl
-----------------------------------------------
extract(day from 24*60*my_interval)



 SELECT req_status, COUNT(1) FROM batreq
 WHERE req_timestamp
 BETWEEN (SYSDATE - INTERVAL '3' HOUR)
 AND SYSDATE GROUP BY req_status;


 SELECT req_status, COUNT(1) FROM batreq
 WHERE req_timestamp
 BETWEEN ((SYSDATE-7) - INTERVAL '3' HOUR)
 AND (SYSDATE-7) GROUP BY req_status;


select a.hr, /*req_status,*/ count(1) from
(select extract(hour from req_timestamp) HR from batreq where req_timestamp > trunc(sysdate)) a,
(SELECT row_number() over (partition by nvl2(object_id,1,2)  order by nvl2(object_id,1,2)desc) HR from user_objects where rownum < 25) b
where a.hr = b.hr
group by a.hr, a.req_status
order by 1,2;

select to_char(req_timestamp,'HH24'),count(1)  from batreq
where trunc(req_timestamp)=trunc(sysdate)
group by to_char(req_timestamp,'HH24')
order by 1;

select extract(hour from req_timestamp) HR,
       count(1) from batreq where req_timestamp > trunc(sysdate)
group by extract(hour from req_timestamp)
order by 1;



SELECT b.req_timestamp FROM batreq b WHERE b.req_key = '0925517165623';
SELECT br.rlog_timestamp, br.rlog_status FROM batreqlog br WHERE  br.req_key = '0925517165623';



INSERT INTO BATCLIENTINSTANCE(CLIENT_CODE,INST_KEY,POD_CODE) VALUES('MADEVP59','1','PILOTPOD');
INSERT INTO BATCLIENTPRODUCT(CLIENT_CODE,PRD_CODE,VER_CODE) VALUES('MADEVP59','PAYX2','17');
-----------------------------------------------
-- All objects CRUVPD has got access to
select privilege ||'       '|| owner ||'.'||table_name
from user_tab_privs where grantee = 'CRUVPD'
order by owner, table_name, privilege;
select privilege ||'       '|| owner ||'.'||table_name||'.'||column_name
from user_col_privs where grantee = 'CRUVPD'
order by owner, table_name, privilege;

-- System level privileges to user
select USERNAME||'  '||PRIVILEGE from user_sys_privs
order by USERNAME, PRIVILEGE, ADMIN_OPTION;

select to_char(session_timestamp, 'HH24') ||'|'|| count(session_id)
from SECSESSION
where trunc(session_timestamp) = '09-FEB-2009' --trunc(sysdate-4)
group by rollup(to_char(session_timestamp, 'HH24'))
order by to_char(session_timestamp, 'HH24')
Dev -> DIT -> FIT -> Staging -> Production


-- READ SECSESSIONVAL HTTP_PROFILEDN VALUE
set verify off
SELECT regexp_substr(val_value, '[^^]+', 1, LEVEL) FROM (
SELECT val_value FROM secsessionval WHERE session_id =
(SELECT session_id FROM secsession
WHERE session_timestamp = (SELECT Max(session_timestamp)
FROM secsession WHERE user_login LIKE '&user_login')
and rownum = 1)
AND val_name = 'HTTP_PROFILEDN')
CONNECT BY regexp_substr(val_value, '[^^]+', 1, LEVEL) IS NOT NULL
ORDER BY 1;

SELECT regexp_substr(val_value, '[^^]+', 1, LEVEL) FROM (
SELECT val_value FROM secsessionval WHERE session_id = '1504403873770'
AND val_name = 'HTTP_PROFILEDN')
CONNECT BY regexp_substr(val_value, '[^^]+', 1, LEVEL) IS NOT NULL
ORDER BY 1;




set serveroutput on size 1000000

declare
    ctx_info DBMS_SESSION.AppCtxTabTyp;
    info_cnt PLS_INTEGER;
    ind      PLS_INTEGER;
    strn  VARCHAR2(256)  default null;
    cl    varchar2(5000) default null;
    pos   pls_INTEGER default 1;
    chunk pls_INTEGER default 0;
    len   pls_INTEGER default 0;
begin
    DBMS_SESSION.LIST_CONTEXT(ctx_info, info_cnt);
    ind := ctx_info.FIRST;
    dbms_output.put_line(info_cnt);
    LOOP
        exit when ind is null;
        cl := ctx_info(ind).namespace || '.' ||
              ctx_info(ind).attribute || ' = [' ||
              ctx_info(ind).value || ']';

        pos := 1;
    	<<PRINTLOOP>>
    	LOOP
    		strn := SUBSTR(cl,  pos, 255);
    		pos := pos + length(strn);
    		DBMS_OUTPUT.PUT_LINE(strn);
    		EXIT PRINTLOOP WHEN (length(strn) < 255);
    	END LOOP PRINTLOOP;

        ind := ctx_info.next(ind);
    END LOOP;
end;
/

create table my_t1 (t timestamp);
create or replace procedure vijay_job_test as
begin
  insert into my_t1 values (systimestamp);
  commit;
end;
/
declare
 jno number;
begin
 dbms_job.submit(job => jno,
                 what => 'vijay_job_test;',
                 next_date => sysdate + (1/96),
                 interval => 'sysdate + (1/96)');
end;
/
//////////////
/// If thre is a replication problem, and you need to notifiy others,
/// check the source tables and provice the details. Do not provide details about the view
/// view related detailes are not accepted by replication team.
//////////////
declare
  msgbody varchar2(200);
  conn    utl_smtp.connection;
begin
  msgbody := 'this is a mail from pl/sql at ';
  conn := utl_smtp.open_connection('plpar00.nj.adp.com', 25);
  utl_smtp.helo(conn, 'plpar00.nj.adp.com');
  utl_smtp.mail(conn, 'canakalv@plpar00.nj.adp.com');
  utl_smtp.rcpt(conn, 'vijaya_canakala@adp.com');
  utl_smtp.data(conn, msgbody);
  utl_smtp.quit(conn);
end;
/

exec :n := dbms_utility.get_cpu_time;
exec dbms_output.put_line((dbms_utility.get_cpu_time-:n)||' cpu hsecs..' );

// pl.sql timing comparision
declare
 l_start number;
 l_end number;
 l_diff number;
begin
 l_start := dbms_utility.get_time ;
  for i in 1..10000
   loop
  dbms_output.put_line('i= '|| i);
  end loop;
 l_end := dbms_utility.get_time ;
 dbms_output.put_line('l_start ='||l_start);
 dbms_output.put_line('l_end ='||l_end);
 l_diff := (l_end-l_start)/100;
 dbms_output.put_line('Elapsed Time: '|| l_diff ||' secs');
end;
/

///////// Generic cursor script

declare
 cursor cx
 is select * from user_tables;
 type ty is table of cx%rowtype;
 t ty;
begin
 open cx;
 loop
   fetch cx bulk collect into t;

   for i in 1 .. t.count
   loop
     dbms_output.put_line(t(i).table_name || ' is in here.');
   end loop;
   exit when cx%notfound;
 end loop;
 close cx;
end;
/


declare
 cursor cx is <select query>;
 type ty is table of target_table%rowtype;
 t ty;
begin
 open cx;
 loop
   fetch cx bulk collect into t limit 1000;
   forall i in 1..t.count
   insert /*+ append */ into target_table values t(i);
   commit;
   exit when cx%notfound;
 end loop;
 close cx;
end;
/
commit;


---- execute immediate bulk collect with recordType

set serveroutput on
declare
  vorgi varchar2(100);
  rc sys_refcursor;
  type tob is record (
    owner varchar2(30),
	orgid varchar2(50)
  );
  type typ_tob is table of tob;
  tob1 typ_tob;

begin
  for i in (select owner from all_objects where owner like '%ADM'  and object_name = 'ASSOCIATE_XREF' order by 1)
  loop
    open rc for 'select distinct ''' || i.owner || ''', organization_oid from ' || i.owner || '.ASSOCIATE_XREF';
	fetch rc bulk collect into tob1;
	--execute immediate
	-- 'select distinct ''' || i.owner || ''', organization_oid from ' || i.owner || '.ASSOCIATE_XREF'
	-- bulk collect into tob1;
	for i in tob1.first .. tob1.last
	loop
	  if (tob1(i).orgid = 'FFFFFFFFFFFFFFFF') then continue; end if;
	  dbms_output.put_line(tob1(i).owner || '  ' || tob1(i).orgid);
	end loop;
    close rc;
  end loop;
end;
/



-- index by tables
declare
  TYPE h_tab_type IS TABLE OF varchar2(100) index  BY varchar2(100);
  v  h_tab_type;
  i varchar2(100);
begin
  for i in (select tname, tabtype from tab)
  loop
     v(i.tname) := i.tabtype;
  end loop;

  for i in v.first
  loop
    dbms_output.put_line(i);
  end loop;
end;
/




create or replace procedure hello1(p1 varchar2 default null)
as
  type tcv is ref cursor;
  cv tcv;
  sqlexpr varchar2(1024);
  sqlfilter varchar2(100);

  type xobjname is table of all_objects.object_name%type;
  type xobjtype is table of all_objects.object_type%type;
  type xdatobjid is table of all_objects.data_object_id%type;

  uobjname xobjname;
  uobjtype xobjtype;
  udatobjid xdatobjid;
  mycnt number default 0;
begin
  if (p1 is not null) then
    sqlfilter := ' where owner = upper(' || chr(39) || p1 || chr(39) || ')';
  end if;
  sqlexpr := 'select object_name, object_type, data_object_id from all_objects' || sqlfilter;
  dbms_output.put_line(sqlexpr);

  open cv for sqlexpr;
  fetch cv bulk collect into uobjname, uobjtype, udatobjid;
  close cv;

  for i in 1 .. udatobjid.count
  loop
      --dbms_output.put_line(uobjname(i) || ' : ' || uobjtype(i) || ' : ' || udatobjid(i));
      mycnt := mycnt + 1;
  end loop;
    dbms_output.put_line(sqlexpr);

  dbms_output.put_line(mycnt);

end;
/

adpdb00242190
call payx_r17_security_context_new.set_app_context('KTurner3@KENTKBXFIT','ER','','');
call payx_r17_security_context_new.set_app_context('KMILAM@DUBOIS','ER','','');

--------------------------------------
ora-01427
connect cruvpd/cruvpd@crtp02
dSCOTT@SANDVIK PAYXSCH0039968
alewis@lamvenlp    PAYXSCH0061470  adpdb00236043
CCooper@CHARTERED  PAYXSCH0042571  adpdb00237131
jlozen@dpmglobalr  PAYXSCH0040021  adpdb00239584
mkoltz@sonnysreal  PAYXSCH0020785  adpdb00241474
call payx_r17_security_context_new.set_app_context('mkoltz@sonnysreal','ER', '', '');
select distinct cidn from px17_associate;
select count(1) from px17_chk_vw_summary_vw;
connect payx_r17/payx_r17@crtp02
col oid format a8
col name format a8
col description format a32
select cidn,oid,name,description
from type_client
where name in (
select name from type_client
  where cidn = 'PAYXSCH0042571'
  and category='T_CO_DEPT'
  and active = 1
  group by name having count(1)>1)
and cidn = 'PAYXSCH0042571'
and category='T_CO_DEPT'
and active = 1
order by name, description, oid;
PAYXSCH0035413
connect payx_r17/payx_r17@crtp02
select securityoid||':'||name||':'||description, count(*) from type_client where
category='T_CO_DEPT' and cidn='PAYXSCH0035413'
group by securityoid||':'||name||':'||description having count(*) > 1;
select securityoid||':'||name||':'||description, count(*) from type where
category='T_CO_DEPT' and cidn='PAYXSCH0035413'
group by securityoid||':'||name||':'||description having count(*) > 1;

-- to check when the mat views got refreshed last
select name, master, to_char(last_refresh, 'MM/DD/YYYY HH24:MI:SS')
from all_mview_refresh_times where last_refresh > trunc(sysdate)
and owner = 'PAYX_R17';
-------------------------------------------
For any report on check history please follow these guidelines:
In Step 7: Add a filter on both the following
1. Specify the company code.
    Even though the client has only one company code, explicitly specifying it would make report generation faster.
    Prefer to Check the Case Sensitive checkbox in the filter condition.
2. Specify a pay date. Prefer not using multiple pay dates.
    Use a single pay date and use the filter operation = (equal to) and prefer not to use in (list of values).
--------------------------------------------
select cidn, oid,name,description
from type17
where name in (
select name from type17
  where cidn = 'PAYXSCH0035413'
  and category='T_CO_DEPT'
  and active = 1
  group by name having count(1)>1)
and cidn = 'PAYXSCH0035413'
and category='T_CO_DEPT'
and active = 1
order by name, description, oid;
--------------------------------------------
Determine user privileges:
SELECT LPAD(' ', 2*level) || granted_role  PRIVS
FROM (
  SELECT NULL grantee,  username granted_role
  FROM dba_users
  WHERE username LIKE UPPER('%&uname%')
  UNION
  SELECT grantee, granted_role
  FROM dba_role_privs
  UNION
  SELECT grantee, privilege
  FROM dba_sys_privs)
START WITH grantee IS NULL
CONNECT BY grantee = prior granted_role;
or
SELECT path
FROM (
  SELECT grantee,
    sys_connect_by_path(privilege, ':')||':'||grantee path
  FROM (
    SELECT grantee, privilege, 0 role
    FROM dba_sys_privs
    UNION ALL
    SELECT grantee, granted_role, 1 role
    FROM dba_role_privs)
  CONNECT BY privilege=prior grantee
  START WITH role = 0)
WHERE grantee IN (
  SELECT username
  FROM dba_users
  WHERE lock_date IS NULL
  AND password != 'EXTERNAL'
  AND username != 'SYS')
OR grantee='PUBLIC'
/


create table t22 (a varchar2(100));
insert into t22
select distinct substr(name, instr(name, '@')+1)
from associate
where name like '%@%'
  and cidn in (select a from t11);
++++++++++++++++++ CLIENT MOVE FROM NODE1  TO NODE2 ++++++++++++++++++++++++++++
declare
  vstr varchar2(1000);
begin
for i in (select a from t33 where a >= 'OCCUP')
loop
    vstr := 'update batclientinstance set inst_key = 2 where client_code = '''|| i.a ||''' and inst_key = 1';
    dbms_output.put_line(vstr);
    execute immediate vstr;
end loop;
end;
/
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++ UPDATE PAYX_R17.NODE2_MOVE TABLE FOR REF +++++++++++++++++++++

declare
  vstr varchar2(1000);
  vcidn varchar2(100);
  vname varchar2(100);
begin
for i in (select a from webrepadmin.t33@DBLINKCRTP02TOCRTP01)
loop
  vstr := 'insert into t100 select distinct cidn, name from payx_r17.associate where upper(name) like '''||'%@'||i.a ||'''';
  execute immediate vstr;
  --dbms_output.put_line(vstr);
  --execute immediate vstr into vcidn, vname;
  --dbms_output.put_line(vcidn || ' - ' || vname);
  commit;
end loop;
end;
/
insert into node2_move
select distinct cidn, substr(name, instr(name, '@')+1), sysdate from t100;
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


SELECT owner, synonym_name, table_owner, table_name
from dba_synonyms where table_owner not in ('SYS', 'SYSTEM')
order by owner, table_owner, table_name, synonym_name
select OBJECT_NAME||','||POLICY_NAME||','||PACKAGE||','||FUNCTION||','||ENABLE from dba_policies
----------------------------------------------
dynamic lcf labels
webreppod/webrep/webreppilot
infor@plpar00 /apps/crt/ezlm/r11/etl/v1] dynamic_lcf_r11_etl.sh crtq01

ADPREPORTING_VIEW  EZLM_R11.EZLM_CRU
ADPREPORTING_VIEW_R1117  EZLM_R1117.EZLM_CRU
ADPREPORTINGVIEW    ADPREPORTING_VIEW@DBLINKCRTP01TOELMPR1

  CREATE OR REPLACE PUBLIC SYNONYM "ADPREPORTING_VIEW" FOR "EZLM_R11"."EZLM_CRU"

for migrations:
select * from CUSTCONNECT.ADPREPORTINGINTEGRATION_TAB  where custid=80171;
select * from ggate.ADPR_EZLM_CLIENT@crtp01 where custid=80171




cat context.sql
begin
execute immediate ('CREATE OR REPLACE CONTEXT REPORTING_' || USER || ' USING PKG_REPORTING_CONTEXT');
end;
/



EZLM query:
SELECT DISTINCT
upper(b.O) as client_code
FROM appadm.ISIPRODUCT_SC_CLIENT b
WHERE upper(b.ADPPRODUCTCODE)  IN ('EZLABORMANAGER')  and
exists (
select 1
from appadm.ISIPRODUCT_SC_CLIENT a
WHERE upper(a.ADPPRODUCTCODE)='CRT'
and  a.o=b.o)
AND upper(b.O) in
(select upper(userid) from adpreporting_view where SERVER like '%cust4')
----------------------------------
appadm  ->  cruvpd  (isiproduct, isiclient, isiuser, pkg principal_info etc..)
ezlm_r11 -> cruvpd  (payroll, location, person, timecard, termcodes, job, user)
hwse_com14 -> base_nv_t14    ------------------->   base_nv_t14 -> cruvpd
hwse_r14   -> base_nv_t14    -------------/
(views) isireg_r43 -> racs_r1 --> (views) racs_r1 -> cruvpd
payx_r17 -> cruvpd
  (packages: PAYX_R17_APPLICATION_MANAGER, PAYX_R17_PRINCIPAL_INFO)
  (matviews: PAYX_R17_USERID_SECURITY, TYPE)
secusr -> cruvd (and appadm)
  (packages: APP_SECURITY_CONTEXT_IPAY,
             APP_SECURITY_CONTEXT_ISI,
             BASE_T14_SEC_CONT, BASE_T15_SEC_CONT,
             EZLM_R11_SECURITY_CONTEXT,
             PAYX_R17_SECURITY_CONTEXT_NEW)

view cruvpd.px17_checkitem_both -> cruvpd.checkhistoryitem
-------------------------------------------------------------------------
--remove duplicates
DELETE FROM prev_client_config_cmds
WHERE rowid IN (
SELECT rowid
FROM prev_client_config_cmds WHERE prd_code = 'EZLM'
MINUS
SELECT MAX(rowid)
FROM prev_client_config_cmds WHERE prd_code = 'EZLM'
GROUP BY clnt, prd_code, cmd
);


--- bulk deletes for duplicates
DECLARE
 cursor cx is select rid from (
    select rowid rid from curr_isi_client_load
    minus
    select max(rowid) rid from curr_isi_client_load
    group by org_id, client_code, product_code);
 type ty is table of rowid index by binary_integer;
 t ty;
 vcnt number;
BEGIN
  vcnt := 0;
  open cx;
  loop
    fetch cx bulk collect into t limit 1000000;
    forall i in 1 .. t.count
    delete from curr_isi_client_load where rowid = t(i);
    vcnt := vcnt+1;
    insert into t values (vcnt);
    commit;
    exit when cx%notfound;
  end loop;
  commit;
  close cx;
END;
/


---------------------------------------------------------------------------
 column field1 format a18
 column field2 format a50
 column field3 format a7
 column field4 format a50

 --select lpad(' ', 5*level) ||'('||ttype||')  '||tname|| '       -->  ' || sname
 --select lpad(' ', 5*level) , '('||ttype||')' field1, tname field2, '  -->  ' field3, sname field4
 select lpad(' ', 5*level) || rpad(ttype, 18) || rpad(tname, 50) || '  -->  ' || rpad(sname, 50)
 from (
   select /*+ use_hash(o) */ s.owner||'.'||s.synonym_name sname, s.table_owner ||'.'|| s.table_name tname, o.object_type ttype
   from dba_synonyms s, dba_objects o
   where s.table_name = o.object_name
     and s.table_owner = o.owner
     and s.table_owner != 'SYS'
     and s.table_owner != 'SYSTEM'
     and s.table_owner != 'PUBLIC'
     and s.owner != 'PUBLIC'
   order by sname, tname, ttype)
 start with ttype != 'SYNONYM'
 connect by tname = prior sname;
 ---------------------------------------------------------------------------


-- object INSERT/UPDATE/DELETEs since last stats collection
select * from user_TAB_MODIFICATIONS where table_name in (
select object_name FROM user_objects WHERE object_type = 'MATERIALIZED VIEW'
);

-- when stats collected on the materialized views
select table_name, last_analyzed from all_tables where table_name in (
select object_name FROM user_objects WHERE object_type = 'MATERIALIZED VIEW'
);




select l1.sid, ' IS BLOCKING ', l2.sid
from gv$lock l1, gv$lock l2
where l1.block =1 and l2.request > 0
and l1.id1=l2.id1
and l1.id2=l2.id2;

select
      (select username from gv$session where sid=a.sid) blocker,
       a.sid,
      ' is blocking ',
       (select username from gv$session where sid=b.sid) blockee,
           b.sid
  from gv$lock a, gv$lock b
 where a.block = 1
   and b.request > 0
   and a.id1 = b.id1
   and a.id2 = b.id2
/


select s1.username || '@' || s1.machine
|| '( SID=' || s1.sid || ' SQL_ID=' || s1.sql_id || ' ) is blocking '
|| s2.username || '@' || s2.machine || ' ( SID=' || s2.sid || ' SQL_ID=' || s2.sql_id || ' ) ' AS blocking_status
from gv$lock l1, gv$session s1, gv$lock l2, gv$session s2
 where s1.sid=l1.sid and s2.sid=l2.sid
 and l1.BLOCK=1 and l2.request > 0
 and l1.id1 = l2.id1
 and l2.id2 = l2.id2 ;

select username, count(1) from v$session where status = 'ACTIVE' group by username;


SELECT  a.sid, a.serial#, a.seq#, a.process, a.machine, a.last_call_et, a.username, b.sql_text
from gv$session a, gv$sql b
WHERE a.status ='ACTIVE'
AND a.sql_id = b.sql_id
and a.sid = 1836
order by 1;

--AND a.module LIKE 'adpr_ezlm_do_compare'
--and b.sql_text like '%ELECTION_ALL_MV%'
and a.username = 'HWSE_ADMIN'
and b.sql_text like '%HWSE_REG0116%'
 order by 1;

-- who is running long ?
SELECT  a.sid, a.serial#, a.seq#, a.process, --a.sql_id,
a.last_call_et, a.username, b.sql_text
from gv$session a, gv$sql b
WHERE a.status ='ACTIVE'
AND a.sql_id = b.sql_id AND a.last_call_et > 10
 order by 1;


SELECT a.sid, a.serial#, a.MACHINE, a.process, a.USERNAME, a.STATUS, a.OSUSER,  a.sql_id, b.sql_text from gv$session a, gv$sql b
WHERE a.status ='ACTIVE' and a.OSUSER = 'canakalv'
AND a.sql_id = b.sql_id --AND UPPER(sql_text) LIKE '%ELECTION%'
;

--SELECT a.osuser, a.serial#, a.sql_id, b.sql_text
'ALTER SYSTEM KILL SESSION '''||a.sid||','||a.serial#||''';'

select 'ALTER SYSTEM KILL SESSION '''||a.sid||','||a.serial#||''';' from gv$session a where osuser = 'shodajay';

SELECT  a.osuser, a.serial#, a.sql_id, b.sql_text
from gv$session a, gv$sql b
WHERE a.status ='ACTIVE' and a.username = 'WEBREPADMIN'
AND a.sql_id = b.sql_id AND UPPER(sql_text) LIKE '%BATCLIENTENVIRONMENT%'
 order by 1;


SELECT  a.osuser, a.serial#, a.sql_id, b.sql_text
from gv$session a, gv$sql b
WHERE a.status ='ACTIVE' --and a.username = 'WEBREPADMIN'
AND a.sql_id = b.sql_id AND UPPER(sql_text) LIKE '%SECURITY_USER_ACCESS_DETAIL%'
 order by 1;

-- row cache locks:
col sid new_value sid

select h.address, h.saddr, s.sid, h.lock_mode
from v$rowcache_parent h, v$rowcache_parent w, v$session s
where h.address = w.address and
			w.saddr = (select saddr from v$session where event = 'row cache lock'
									and rownum = 1) and
			h.saddr = s.saddr and
			h.lock_mode > 0
;

sqlplus payx_reg01_pod54/payx_reg01_pod54@cru20p
select count(1) from SECURITY_USER_ACCESS_DETAIL;

-- to double check if a client is wfn2 acs eanbled or not.
SELECT security_user_profile_oid FROM VPDCLSCH0034000045.SECURITY_USER WHERE Upper(user_id) LIKE 'TSEIFERT@MTU';


WITH blocked_resources AS
(select
        id1
       ,id2
       ,SUM(ctime)   as blocked_secs
       ,MAX(request) as max_request
       ,COUNT(1)     as blocked_count
   from
        gv$lock
  where
        request > 0
  group by
        id1,id2
)
,blockers AS
(select
        L.*
       ,BR.blocked_secs
       ,BR.blocked_count
   from
        gv$lock    L
       ,blocked_resources  BR
  where
        BR.id1 = L.id1
    and BR.id2 = L.id2
    and L.lmode  > 0
    and L.block <> 0
)
select
      B.id1||'_'||B.id2||'_'||S.sid||'_'||S.serial#    as id
      ,'SID,SERIAL:'||S.sid||','||S.serial#||',LOCK_TYPE:'||B.type||',PROGRAM:'|
|S.program||',MODULE:'||S.module||',ACTION:'||S.action||',MACHINE:'||S.machine||
',OSUSER:'||S.osuser||',USERNAME:'||S.username
                                              as info
      ,B.blocked_secs
      ,B.blocked_count
  from
       gv$session   S
      ,blockers    B
 where
       B.sid = S.sid
;


select * from gv$lock where block=1;


SELECT a.sid, a.serial#, a.sql_id, b.sql_text from v$session a, v$sql b
WHERE
--a.status ='ACTIVE' and
a.username = 'WEBREPADMIN'
AND a.sql_id = b.sql_id AND a.process = '9654';


--------------------------------------------------------------------------------
Myke,

There were no inserts, updates, deletes made. Please find the query below for reference:

column "MVIEW BEING REFRESHED" format a30
column INSERTS format 9999999
column UPDATES format 9999999
column DELETES format 9999999
select SID_KNST,
       CURRMVOWNER_KNSTMVR || '.' || CURRMVNAME_KNSTMVR "MVIEW BEING REFRESHED",
       decode( REFTYPE_KNSTMVR, 1, 'FAST', 2, 'COMPLETE', 'UNKNOWN' ) REFTYPE,
       decode(GROUPSTATE_KNSTMVR, 1, 'SETUP', 2, 'INSTANTIATE', 3, 'WRAPUP', 'UNKNOWN' ) STATE,
       TOTAL_INSERTS_KNSTMVR INSERTS,
       TOTAL_UPDATES_KNSTMVR UPDATES,
       TOTAL_DELETES_KNSTMVR DELETES
  from X$KNSTMVR X
WHERE type_knst=6 and exists (select 1 from v$session s
                                where s.sid=x.sid_knst and
                                      s.serial#=x.serial_knst);

SID_KNST MVIEW BEING REFRESHED REFTYPE STATE INSERTS UPDATES
---------- ------------------------------ -------- ----------- -------- --------
DELETES
--------
432 WEBREPADMIN.MV_USERROLEAREATAB COMPLETE INSTANTIATE 0 0   LE   0
514 WEBREPADMIN.MV_USERROLEAREATAB UNKNOWN SETUP 0 0  LE   0

---------------------------------------
SELECT 'ALTER SYSTEM KILL SESSION '''||s.sid||','||s.serial#||''';'
FROM   v$session s
where --s.osuser='infor' and
s.sid in (select session_id from DBA_objects o, v$locked_object l
where o.object_id = l.object_id and o.object_name like '%BENE%');

--------------------------------------------------------------------------------
Which session is using most cpu:
select    ss.username,   se.SID,   VALUE/100 cpu_usage_seconds
FROM   v$session ss,    v$sesstat se,    v$statname sn
WHERE   se.STATISTIC# = sn.STATISTIC#
AND   NAME like '%CPU used by this session%'
AND   se.SID = ss.SID
--AND   ss.status='ACTIVE'
and    ss.username is not null
order by VALUE desc;
--------------------------------------------------------------------------------
select distinct cidn, co_code from cocodegroup where cidn in (
select cidn from (
select distinct cidn, length(co_code) from cocodegroup
) group by cidn having count(1) > 1
);
------------------------
-- HWSE row updates

SQL> select NAME, value, APPL_MAJOR_VER_ID from common.BASE_PROPERTIES@dblinkcrtp03tohwspr1 where name = 'ClientNameTranslation';

update PPT_DEATH_PROCEED_DSGN x set x.PARTICIPANT_ID  = (select b.PARTICIPANT_ID
from
(select rownum rn, PPT_DEATH_PROCEED_DSGN_ID from PPT_DEATH_PROCEED_DSGN) a,
(select rownum rn, PARTICIPANT_ID from primary_participant) b
where a.rn = b.rn and x.PPT_DEATH_PROCEED_DSGN_ID = a.PPT_DEATH_PROCEED_DSGN_ID);
-----------------------------
set lines 120
col ind format a40
col column_name format a30
col column_position format 999
select index_owner ||'.'||index_name, column_name, column_position from
all_ind_columns where table_name = 'PS_USER_SCRTY_TBL' order by 1,3;

---------------------------------------------------------
select owner || '.'|| object_name from all_objects where last_ddl_time > trunc(sysdate)
order by last_ddl_time;
-----------------------------------------------------
SET DEFINE ^
DEFINE SID=^^SID
DEFINE FILE=^^Filename
spool ^^FILE
connect cruvpd/cruvpd@^^SID
select count(1) from dual;
exit;

set define "^"
define company_id = ^^1
---
set def "^" verify off
SET FEED OFF
Set termout off

def v_vpd_sch=^^1
def passwd=^^2
def v_db=^^3

conn ^^v_vpd_sch/^^passwd@^^v_db
SET VERIFY OFF
Set termout on
SET SERVEROUTPUT ON
SHOW user

--------
delete from CN_PLAN_GROUP where CN_CONN_JOB_VERSION_OID like 'HRB:'||'^^company_id'||':%';


NEW HIRE:
 FILL IN I-9 form.
 https://corpintra4.adpcorp.com/pilot_i9.htm

---------------------------------------------------------
Listener process in catalog server:
SELECT * FROM v$session WHERE MODULE LIKE 'ADP - RLE (lis_key=%'
or select * from vw_active_listeners -- current user only
---------------------------------------------------------------


connect webrepadmin/webrepadmin@crtp02
connect webreppilot/webreppilot@crtp02
connect webreppod/webreppod@crtp02
col client_code format a30
col cidn format a20

select distinct cidn, substr(name, instr(name,'@')+1) client_code from payx_r17.associate where instr(name, '@') > 0 and active=1 and cidn = 'PAYXSCH0069946';

select distinct cidn, substr(name, instr(name,'@')+1) client_code from payx_r17.associate@dblinkcrtp02tocrtp01 where instr(name, '@') > 0 and active=1 and cidn = 'PAYXSCH0069276';

select distinct cidn, substr(name, instr(name,'@')+1) client_code from payx_r17.associate where instr(name, '@') > 0 and upper(name) like '%@GR8CLIPS' and active=1;

select distinct cidn, substr(name, instr(name,'@')+1) client_code from payx_r17.associate@dblinkcrtp02tocrtp01 where instr(name, '@') > 0 and upper(name) like '%@GR8CLIPS' and active=1;

select inst_key, pod_code from batclientinstance where client_code = upper('GR8CLIPS');


connect ggate/ggate@crtp01
select * from adpr_payx_client where db_userid = 'PAYXSCH0069276';

select DB_USERID, PARENT_CODE, DB_SERVER, DATABASE_CREATION_DATE, REGION_CODE
from payxapp.CLIENTDATABASE@Dblinkcrtp01topyxpr1
where DB_USERID in ('PAYXSCH0067266', 'PAYXSCH0061513');


update batclientinstance set inst_key=2 where client_code='GR8CLIPS';

--update batclientinstance set pod_code='PROD' where client_code='OVRETECH';
call app_security_context_ipay.set_Region_ccode('(0130, ''SB7'')','ER');
call base_t16_sec_cont.base_t16_app_cont('CDIPAPRIO@GENPAK','ER')
call base_t16_sec_cont.base_t16_app_cont('DMAHER@GODIVA','ER')


---------------------------------------------------------------

INSERT INTO BATCLIENTINSTANCE (CLIENT_CODE,INST_KEY,CLIENT_APPVERSION) VALUES('BV02','1','PILOT');
update BATCLIENTINSTANCE set CLIENT_APPVERSION = 'PILOT' where client_code = 'BV02';
INSERT INTO BATCLIENTINSTANCE (CLIENT_CODE,INST_KEY,pod_code) VALUES('BV02','1','PILOT');
update BATCLIENTINSTANCE  set pod_code = 'PILOT' where client_code = 'BV02';
INSERT INTO BATCLIENTPRODUCT (CLIENT_CODE,PRD_CODE,VER_CODE) VALUES('BV02','BASE','16');
update BATCLIENTPRODUCT  set ver_code = 16 where client_code = 'BV02' and PRD_CODE = 'BASE';
INSERT INTO BATCLIENTPRODUCT (CLIENT_CODE,PRD_CODE,VER_CODE) VALUES('ADPADMIN','BASE','16');
INSERT INTO BATCLIENTPRODUCT (CLIENT_CODE,PRD_CODE,VER_CODE) VALUES('CSRADMIN','BASE','16');
--------------------------------------------------------------------------

set serveroutput on size 1000000

declare
  type t is table of varchar2(100);
  b t := t('appadm', 'base_nv_t14', 'base_nv_t15', 'base_nv_t17', 'base_select_t14', 'base_select_t15', 'base_select_t16', 'cruvpd', 'ezlm_r11', 'hrb_r25', 'hwse_com14', 'hwse_r14', 'hwse_r15', 'hwse_r16', 'isireg', 'payx_r17', 'payx_r18', 'racs_r1', 'secusr', 'webrepadmin', 'webreppilot', 'webreppod');
  a t := t('crtd01', 'crtd02', 'crtdb01', 'crtq01', 'pyxy02');
  vcmd varchar2(1000);
begin
  for i in a.first .. a.last
  loop
    dbms_output.put_line('>' || a(i) );
    for j in b.first .. b.last
    loop
	    vcmd :=  b(j) || '/' || b(j) || '@' || a(i);
	    dbms_output.put_line(vcmd);
	end loop;
  end loop;
end;
/

--------------------------------------------------------------------------
set pagesize 0
set long 90000
set feedback off
set echo off

spool ezlm_r11_ddl.sql
SELECT DBMS_METADATA.GET_DDL('TABLE',u.table_name)      FROM USER_TABLES u;
spool off;
spool ezlm_r11_create_indexes.sql
SELECT DBMS_METADATA.GET_DDL('INDEX',u.index_name)      FROM USER_INDEXES u;
spool off;
spool ezlm_r11_drop_indexes.sql
select 'DROP INDEX '||index_name ||';' from user_indexes;
spool off;

---------------------------------------------------------------------------

ezlm clients query:
SELECT DISTINCT
upper(b.O) as client_code
FROM
      appadm.ISIPRODUCT_SC_CLIENT b
WHERE upper(b.ADPPRODUCTCODE)  IN ('PAYX2')  and
exists (
select 1
from
appadm.ISIPRODUCT_SC_CLIENT a
WHERE upper(a.ADPPRODUCTCODE)='CRT'
and  a.o=b.o)
and  exists (
select 1
from
appadm.ISIPRODUCT_SC_CLIENT a
WHERE upper(a.ADPPRODUCTCODE)='EZLABORMANAGER'
and a.o=b.o);

-----------------------------------------------------------------------------

avg report response time:
-------------------------

SELECT LPAD(FLOOR(XAVG_REPORT_RUNTIME / 3600), 2, 0) || ':' ||
       LPAD(FLOOR(MOD(XAVG_REPORT_RUNTIME, 3600) / 60), 2, 0) || ':' ||
       LPAD(ROUND(MOD(XAVG_REPORT_RUNTIME, 60)), 2, 0) TIMETAKEN
FROM   (SELECT ROUND(AVG(AVG_REPORT_RUNTIME)) XAVG_REPORT_RUNTIME
        FROM   (SELECT TRUNC(ST) ONDATE,
                       ROUND(AVG((EXTRACT(HOUR FROM RT) * 60 * 60 +
                                 EXTRACT(MINUTE FROM RT) * 60 +
                                 EXTRACT(SECOND FROM RT)))) AVG_REPORT_RUNTIME
                FROM   (SELECT A.REQ_KEY, A.ST, B.ET, (B.ET - A.ST) RT
                        FROM   (SELECT REQ_KEY, RLOG_TIMESTAMP ST
                                FROM   BATREQLOG
                                WHERE  RLOG_STATUS = 'RUN') A,
                               (SELECT REQ_KEY, RLOG_TIMESTAMP ET
                                FROM   BATREQLOG
                                WHERE  RLOG_STATUS = 'OK') B
                        WHERE  A.REQ_KEY = B.REQ_KEY
                        AND    A.ST < B.ET)
                WHERE  TO_CHAR(ST, 'D') IN (2, 3, 4, 5, 6)
                GROUP  BY TRUNC(ST)));

list dialy averages of report run times:
----------------------------------------

COL ONDATE FORMAT A15
COL TIMETAKEN FORMAT A20

SELECT ONDATE,
       LPAD(FLOOR(AVG_REPORT_RUNTIME / 3600), 2, 0) || ':' ||
       LPAD(FLOOR(MOD(AVG_REPORT_RUNTIME, 3600) / 60), 2, 0) || ':' ||
       LPAD(ROUND(MOD(AVG_REPORT_RUNTIME, 60)), 2, 0) TIMETAKEN
FROM   (SELECT TRUNC(ST) ONDATE,
               ROUND(AVG((EXTRACT(HOUR FROM RT) * 60 * 60 +
                         EXTRACT(MINUTE FROM RT) * 60 + EXTRACT(SECOND FROM RT)))) AVG_REPORT_RUNTIME
        FROM   (SELECT A.REQ_KEY, A.ST, B.ET, (B.ET - A.ST) RT
                FROM   (SELECT REQ_KEY, RLOG_TIMESTAMP ST
                        FROM   BATREQLOG
                        WHERE  RLOG_STATUS = 'RUN') A,
                       (SELECT REQ_KEY, RLOG_TIMESTAMP ET
                        FROM   BATREQLOG
                        WHERE  RLOG_STATUS = 'OK') B
                WHERE  A.REQ_KEY = B.REQ_KEY
                AND    A.ST < B.ET
                AND a.st > trunc(sysdate-5))
        GROUP   BY TRUNC(ST))
WHERE  TO_CHAR(ONDATE, 'D') IN (2, 3, 4, 5, 6)
ORDER  BY ONDATE DESC;



variable Avg_Report_Runtime number
exec :Avg_Report_Runtime := 119.920596

select
lpad(floor(:Avg_Report_Runtime/3600), 2, 0) || ':' ||
lpad(floor(MOD(:Avg_Report_Runtime, 3600)/60), 2, 0) || ':' ||
lpad(round(MOD(:Avg_Report_Runtime, 60)), 2, 0) timetaken
from dual;
00:01:60



--- Reports ran longer than 5 mins today:

select * from (
select req_key, req_status
,(cast(endts as date)-cast(startts as date))*86400 duration
from (
select b.req_key,  b.req_status,
lag(br.RLOG_TIMESTAMP, 1) over (partition by b.req_key order by br.rlog_timestamp) startts,
br.RLOG_TIMESTAMP endts,
br.rlog_msg,
row_number() over (partition by b.req_key order by br.rlog_timestamp desc) rn
from batreqlog br, batreq b
where b.req_key = br.req_key
--and b.req_status = 'ERR'
and b.req_timestamp > trunc(sysdate)
) where rn =1
order by req_key
) where duration  > 300;


-------------------------------------------------------------------------------------

SELECT 'HR25_' || table_name FROM all_tab_columns WHERE column_name = 'COMPANY_ID' AND owner = 'HRB_R25'
MINUS
SELECT object_name FROM dba_policies WHERE object_owner = 'CRUVPD'  AND object_name LIKE 'HR25%'


--------------------------------------------------------------------------------------
CALL ezlm_r11_security_context.set_app_context('BBENDER@PUREINTEG','ER','0FTWX00J97T00CPG','PUREINTEG');


SELECT custid as cidn,iSICLIENTID as client_code FROM ADPREPORTING_VIEW WHERE UPPER(ISICLIENTID)='ARCMONTMD';
170190               EEMI

SELECT  DISTINCT UT.USERID, ASSOCIATEOID
FROM   EZ11_PERSON_TAB PT,
       EZ11_USER_TAB UT
WHERE  PT.CIDN=UT.CIDN
  AND PT.EMPLOYEEID=UT.EMPLOYEEID
  AND UPPER(PT.CIDN) = 170190;
  AND UPPER(USERID)=UPPER('KPICKAVANCE');

SELECT  DISTINCT UT.USERID, ASSOCIATEOID
FROM   PERSON_TAB PT,
       USER_TAB UT
WHERE  PT.CIDN=UT.CIDN
  AND PT.EMPLOYEEID=UT.EMPLOYEEID
  AND UPPER(PT.CIDN) = '54831'
  AND UPPER(USERID)=UPPER('MMCCULLIAN');

select count(1) from user_tab where  CIDN = 'ARCMONTGOMERY' and upper(userid) = 'LJACKSON';
select employeeid from user_tab where upper(userid) = 'CGREEN' AND CIDN = 'ENVISIONEMI';
select * FROM PERSON_TAB WHERE employeeid = 'HM9000388' AND CIDN = 'APHL';

EZLM R11.1 TESTING...
SELECT * FROM adpreporting_view WHERE upper(isiclientid) LIKE 'T%'
SELECT * FROM person_tab WHERE cidn = 172003 AND associateoid IS NOT NULL;
SELECT * FROM user_tab WHERE cidn = 172003 AND employeeid = '499000492';
CALL ezlm_r11_security_context.set_app_context('CHEISE@TILTONSCHL','ER','0QX9BWNFJGV0009Z','TILTONSCHL');

SELECT x.userid, x.employeeid, y.associateoid FROM user_tab x, person_tab y
WHERE x.employeeid = y.employeeid AND x.cidn = y.cidn
AND y.associateoid IS NOT NULL;

('jaya1@002', 'ER', '012JR4R5N2Q00GAS', '002')

SELECT * FROM user_tab WHERE employeeid = '002001547'
SELECT * FROM adpreporting_view WHERE custid = '54670'

CALL ezlm_r11_security_context.set_app_context('jaya1@002', 'ER', '012JR4R5N2Q00GAS', '002');
CALL ezlm_r1117_sec_context.set_app_context('DJONES1@FOODKINGIN', 'ER', '01R5BV5QACK0182W', 'FOODKINGIN');


ENVISIONEMI

connect ggate/ggate@crtp01
select count(1) from ARCMONTGOMERY.person_tab@DBLINKCRTP01TOELMP123;
select count(1) from ARCMONTGOMERY.person_tab@DBLINKCRTP01TOELMP808;
select username from all_users@Dblinkcrtp01toelmp123 where username like 'PMSITAMPA';
select * from adpreporting_view@dblinkcrtp01toelmpr1 where upper(userid) like 'PMSITAMPA';
---------------------------------------------------------------------------------------
set serveroutput on size 1000000
declare
 vcmd varchar2(1000);
 vcnt number;
begin
 for i in (select table_name from user_tables) loop
   vcnt := 0;
   vcmd := 'select /*+ parallel(t, default) */ count(1) from ' || i.table_name || ' t';
   execute immediate vcmd into vcnt;
   dbms_output.put_line(i.table_name || ' : ' || vcnt);
 end loop;
end;
/

connect isireg/isireg@crtp02
---------------------------------------------------------------------------------------
  ## To remove TILTONSCHL from LDAP simulation
delete from appadm.isiproduct_sc_client where client_code=<evatestclient>

adpreporting_view: Lists all ezlm dbs. Provides server and schema for each ezlm db.
                   Contains all clients.

Query netsecure for all clients with ezLabor manager & crt profiles

---------------------------------------------------------------------------------------
## cross product
    You can identify the clients who have ezlm & payx cross-product reports. Pl. make sure that cidn is not moving to node2.

For example: cidn 'PAYXSCH0040449' has ezlm & payx cross-product report. It should not be moved

select distinct substr(a.name,instr(a.name,'@')+1) clnt , a.cidn
from payx_r17.associate a,
adpreporting_view b
where a.cidn = 'PAYXSCH0069276' and
instr(a.name, '@') != 0
and b.isiclientid is not null and
upper(b.isiclientid) = upper(substr(a.name,instr(a.name,'@')+1))
----------------------------------------------------------------------------

exp cruvpd/cruvpd@crtp01 tables=(bene_248666, emp_248666) statistics=none file=248666.dmp
imp cruvpd/cruvpd@crtd01 file=248666.dmp statistics=none fromuser=cruvpd touser=cruvpd

exp acs_mas_common/acs_mas_common@crtq01 file=common.dmp direct=y indexes=yes triggers=no constraints=yes statistics=none recordlength=64000
imp acs_mas_common/acs_mas_common@cru02d file=common.dmp statistics=none fromuser=acs_mas_common touser=acs_mas_common
-----------------------------------------------------------------------------
select	TABLESPACE_NAME,
	TOTAL_EXTENTS,
	EXTENTS_COALESCED,
	PERCENT_EXTENTS_COALESCED,
	TOTAL_BYTES,
	BYTES_COALESCED,
	TOTAL_BLOCKS,
	BLOCKS_COALESCED,
	PERCENT_BLOCKS_COALESCED
from 	dba_free_space_coalesced
where TABLESPACE_NAME = 'CRUP02_DATA'
order 	by TABLESPACE_NAME


select	a.TABLESPACE_NAME,
	a.BYTES bytes_used,
	b.BYTES bytes_free,
	b.largest,
	round(((a.BYTES-b.BYTES)/a.BYTES)*100,2) percent_used
from
	(
		select 	TABLESPACE_NAME,
			sum(BYTES) BYTES
		from 	dba_data_files
		group 	by TABLESPACE_NAME
	)
	a,
	(
		select 	TABLESPACE_NAME,
			sum(BYTES) BYTES ,
			max(BYTES)
		from 	dba_free_space
		group 	by TABLESPACE_NAME
	)
	b
where 	a.TABLESPACE_NAME = 'CRUP02_DATA' and a.TABLESPACE_NAME=b.TABLESPACE_NAME
order 	by ((a.BYTES-b.BYTES)/a.BYTES) desc


col "Tablespace" for a22
col "Used MB" for 99,999,999
col "Free MB" for 99,999,999
col "Total MB" for 99,999,999

select df.tablespace_name "Tablespace",
totalusedspace "Used MB",
(df.totalspace - tu.totalusedspace) "Free MB",
df.totalspace "Total MB",
round(100 * ( (df.totalspace - tu.totalusedspace)/ df.totalspace))
"Pct. Free"
from
(select tablespace_name,
round(sum(bytes) / 1048576) TotalSpace
from dba_data_files
group by tablespace_name) df,
(select round(sum(bytes)/(1024*1024)) totalusedspace, tablespace_name
from dba_segments
group by tablespace_name) tu
where df.tablespace_name = tu.tablespace_name ;


--------------------------------------------------------------
export import:
query="where cidn in ('FAMILYGW','ECHESHIRE','HIWIRED')"
userid=ezlm_r11/ezlm_r11
file=/tmp/ezlm_r11_bi.dmp
compress=y
log=/tmp/ezlmexp.log
statistics=NONE
rows=yes
indexes=yes
tables=(
ACCDEFINITION_TAB,
ACCTRANSACTION_TAB,
DATEDEFINITION_TAB,
)
--------------------------------------------------------------
ISI REGISTRY DATA ALWAYS GETS REPLICATED TO NODE2
EZLM DATA REPLICATED TO NODE1
--------------------------------------------------------------

Requests to ezLM DBAs, use ‘Camarillo EZLM Support.’
 CC : Scott Weiss

The AOID is populated as part of the Enhanced Integration request for the client OR when a New Hire process is triggered by making use of the Integrated Editor.


call payx_r17_security_context_new.set_app_context('MTriolo@fountgrp', 'ER', '', '');

ora-01427: single row subquery error:
SELECT distinct (SELECT '[' || ty.description || '] : ' || count(1)
         FROM  px17_type ty,
               px17_securityobject sc
         WHERE ch.cidn = sc.cidn
         AND   ty.cidn IN ('COMMON', ch.cidn)
         AND   ch.home_dept_code = ty.NAME
         AND   ty.category = 'T_CO_DEPT'
         AND   ty.securityoid = sc.OID
         AND   ch.co_code = substr(sc.NAME, 8)
		 group by ty.description
		 having count(1)>1) home_department_descr
FROM   px17_checkhistory ch
WHERE  ch.active = 1;

SELECT distinct (SELECT '[' || ty.description || '] : ' || count(1)
         FROM  type ty,
               securityobject sc
         WHERE ch.cidn = 'PAYXSCH0040876'
         and sc.cidn = 'PAYXSCH0040876'
         AND   ty.cidn IN ('COMMON', 'PAYXSCH0040876')
         AND   ch.home_dept_code = ty.NAME
         AND   ty.category = 'T_CO_DEPT'
         AND   ty.securityoid = sc.OID
         AND   ch.co_code = substr(sc.NAME, 8)
		 group by ty.description
		 having count(1)>1) home_department_descr
FROM   checkhistory ch
WHERE  ch.active = 1;

---------------------------------------------------------------
mismatch_instkey:

SELECT *
FROM   (SELECT DISTINCT upper(b.o) client_code, pa.cidn, bca.inst_key, bca.pod_code,
                         decode(target_location, 'crtp01', 1, 'crtp02', 2) tgtloc
         FROM   payx_r17.associate pa,
                appadm.isiproduct_sc_client b,
                batclientinstance bca,
                ggate.adpr_payx_client@dblinkcrtp02tocrtp01 apc
         WHERE  instr(pa.NAME, '@') > 0
         AND    upper(substr(pa.NAME, instr(pa.NAME, '@') + 1)) = upper(b.o)
         AND    pa.active = 1
         AND    bca.client_code = upper(b.o)
         AND    apc.db_userid = pa.cidn)
WHERE  inst_key != tgtloc
ORDER  BY client_code, cidn;

connect webrepadmin/webrepadmin@crtp02
connect webreppilot/webreppilot@crtp02
connect webreppod/webreppod@crtp02

set serveroutput on size 1000000;

DECLARE
    vstr     VARCHAR2(1024);
    inst_key NUMBER;
BEGIN
    FOR i IN (SELECT DISTINCT client_code, inst_key, tgtloc, cidn
              FROM   (SELECT DISTINCT upper(b.o) client_code, pa.cidn, bca.inst_key, bca.pod_code,
                                       decode(target_location, 'crtp01', 1, 'crtp02', 2) tgtloc
                       FROM   payx_r17.associate pa, appadm.isiproduct_sc_client b,
                              batclientinstance bca, ggate.adpr_payx_client@dblinkcrtp02tocrtp01 apc
                       WHERE  instr(pa.NAME, '@') > 0
                       AND    upper(substr(pa.NAME, instr(pa.NAME, '@') + 1)) = upper(b.o)
                       AND    pa.active = 1
                       AND    bca.client_code = upper(b.o)
                       AND    apc.db_userid = pa.cidn)
              WHERE  inst_key != tgtloc
              ORDER  BY client_code, cidn)
    LOOP
        BEGIN
            inst_key := 0;
            vstr     := 'update batclientinstance set inst_key = 2 where client_code = ''' || i.client_code || ''';';
            dbms_output.put_line(vstr);
            dbms_output.put_line('commit;');
            --vstr     := 'update batclientinstance set inst_key = 2 where client_code = :ccd';
            --EXECUTE IMMEDIATE vstr USING i.client_code;
            --COMMIT;

            --vstr := 'select inst_key from batclientinstance where client_code = :ccd';
            --EXECUTE IMMEDIATE vstr into inst_key USING i.client_code;
            --vstr := 'insert into mismatch_instkey2 select * from mismatch_instkey1 where client_code = :ccd';
            --execute immediate vstr using i.client_code;
            --dbms_output.put_line(vstr || ' ' || i.client_code || ' ' || inst_key);

        EXCEPTION
            WHEN OTHERS THEN
                dbms_output.put_line('error processing ' || i.client_code);
        END;
    END LOOP;
END;
/

----------------------------------------------------------------


with node1clients as (
    select distinct upper(substr(pa.NAME, instr(pa.NAME, '@') + 1)) ccd
	from payx_r17.associate@dblinkcrtp02tocrtp01 pa
	where active = 1
	  and instr(pa.NAME, '@') > 0
	  and instr(pa.NAME, ' ') = 0
)
SELECT *
FROM   (SELECT DISTINCT upper(b.o) client_code, pa.cidn, bca.inst_key, bca.pod_code,
                         decode(target_location, 'crtp01', 1, 'crtp02', 2) tgtloc,
						 (case
						   when exists (select 1 from node1clients where upper(b.o) = ccd)
						   then 'CONFLICT'
						   else 'OK'
						  end) repl
         FROM   payx_r17.associate pa,
                appadm.isiproduct_sc_client b,
                batclientinstance bca,
                ggate.adpr_payx_client@dblinkcrtp02tocrtp01 apc
         WHERE  instr(pa.NAME, '@') > 0
         AND    upper(substr(pa.NAME, instr(pa.NAME, '@') + 1)) = upper(b.o)
         AND    pa.active = 1
         AND    bca.client_code = upper(b.o)
         AND    apc.db_userid = pa.cidn)
WHERE  inst_key != tgtloc
ORDER  BY repl, client_code, cidn;

----------------------------------------------------------------------

cross products:

SELECT * FROM catrelat WHERE
(tab_code1 LIKE '%EZLM@@11' AND tab_code2 LIKE '%PAYX2@@17')
OR
(tab_code2 LIKE '%EZLM@@11' AND tab_code1 LIKE '%PAYX2@@17');


SELECT * FROM catrelat WHERE
(tab_code1 LIKE '%HRB@@25' AND tab_code2 LIKE '%PAYX2@@17')
OR
(tab_code2 LIKE '%HRB@@25' AND tab_code1 LIKE '%PAYX2@@17');


SELECT * FROM catrelat WHERE
(tab_code1 LIKE '%HRB@@25' AND tab_code2 LIKE '%EZLM@@11')
 OR
(tab_code2 LIKE '%HRB@@25' AND tab_code1 LIKE '%EZLM@@11');
-----------------------------------------------------------------------

SELECT 'On ' || d.dt || ' Sessions: ' || a.s || '   Reports: ' || b.r
FROM
(SELECT to_char(trunc(SYSDATE)) dt FROM dual) d,
(SELECT COUNT(1) s FROM secsession WHERE trunc(session_timestamp) = trunc(SYSDATE))a,
(SELECT COUNT(1) r FROM batreq WHERE trunc(req_timestamp) = trunc(SYSDATE)) b;

---------------------------------------------------------------------------
SELECT * FROM ADPR_PAYX_CLIENT_MERGE WHERE CLIENT_ID in ('ASTEQUITY', 'RKBAMST');
select * from ADPR_PAYX_CLIENT_ID where CLIENT_ID in ('ASTEQUITY', 'RKBAMST');
select * from ADPR_PAYX_CLIENT WHERE DB_USERID IN ('PAYXSCH0007009', 'PAYXSCH0012186');

--------------------------------------------------------------------------------

set lines 150
col index_name format a30
col column_name format a30
col column_position format 99
select index_name, column_name, column_position
from all_ind_columns
where 1=1
and table_name = 'CATCLIENT'
and index_name = 'SYS_C004968'
and table_owner = 'HRB_REG0001'
order by 1,3;

select table_name, BLOCKS, EMPTY_BLOCKS, NUM_ROWS, SAMPLE_SIZE, LAST_ANALYZED
from all_tables
where table_name = 'EV_CHANGE'
and owner = 'HRB_REG0001';

select INDEX_NAME, NUM_ROWS, UNIQUENESS, DISTINCT_KEYS, LEAF_BLOCKS, BLEVEL, CLUSTERING_FACTOR, LAST_ANALYZED
from all_indexes
where table_name = 'EV_EVENT'
and owner = 'HRB_REG0001';



exec dbms_stats.delete_schema_stats(ownname => User);
exec dbms_stats.gather_schema_stats(ownname => User, method_opt => 'FOR ALL COLUMNS SIZE 1', cascade => TRUE, degree => 40);
exec dbms_stats.gather_table_stats(ownname => 'APPADM', tabname => 'ISIUSER1', estimate_percent => 40, method_opt => 'FOR ALL INDEXED COLUMNS SIZE 1', cascade => TRUE, degree => 8);

----------------------------------------------------------------------------------
what is happenning with payx_view_access:

truncate payx_view_access_current
px17_payx_view_access  -> payx_view_access_current

(payx_view_access - payx_view_access_current) - > +payx_view_access_delete

delete (payx_view_access - payx_view_access_current)
commit;

(payx_view_access_current - payx_view_access) -> +payx_view_access
commit;
------------------------------------------------------------------------------------
ISIREG_R43 ISIREG_ADM44 ISIREG_CLNT44 ISIREG_COM44

select a.table_name, a.index_name
from
(select table_name, index_name
from all_indexes where owner ='ISIREG') a
where
a.index_name not like '%GG%'
and not exists (select 1 from
(select table_name, index_name
from all_indexes where owner ='ISIREG_R44') b
where a.table_name = b.table_name
  and a.index_name = b.index_name)
and exists (select 1 from
(select table_name, index_name
from all_indexes where owner ='ISIREG_R44') b
where a.table_name = b.table_name
);

-----------------------------------------------------------------------------------------
SET DEFINE "^"
DEFINE SID=^^1SID
DEFINE FILE=^^2Filename
spool ^^FILE

connect cruvpd/cruvpd@^^SID
set heading off

-------------------------------------------------------------------------------------------
select * from (
select hwse_schema_name, st, et, (et-st) duration from (
select distinct hwse_schema_name, min(refresh_start_time) over (partition by hwse_schema_name) st,
max(refresh_start_time) over (partition by hwse_schema_name) et
FROM HWSE_ADMIN.MV_REFRESH_LOG_HIST WHERE 1=1
and run_date =
(select run_date from (select  run_date, row_number() over (order by run_date desc) rn from
 (select distinct run_date from HWSE_ADMIN.MV_REFRESH_LOG_HIST)) where rn = 1)
 )
order by 4 desc) where rownum < 11;


/apps/crt/base/copy_upgradescripts/upgrade_scripts.txt



hwse vpd call:
call base_t17_sec_cont_0005.base_t17_app_cont ('testbenrep@adp','CSR', 'ADPR01', 'LIVE');
call base_t16_sec_cont.base_t16_app_cont('DMAHER@GODIVA','ER');
call base_t16_sec_cont.base_t16_app_cont('HLucas@IGoHR','ER');
call base_t14_sec_cont.base_t14_app_cont('RDUTCHER@ADP', 'ADP');

select count(1) from b17_court_order_data_vw_0005;


HWSE client which one took longer than 5 hours to complete election all refresh in this month?
select HWSE_SCHEMA_NAME--, count(1)
from MV_REFRESH_LOG_HIST where 1=1
--and HWSE_SCHEMA_NAME = 'HWSE_REG0105'
and MV_NAME = 'ELECTION_ALL_MV'
and RUN_DATE > TO_DATE('03/01/2014', 'MM/DD/YYYY')
and (REFRESH_END_TIME-REFRESH_START_TIME) > TO_DSINTERVAL('0 05:00:00')
group by hwse_schema_name order by 1;




hwse client in which version??

SELECT SCHEMA_USER_ID, A.APPL_MAJOR_VER_ID
FROM ADMIN.SERVER_SESSION_CONFIG@dblinkcrtp01tohwspr1 A,
     ADMIN.CLIENT_REGISTRY@dblinkcrtp01tohwspr1 B,
     COMMON.CLIENT@dblinkcrtp01tohwspr1 C,
     (SELECT DISTINCT upper(b.O) as client_code
      FROM   appadm.ISIPRODUCT_SC_CLIENT b
      WHERE upper(b.ADPPRODUCTCODE)  IN ('HWSE')  and
      exists (select 1 from
              appadm.ISIPRODUCT_SC_CLIENT a
              WHERE upper(a.ADPPRODUCTCODE)='CRT'
              and a.o=b.o)
     ) isi
WHERE A.LOGICAL_SCHEMA_ID = B.LOGICAL_SCHEMA_ID
AND   A.SCHEMA_VERSION_ID = B.SCHEMA_VERSION_ID
AND B.BASE_CLIENT_ID = C.BASE_CLIENT_ID
AND A.SCHEMA_USER_ID NOT LIKE '%CONFIG'
AND A.SCHEMA_USER_ID NOT LIKE '%CTEST'
AND A.SCHEMA_USER_ID NOT LIKE '%TEST'
and a.LOGICAL_SCHEMA_ID=isi.client_code
AND A.SCHEMA_USER_ID ='GODIVA'
order by SCHEMA_USER_ID;

SELECT * FROM ADMIN.SERVER_SESSION_CONFIG@DBLINKCRU04PTOHWS11P
WHERE LOGICAL_SCHEMA_ID = 'BANKUNITED';


select count(1) from EWSCRIPPSCTEST.election@dblinkcrtphw01tohwspr1;


------------------------------------------------------------------------------------------

hrb vpd call
call hrb_r25_security_context.set_app_context('qacre1@ieee.org','ER','011PQM3FBNB0004R','011PQM3FBNB00069','','11111111110');
call hrb_r25_security_context_0001.set_app_context('qacre1@ieee.org','ER','011PQM3FBNB0004R','011PQM3FBNB00069','','11111111111');


call hrb_r25_security_context.set_app_context('qacre1@ieee.org','ER','011PQM3FBNB00069','011PQM3FBNB0004Q','HR25_EARNINGS_EARNINGS_INFO_VW.PIT_DATE#=#TO_DATE(''07/07/2009'', ''MM/DD/YYYY'')','1111111111')

select count(distinct company_id) from hr25_company_auth;

hrb policies verification:
SELECT synonym_name FROM All_Synonyms WHERE table_owner = 'HRB_R25' AND owner = 'CRUVPD'
AND table_name IN (
SELECT DISTINCT table_name FROM all_tab_cols WHERE owner = 'HRB_R25' AND column_name = 'COMPANY_ID'
)
MINUS
SELECT OBJECT_NAME FROM dba_policies WHERE object_owner = 'CRUVPD' AND object_name LIKE 'HR25%'

should return 0 records.




  call hrb_r25_security_context.set_app_context('PNEIL@MAZDA','ER','01JM5NN9VN00023B','1432C88AF9E0050E','HR25_WORK_JOB_INFO_VW.PIT_DATE#=#TO_DATE(''12/03/2009'', ''MM/DD/YYYY'')','1101111111')

  call payx_r17_security_context_new.set_app_context('PNEIL@MAZDA','ER','PX17_R6_EMPLOYEE_VW HR25_WORK_JOB_INFO_VW','')
------------------------------------------------------------------------------------------

The DL formerly known as Roseland Integration Services is now Corp IT Shared Products Roseland.
The DL formerly known as Roseland Integration Svcs Leadership is now Corp IT Shared Products Leadership.
The DL formerly known as Roseland Integration Svcs Remote is now Corp IT Shared Products Remote.
The DL formerly known as Roseland Integration Svcs Offshore is now Corp IT Shared Products Offshore.

----------------------------------------------------------------------------------------

report on queries run with pay_date filter specified as 2008
select COUNT(distinct qq.qry_key)
--,qq.client_code
from qryquery qq, batclientproduct bp,
qryfilter qf,
qryfilter qf1
where trunc(qq.qry_lastchange) >trunc(sysdate-120)
and bp.client_code=QQ.CLIENT_CODE AND bp.prd_code='PAYX2' and bp.ver_code=17
and qf.qry_key=qq.qry_key and qf.flt_value LIKE '%2008%'
and qf.QRY_KEY =qf1.qry_key
and qf1.qry_key=qq.qry_key and qf1.col_code ='PAY_DATE'


----------------------------------------------------
[dc2prcrptetl2:/apps/crt/dbscripts] cat non_election_kill_16_node3.sql
connect ggate/ggate@crtp03
SELECT 'ALTER SYSTEM KILL SESSION '''||s.sid||','||s.serial#||''';'
FROM   v$session s
where s.osuser='infor'
and s.sid in (select session_id from DBA_objects o, v$locked_object l
where o.object_id = l.object_id and o.object_name like 'BASE_T16_%' and o.object_name <>'BASE_T16_ELECTION_DATA_VW');
[dc2prcrptetl2:/apps/crt/dbscripts]
[dc2prcrptetl2:/apps/crt/dbscripts] cat election_kill_16_node3.sql
connect ggate/ggate@crtp03
SELECT 'ALTER SYSTEM KILL SESSION '''||s.sid||','||s.serial#||''';'
FROM   v$session s
where s.osuser='infor'
and s.sid in (select session_id from DBA_objects o, v$locked_object l
where o.object_id = l.object_id and o.object_name='BASE_T16_ELECTION_DATA_VW');



SELECT a.serial#, a.sid, a.username, c.sql_text
FROM   v$session a, v$sqltext c
WHERE   c.hash_value = a.sql_hash_value
--       AND a.process IN ('28428')
  AND   upper(c.sql_text) like '%PAYX_VIEW%'
  and   a.status = 'ACTIVE';

----------------------------------------------------------------

ADVANCED NEW HOUSE REPORT:
##########################
connect racs_r1/racs_r1@crtp02

select * from org where upper(ISI_ORG_CD) = 'ANCOM';

--create table tx1 as
truncate table tx1;

insert into tx1
select upper(associate_id) associate_id,
       upper(associate_oid) associate_oid,
       family_nm, given_nm, email
from associate
where upper(org_id) = '0F18AC8F6B800279';

-- = '0F18AC8F6B800279';
-- 0F18AC8F6B800279
create index idx_tx1 on tx1(associate_id, associate_oid);

select distinct x from (
select  /*+ parallel(akv, default) */
        'ANCom'              || ',' ||
        ass.family_nm        || ',' ||
        ass.given_nm         || ',' ||
        'Employee ID'        || ',' ||
        akv.value            || ',' ||
        ass.email            || ',' ||
        upper(au.login_id)   || ',' ||
        au.create_dt x
from
        associate_user au,
        tx1 ass,
        associate_key_value akv
where   ass.associate_id    = akv.associate_id
    and ass.associate_oid       = au.associate_oid
        and au.associate_id     = akv.associate_id
        and akv.prov_sys_key_id = 15
order by upper(ass.family_nm) asc, upper(ass.given_nm), akv.value)
order by x;

drop table tx1;

================================================================


call payx_r17_sec_context.set_app_context('U8EGPITTS@N02SR0032TRREG04','ER','', '');


select count(*) from PX17_CHECKITEM ;
select count(*) from PX165_CHECKITEM;
select count(*) from PX_R17_REG01_CHKITEM;
select count(*) from PX_R17_REG02_CHKITEM;
select count(*) from PX_R17_REG03_CHKITEM;
select count(*) from PX_R17_REG04_CHKITEM;
select count(*) from PX_R17_REG05_CHKITEM;
select count(*) from PX_R17_REG06_CHKITEM;
select count(*) from PX_R17_REG07_CHKITEM;
select count(*) from PX_R17_REG08_CHKITEM;
select count(*) from PX_R17_REG09_CHKITEM;
select count(*) from PX_R17_REG10_CHKITEM;
select count(*) from PX_R17_REG11_CHKITEM;
select count(*) from PX_R17_REG12_CHKITEM;
select count(*) from PX_R17_REG13_CHKITEM;
select count(*) from PX_R17_REG14_CHKITEM;
select count(*) from PX_R17_REG15_CHKITEM;
select count(*) from PX_R17_REG16_CHKITEM;
select count(*) from PX_R17_REG17_CHKITEM;
select count(*) from PX_R17_REG26_CHKITEM ;
=============================================

ezlm sp1 new files:
    Time Off Requests
    Timeclocks
    Time Punch Audit

=======================================================

select sql_fulltext from v$sql where sql_id = '2rn89n92h85v2'
======================================


///////// er users for hwse

SELECT distinct upper(adp.member_id) memid,
  DECODE(rinfo.role,1,'EXTERNAL',0,'INTERNAL') USER_TYPE,
  ginfo.group_security_id,
  sinfo.logical_schema_id CLIENT_ID
FROM
   BASE_ADP_ID_T16 adp,
   BASE_SEC_INFO_T16 sinfo,
   BASE_GROUP_SEC_T16 ginfo,
   BASE_ROLE_INFO_T16 rinfo
WHERE
    adp.member_id = sinfo.member_id
and adp.resource_nm = 'Report.ADPReportingTool'
and sinfo.member_id=ginfo.member_id(+)
and sinfo.member_id=rinfo.member_id
and sinfo.LOGICAL_SCHEMA_ID=ginfo.cidn(+)
and ginfo.group_security_id = '$ALL$'
and sinfo.LOGICAL_SCHEMA_ID in ('IGOHR')
order by upper(adp.member_id);


SELECT
distinct
adp.member_id,
DECODE(rinfo.role,1,'EXTERNAL',0,'INTERNAL') USER_TYPE,
ginfo.group_security_id,
sinfo.logical_schema_id CLIENT_ID
FROM
   BASE_ADP_ID_T16 adp,
   BASE_SEC_INFO_T16 sinfo,
   BASE_GROUP_SEC_T16 ginfo,
   BASE_ROLE_INFO_T16 rinfo
WHERE
    adp.member_id = sinfo.member_id
and adp.resource_nm = 'Report.ADPReportingTool'
and sinfo.member_id=ginfo.member_id(+)
and sinfo.member_id=rinfo.member_id
and sinfo.LOGICAL_SCHEMA_ID=ginfo.cidn(+)
and sinfo.LOGICAL_SCHEMA_ID in ( 'GK2CTEST')
and upper(adp.member_id) = upper('gkcbsa@gk2')
;



and upper(adp.member_id)=upper('prodtestbenrep@adp')



DELETE  from hwse_com14.base_adp_id_t16
where (upper(member_id) like '%@%CTEST'
or upper(member_id) like '%@%CONFIG'
OR upper(member_id) like '%@%TEST');

DELETE  from BASE_GROUP_SEC_T16
where (upper(member_id) like '%@%CTEST'
or upper(member_id) like '%@%CONFIG'
OR upper(member_id) like '%@%TEST');

DELETE  from BASE_ROLE_INFO_T16
where (upper(member_id) like '%@%CTEST'
or upper(member_id) like '%@%CONFIG'
OR upper(member_id) like '%@%TEST');

DELETE  from BASE_SEC_INFO_T16
where (upper(member_id) like '%@%CTEST'
or upper(member_id) like '%@%CONFIG'
OR upper(member_id) like '%@%TEST');

UPDATE BASE_GROUP_SEC_T16 SET CIDN=cidn||'CTEST' where upper(member_id) not like '%@ADP';
UPDATE BASE_SEC_INFO_T16  SET logical_schema_id=logical_schema_id||'CTEST' where upper(member_id) not like '%@ADP';

======================================

HWSE client not showing up in the MV refresh dropdown:
The client IATSPF01 is not showing up in the MV Refresh dropdown because it's on version 185 while the Ben Rep user is on version 17 (client CSRADMIN).

You'll have to change the product version before accessing the MV refresh tool. That should work the way you want.

I have no idea if anyone refreshed the data mart for this client though.




============================

SELECT dbms_crypto.HASH(utl_i18n.string_to_raw('VIJAY', 'AL32UTF8'), 2) md5 FROM dual;

 select ora_hash('adpr') from dual;


========================
MY COMPUTER\HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Safer\0\Paths\

==================================
SELECT * FROM secsession WHERE upper(USER_login) LIKE 'SUTSMAN@PLUMB'
 AND SESSION_TIMESTAMP > TRUNC(SYSDATE);
SELECT * FROM secsessionval WHERE SESSION_ID = '0928909442073'
SELECT * FROM webreppod.secsession WHERE upper(USER_login) LIKE 'SANDERSON@REDROOF' AND SESSION_TIMESTAMP > TRUNC(SYSDATE);


=======================================

There are two SSN fields:

· Social Security Number: Varying according to ssn mask used on VPD
	 ssn mask : 0 implies full ssn will be displayed.
	 ssn mask : 1 implies only last four digits will be displayed.

 - in hrb:  1 or more  implies  full ssn will be displayed
            0  implies  partial or full mask
                      nvl((select decode(substr(value,instr(value,'fullssnmaskingrequired:')+23)
                         ,0,  'XXX-XX-' || substr(trim(ssn), 8, 4)
                         ,1, 'XXX-XX-XXXX','XXX-XX-XXXX')
             from HR25_COMPANY_SETTINGS where key ='natid'
             and settings_group_id = '10'
             and value like '%mask%'
             and company_id = v_company_id and rownum = 1),'XXX-XX-XXXX')
          -ve number:  full mask


· Social Security Number Masked: should never display unmasked values.
	Catalog should define XXX-XX-9999 for this field (or XXX-XX-XXXX).

Check catalog. All masked fields should have mask (xxx-xx-9999) or (xxx-xx-xxxx).

acs enabled clients:
  ssn mask -1 => fully mask the ssn.

select ssn_mask from sac_sec_view_all where upper(isi_user_id) = 'TCONWAY@TIEDOWN2';

===================================
SHOW SUBJECT AREAS:
==================

set feedback off timing off verify off define off timing off
set lines 200
col area format a50
COL filename FORMAT A50
COL tab_code FORMAT A50

prompt ######################################################################################
SELECT CASE WHEN rn = 1 THEN area_name ELSE '    ' END AREA, filename, tab_code FROM (
SELECT AREA_NAME, Row_Number() over (PARTITION BY area_name ORDER BY area_name) rn,
       filename, tab_code FROM (
SELECT a.*, b.tab_code,
(select x.TAB_LABEL from cattable x where x.tab_code=b.tab_code and x.TAB_HIDDEN='f') filename
FROM catarea a, catareatable b
WHERE a.area_key = b.area_key
AND b.tab_code like
'%@@HRII@@206'
) WHERE filename IS NOT NULL ORDER BY 1,2,3);
prompt ######################################################################################


select
area_name as "Subject Area"
     , case when cattable.tab_hidden = 'f' then cattable.tab_label
            else (select rel_label1 from catrelat where tab_code2 = cattable.tab_code and rel_Section = 't' and rownum = 1)
        end "File"
     , decode(cattable.tab_hidden,'t',cattable.tab_label) "Section"
     ,tab_Table
from
 catareatable, catarea, cattable
where catareatable.area_key = catarea.area_key
and catareatable.tab_code = cattable.tab_code
and cattable.tab_active = 't'
and cattable.tab_code like '%@@WFN@@11'
--and catarea.area_name like 'Emp%'
order by 1;





SELECT DISTINCT ca.* FROM catarea ca, catareatable cat
WHERE ca.area_key = cat.area_key
  AND cat.tab_code LIKE '%@@HRB@@25';

HRB Subject areas:
    Benefits
    Benefitstalent
    Earnings
    Work
    Talent
    Company Setup
    Personal

PAYX subject areas:
    Benefits
    Compensation
    Employee
    Performance & Development
    Compliance
    Company Setup

HWSE subject areas:
    Election Information
    Beneficiary Data
    Participant Data
    Dependent DATA
EZLM subject areas:
     Time and Labor
IPAY:
	Pay Statements Totals
	Pay Statements
CRT:
	Internet Security

Compensation                   TMS - Budget Package             BUDGET_PACKAGE@@TMS@@8
                               TMS - Employee Award Allocation  EMP_AWARD_ALLOCATION@@TMS@@8
                               TMS - Employee Award Data        EMP_AWARD_DATA@@TMS@@8
                               TMS - Employee Basic Info        EMP_BASIC_INFO@@TMS@@8
                               TMS - Employee Job History       EMP_JOB_HISTORY@@TMS@@8
                               TMS - Employee LTIHistory        EMP_LTI_HISTORY@@TMS@@8
                               TMS - Employee Perf History      EMP_PERFORMANCE_HIST@@TMS@@8
                               TMS - Employee Plan Data         EMP_PLAN_DATA@@TMS@@8
                               TMS - Employee STIHistory        EMP_STI_HISTORY@@TMS@@8
                               TMS - Group Membership           GROUP_MEMBERSHIP@@TMS@@8
Employee Profile               TMS - Emp Competency Profile     EMP_COMPETENCY_PROFILE@@TMS@@8
                               TMS - Emp Education History      EMP_PROFILE_EDU_HIST@@TMS@@8
                               TMS - Emp Employement History    EMP_PROFILE_EMP_HIST@@TMS@@8
                               TMS - Employee Basic Info        EMP_BASIC_INFO@@TMS@@8
                               TMS - Employee Career Interest   EMP_CAREER_INTEREST@@TMS@@8
                               TMS - Employee Profile           EMP_PROFILE@@TMS@@8
Performance                    TMS - Emp Competency Profile     EMP_COMPETENCY_PROFILE@@TMS@@8
                               TMS - Emp Perf Dev Activities    EMP_PERF_DEV_ACT@@TMS@@8
                               TMS - Emp Perf Goal              EMP_PERF_GOAL@@TMS@@8
                               TMS - Emp Perf Goal Comments     EMP_PERF_GOAL_CMNTS@@TMS@@8
                               TMS - Emp Perf Goal Measurements EMP_PERF_GOAL_MSRMNTS@@TMS@@8
                               TMS - Employee Basic Info        EMP_BASIC_INFO@@TMS@@8
Performance Archive            TMS - Archived Emp Evaluation    ARCH_EMP_EVAL@@TMS@@8
                               TMS - Archived Eval Competency   ARCH_EVAL_COMPETENCY@@TMS@@8
                               TMS - Archived Eval Dev Act      ARCH_EVAL_DEVACT@@TMS@@8
                               TMS - Archived Eval Goals        ARCH_EVAL_GOALS@@TMS@@8
                               TMS - Archived Goals             ARCH_GOALS@@TMS@@8
Performance Evaluation         TMS - Competency Evaluation      COMPETENCY_EVAL@@TMS@@8
                               TMS - Dev Activities Evaluation  DEV_ACTIVITIES_EVAL@@TMS@@8
                               TMS - Emp Perf Evaluation        EMP_PERF_EVALUATION@@TMS@@8
                               TMS - Employee Basic Info        EMP_BASIC_INFO@@TMS@@8
                               TMS - Goals Evaluation           GOALS_EVALUATION@@TMS@@8
Talent Assessment              TMS - Employee Basic Info        EMP_BASIC_INFO@@TMS@@8
                               TMS - Talent Assessment          TALENT_ASSESSMENT@@TMS@@8

==========================================
-- list of hrb clients not set up in adpr
SELECT DISTINCT y.o,
                x.ooid
FROM   hrb_r25.company_auth@dblinkcrtp04tocrtp03        x,
       appadm.isiclient@dblinkcrtp04tocrtp01            y,
       appadm.isiproduct_sc_client@dblinkcrtp04tocrtp01 z
WHERE  x.ooid IS NOT NULL
AND    x.ooid = y.clientoid
AND    y.o = z.o
AND    z.adpproductcode = 'HRB'
AND    NOT EXISTS (SELECT 1
        FROM   webrepadmin.batclientproduct p
        WHERE  p.client_code = y.o
        AND    p.ver_code = '25'
        AND    p.prd_code = 'HRB')
========================================

how to check bad plan in catalog application:

select count(*)
  from gv$sql where executions >= 35 and (elapsed_time/1000000)/executions > 5
       and sql_text like '%DAOSQL%' and parsing_schema_name=User;

how to check bad histograms:

exec dbms_stats.gather_table_stats(ownname => 'APPADM', tabname => 'ISIUSER1', estimate_percent => 40, method_opt => 'FOR ALL INDEXED COLUMNS SIZE 1', cascade => TRUE, degree => 8);

exec dbms_stats.gather_table_stats(ownname => 'WEBREPADMIN', tabname => 'CURR_ISI_CLIENT_LOAD', estimate_percent => 40, method_opt => 'FOR ALL INDEXED COLUMNS SIZE 1', cascade => TRUE, degree => 8);

user_histograms
user_part_histograms
user_subpart_histograms
user_tab_histograms
user_tab_col_statistics

-- WITH HISTOGRAMS
exec dbms_stats.gather_table_stats(ownname => user, tabname => '<<TABLENAME>>', estimate_percent => 10, method_opt => 'FOR ALL INDEXED COLUMNS SIZE AUTO', cascade => TRUE, degree => 8);

-- WITHOUT HISTOGRAMS
exec dbms_stats.gather_table_stats(ownname => user, tabname => '<<TABLENAME>>', estimate_percent => 10, method_opt => 'FOR ALL INDEXED COLUMNS SIZE 1', cascade => TRUE, degree => 8);

select
'exec dbms_stats.gather_table_stats(ownname => ''' || 'hwse_reg0001' || ''', tabname => '''||
table_name ||''', estimate_percent => 10, method_opt => '''
|| 'FOR ALL INDEXED COLUMNS SIZE AUTO' || ''', cascade => TRUE, degree => 8);'
from user_tables;


How do you collect histograms?
 Histograms are specified using the METHOD_OPT argument of the DBMS_STATS gathering procedures.
 ex.  DBMS_STATS.GATHER_TABLE_STATS  recommended setting is use param METHOD_OPT to FOR ALL COLUMNS SIZE AUTO

-- Histogram on req_status column on batreq table.

select table_name, column_name, histogram, num_buckets
from dba_tab_columns
where histogram != 'NONE' and owner = user;

BATREQ       REQ_STATUS      FREQUENCY      5



==============
/apps/crt/payx/refresh_battables/refresh_battables.sql

======================
import progress:

select
   substr(sql_text,instr(sql_text,'INTO "'),30) table_name,
   rows_processed,
   round((sysdate-
    to_date(first_load_time,'yyyy-mm-dd hh24:mi:ss'))*24*60,1) minutes,
   trunc(rows_processed/
    ((sysdate-to_date(first_load_time,'yyyy-mm-dd hh24:mi:ss'))*24*60)) rows_per_minute
from
   sys.v_$sqlarea
where
   sql_text like 'INSERT %INTO "%'
and
   command_type = 2
and
   open_versions > 0;
========================


-- bind capture
select sql_id, b.name BIND_NAME, b.value_string BIND_STRING
from
  v$sql t
  join v$sql_bind_capture b
  using (sql_id)
where
  b.value_string is not null
  and sql_id='4s6vartcvytsr'

===========================

alter session set "_mv_refresh_use_stats"=FALSE;
alter session set events '10995 trace name context forever, level 8';



alter session set events '32333 trace name context forever, level 10'

INSERT INTO batclientproduct
(client_code, prd_code, ver_code, bcp_grant_all_users, bcp_dblink_flag, bcp_dblink_value, bcp_extension_flag, bcp_extension_value)
VALUES ('PINKERTONC', 'HRB', '25', 'f', 'f', '', 'f', '');

commit;
================================
basic client setup:
connect webrepadmin/webrepadmin@catp01
connect webreppilot/webreppilot@catp01
connect webreppod/webreppod@catp01

insert into batclientinstance(client_code,INST_KEY,POD_CODE) values('178','', 'PROD');
commit;
insert into batclientproduct(client_code,prd_code,ver_code) values('HUNTREFIN','PAYX2', '17');
commit;



new arch client setup:
connect webrepadmin/webrepadmin@catp01
connect webreppilot/webreppilot@catp01
connect webreppod/webreppod@catp01

insert into batclientinstance(client_code,INST_KEY,POD_CODE) values('MERITB','4', 'PROD');
update batclientinstance set inst_key = '5' where client_code = 'YOKOHAMATC';
select inst_key, pod_code, CLIENT_TABLE_EXTENSIONS, CLIENT_CUSTOM_COUNT from batclientinstance where client_code = 'YOKOHAMATC';

commit;
insert into batclientproduct(client_code,prd_code,ver_code, bcp_extension_flag, bcp_extension_value) values('HUNTREFIN','PAYX2', '17', 'f', '_0501');
update batclientproduct set bcp_extension_flag = 't', bcp_extension_value = '_0501' where client_code = 'MERITB' and prd_code = 'PAYX2' and ver_code = '17';

commit;

update batclientproduct set bcp_extension_flag = 't', bcp_extension_value = '_0301'
where client_code = 'MTSMMTLLC' and prd_code = 'PAYX2' and ver_code = '17';

update batclientproduct set bcp_extension_flag = 't', bcp_extension_value = '_0301'
where client_code = 'INFRMETACO' and prd_code = 'PAYX2' and ver_code = '17';


SELECT 'update batclientproduct set bcp_extension_flag = ''t'', bcp_extension_value = ''_' ||
       reg_pod_code || ''' where prd_code = ''PAYX2'' and ver_code = ''17'' and client_code = ''' ||
       isi_client_id || ''';'
FROM   adpr_client_extensions
WHERE  cidn IN ('PAYXSCH0003141')



SELECT 'configure_client(''' || isi_client_id || ''', ''' || TO_NUMBER(NODE_CODE) ||
''', '''', ''t'',''' ||
'_' || SUBSTR(TARGET_SCHEMA_NAME, 9, 2) || SUBSTR(TARGET_SCHEMA_NAME, 15, 2) || ''', ''PAYX2'', ''17'');'
FROM (
SELECT * FROM ggate.adpr_client_extensions@dblinkcatp01tocrtp01
WHERE ISI_CLIENT_ID = 'ANRCB'
)



=================================


exec prc_drop_mv;

alter trigger TEXT_BATCLIENTPRD disable;
alter trigger TMV_BATCLIENTINSt disable;
alter trigger TMV_BATCLIENTPROD disable;
alter trigger tsync_batclientinst disable;

alter trigger TEXT_BATCLIENTPRD enable;
alter trigger TMV_BATCLIENTINSt enable;
alter trigger TMV_BATCLIENTPROD enable;
alter trigger tsync_batclientinst enable;

exec prc_deploy_mv;

New stuff:
=========
    ALTER TRIGGER tmv_batclientinst DISABLE;
    ALTER TRIGGER tmv_batclientprod DISABLE;
    ALTER TRIGGER tmv_batpod DISABLE;

    exec prc_drop_mv;
    exec prc_deploy_mv;

    ALTER TRIGGER TMV_BATCLIENTINST compile;
    ALTER TRIGGER TMV_BATCLIENTPROD compile;
    ALTER TRIGGER TMV_BATPOD compile;
    ALTER TRIGGER tmv_batpod ENABLE;
    ALTER TRIGGER tmv_batclientprod ENABLE;
    ALTER TRIGGER tmv_batclientinst ENABLE;
    exit;

unique constraint error: check this
SELECT prd_code, ver_code, extensions, configurations, COUNT(1) FROM mv_product
GROUP BY prd_code, ver_code, extensions, configurations
HAVING COUNT(1) > 1

===============================================
connect racs_r1/racs_r1@crtp02
call app_security_context_isi.set_clientid_isi('vcanakala_adp@adp','ADP', '', '', '');
SELECT * FROM org WHERE upper(isi_org_cd) LIKE 'KIPPHOUSTO'

=================================================


### HRB INSTALLATION

cd /apps/crt/hrb/r25/installations/main/HRB_INSTALL_FINAL/views
install_hrb_r25.sh crtp04
--check ez11_timepairexception_vw.sql for ezlm cross product

cd /apps/crt/hrb/r25/installations/sawtooth/hrb_sawtooth1
install_sawtooth.sh crtp04

cd /apps/crt/hrb/r25/installations/hrb_r25_v11_pkg/views/v4
install_hrb_r25_fileno.sh crtp04


=================================================================


adpr report counts:

CONNECT WEBREPADMIN/WEBREPADMIN@CATP01

truncate table adpr_user_reports;

insert into adpr_user_reports
SELECT DISTINCT s.user_email,
                s.user_login,
                b.client_code,
                t.tab_code,
                b.req_key
FROM   secuser  s,
       qryquery q,
       batreq   b,
       qrytable t
WHERE  b.qry_key = q.qry_key
AND    s.user_key = b.user_key
AND    b.user_key = q.user_key
AND    q.qry_key = t.qry_key
AND    b.client_code = q.client_code
AND    b.client_code NOT IN ('ADPADMIN', 'CSRADMIN')

insert into adpr_user_reports
SELECT DISTINCT s.user_email,
                s.user_login,
                b.client_code,
                t.tab_code,
                b.req_key
FROM   WEBREPPILOT.secuser  s,
       WEBREPPILOT.qryquery q,
       WEBREPPILOT.batreq   b,
       WEBREPPILOT.qrytable t
WHERE  b.qry_key = q.qry_key
AND    s.user_key = b.user_key
AND    b.user_key = q.user_key
AND    q.qry_key = t.qry_key
AND    b.client_code = q.client_code
AND    b.client_code NOT IN ('ADPADMIN', 'CSRADMIN')


CREATE INDEX idx_adpr_user_reports ON adpr_user_reports(user_login);


CREATE TABLE adpr_isiuser_contacts AS
SELECT DISTINCT i.userid,
                i.mail,
                i.telephonenumber phone,
                i.cn NAME,
                i.postaladdress ||', '|| i.adppostalcity || ', ' || i.adppostalstate || ','  || i.adppostalzip address
FROM   appadm.isiuser@dblinkcatp01tocrtp01 i, adpr_user_reports x
WHERE x.user_login = i.userid;

CREATE INDEX idx_adpr_isiuser_contacts ON adpr_isiuser_contacts(userid);


-- PAYX REPORTS
SELECT x.client_code  ,
       x.user_login ,
       x.rep_cnt ,
       y.NAME ,
       y.mail ,
       y.phone ,
       y.address
FROM   (SELECT a.client_code,
               a.user_login,
               a.user_email,
               COUNT(1) rep_cnt
        FROM   adpr_user_reports a
        WHERE  a.tab_code LIKE '%PAYX2%'
          AND  a.client_code NOT IN ('ADPADMIN', 'CSRADMIN')
        GROUP  BY a.client_code,
                  a.user_login,
                  a.user_email) x,
       adpr_isiuser_contacts y
WHERE  x.user_login = y.userid;



=============================================================



SELECT tab, SUM(cnt) FROM bt16_journal
WHERE trunc(AT) = trunc(SYSDATE) GROUP BY tab;

SELECT AT, tab,SUM(cnt) FROM bt16_journal
WHERE trunc(AT) > trunc(SYSDATE-5) GROUP BY at,tab ORDER BY tab, AT



=======================Generate policy scripts====================

SELECT 'exec dbms_rls.enable_policy(''' || OBJECT_OWNER || ''', '''
|| OBJECT_NAME || ''', ''' || policy_name || ''', true);'
 FROM dba_policies WHERE object_owner = 'CRUVPD' AND object_name LIKE 'HR25%'
ORDER BY 1

SELECT 'exec dbms_rls.add_policy(''' || OBJECT_OWNER || ''', '''
|| OBJECT_NAME || ''', ''' || policy_name || ''', true);'
 FROM dba_policies WHERE object_owner = 'CRUVPD' AND object_name LIKE 'HR25%'
ORDER BY 1

SELECT 'exec dbms_rls.add_policy(''' || object_owner || ''','''
|| object_name || ''',''' || POLICY_NAME || ''',''' || PF_OWNER
|| ''',''' || PACKAGE || '.' || FUNCTION || ''',''select,insert,update,delete'',true,false);'
FROM dba_policies WHERE object_owner = 'CRUVPD' AND object_name LIKE 'HR25%'
ORDER BY 1


EXEC DBMS_RLS.ADD_POLICY('VPD_PAYX_REG26_POD01', 'PX17_ADDLEARNINGS', 'CIDN_LIST_FILTER',
 'SECUSR', 'PAYX_R17_POLICIES_2601.CIDN_LIST_FILTER', 'SELECT,INSERT,UPDATE,DELETE', TRUE, FALSE);

EXEC DBMS_RLS.ENABLE_POLICY('VPD_PAYX_REG26_POD01','PX17_ADDLEARNINGS', 'CIDN_LIST_FILTER', TRUE);

EXEC DBMS_RLS.DROP_POLICY('VPD_PAYX_REG26_POD01','PX17_ADDLEARNINGS', 'CIDN_LIST_FILTER');


============================HRB QUERY===========================

SELECT DISTINCT i.o,
                isc.adpproductcode,
                c.company_id,
                c.ooid
FROM   company_auth                                     c,
       appadm.isiclient@dblinkcrtp03tocrtp01            i,
       appadm.isiproduct_sc_client@dblinkcrtp03tocrtp01 isc
WHERE  c.ooid = i.clientoid
AND    i.o = 'ORMAT'
AND    i.o = isc.o

=============================BY HOUR REPORTS QUERY=====================
select TO_CHAR(rlog_timestamp,'HH24'), count(1) from batreqlog
where rlog_Status in ('OK', 'OK+')
 and TRUNC(rlog_timestamp) =trunc(SYSDATE-8)
group by TO_CHAR(rlog_timestamp,'HH24')
order by TO_CHAR(rlog_timestamp,'HH24')

========================REMOVE MATERIALIZED VIEWS======================
CONNECT PAYX_REG06_POD01/PAYX_REG06_POD01@CRTQ01
SELECT 'EXEC DBMS_JOB.REMOVE(' || job || ');'
FROM   user_jobs
WHERE  log_user = 'PAYX_REG06_POD01'
AND    upper(what) LIKE '%DBMS_MVIEW.REFRESH%'
AND    upper(what) LIKE '%PAYX_R17_USERID_SEC%';

SELECT 'EXEC DBMS_JOB.REMOVE(' || job || ');'
FROM   user_jobs
WHERE  log_user = 'PAYX_REG06_POD01'
AND    upper(what) LIKE '%DBMS_MVIEW.REFRESH%'
AND    upper(what) LIKE '%TYPE%';

=======================================================================
users having most number of views used and has non-zero records

select user_login, count(1) from (
select distinct su.user_login, qt.tab_code
from qrytable qt, qryquery qq, secuser su, batreq br
where qt.qry_key = qq.qry_key
  and su.user_key = qq.user_key
--  and su.user_login = 'KTS@ADPRM'
  and upper(substr(su.user_login, instr(su.user_login, '@')+1)) = upper(br.client_code)
  and br.qry_key = qt.qry_key
  and  br.req_rows > 0
  and qt.tab_code like '%@@PAYX2@@17'
) group by user_login
order by count(1) desc;

==========================================================================

find . -name "*.zip" -exec unzip -l {} \; |  egrep -e "Archive:|0076DTD_Q1 2007_56758_119997997_18.xml"

============================================================================

alter trigger TADT_BATCLIENTPROD disable;

INSERT INTO CATCLIENT(CLIENT_CODE,POD_CODE) VALUES('R1ADPR','R94POD');
INSERT INTO BATCLIENTPRODUCT(CLIENT_CODE,PRD_CODE,VER_CODE) VALUES('R1ADPR','TMS','8');
INSERT INTO BATCLIENTENVIRONMENT(BCE_KEY, CLIENT_CODE, PRD_CODE, INST_KEY) VALUES (SEQ_BCE_KEY.NEXTVAL,'R1ADPR','TMS', 16) ;

alter trigger TADT_BATCLIENTPROD enable;

=================================================


insert into catclient (CLIENT_CODE, POD_CODE, CLIENT_CUSTOM_COUNT, CLIENT_ORGOID)
values ('VMORTGAGE', 'WEBPILOT', 0, '011PQM3FBNB0004S');

insert into batclientproduct (CLIENT_CODE, PRD_CODE, VER_CODE, BCP_GRANT_ALL_USERS, BCP_EXTENSION_FLAG, BCP_EXTENSION_VALUE, BCP_PRIORITY)
values ('VMORTGAGE', 'HRB', '25', 'f', 'f', '', 1);

insert into batclientenvironment (BCE_KEY, CLIENT_CODE, PRD_CODE, INST_KEY, CPE_KEY, BCE_DBLINK_FLAG, BCE_DBLINK_VALUE, BCE_SCHEMA)
values (SEQ_BCE_KEY.NEXTVAL, 'VMORTGAGE', 'HRB', 1, null, 'f', '', '');

===================================================
 select distinct cidn, count(1) from primary_participant p where
 exists (select 1 from BASE_T16_BENE_DATA_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_CLIENT_DATA_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_DEPENDENT_DATA_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_DEP_COVERAGE_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_ELECTION_DATA_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_EMP_DATA_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_EVENTS_DATA_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_PP_CHANGES_DATA_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_PP_DATA_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_BENE_DESIG_VW a where p.cidn = a.cidn) and
 exists (select 1 from BASE_T16_SUSP_ELECTION_DATA_VW a where p.cidn = a.cidn)
 group by cidn order by count(1) desc;


=======================================================

dep coverages slowness:
SELECT * --'ALTER SYSTEM KILL SESSION '''||s.sid||','||s.serial#||''';'
FROM   v$session s
where --s.osuser='infor' and
s.sid in (select session_id from DBA_objects o, v$locked_object l
where o.object_id = l.object_id );and o.object_name like '%DEP%');
select * from v$sql where sql_id = '1503vtbkdy2kw'  -- 'afg01ujpbzyjw'
select * from v$sql_plan where sql_id = '1503vtbkdy2kw'  'afg01ujpbzyjw'
delete from  etl_status_depc where end_at is null and job is not null

===========================================================


SECURITY_USER_PROFILE field	AC_APP_RESOURCE.RESOURCE_ID value
SSN_MASK = 0 [Display SSN]	PractitionerPayrollTabFieldMaskingSSNUI
SSN_MASK = 1 [Masked Display (XXX-XX-1234)]	PractitionerPayrollTabFieldMaskingSSNUI
PractitionerPayrollTabFieldMaskingSSNUIMaskedDisplay
OPT_EMP_PAY_RATES [Pay Rates]	PractitionerPayrollTabEmployeePortletPayRates
RPT_BANK_ACCT_MASK = 0 [Display Bank Acct]	PractitionerPayrollTabFieldMaskingBankAccountReports
RPT_BANK_ACCT_MASK = 1 [Masked Display (XXXXXXXXXXXXX4567)]	PractitionerPayrollTabFieldMaskingBankAccountReports
PractitionerPayrollTabFieldMaskingBankAccountReportsMaskedDisplay
OPT_RPT_CHECKVIEW [CheckView Reports]	PractitionerReportsTabPayrollReportsPortletCheckViewReports
OPT_SET_BENEFITS_TRACKING [Benefits Tracking]	PractitionerPayrollTabSetupPortletBenefitsTracking
OPT_RPT_EMPLOYEE [Employee Reports]	PractitionerReportsTabPayrollReportsPortletEmployeeReports
OPT_RPT_WAGE_GARNISHMENT [Wage Garnishment Reports]	PractitionerReportsTabPayrollReportsPortletWageGarnishmentReports
OPT_RPT_PAYDATA [Paydata Reports]	PractitionerReportsTabPayrollReportsPortletPaydataReports
OPT_EMP_TO_DATE_ACCUMULATIONS [Paydata Reports]	PractitionerPayrollTabEmployeePortletToDateAccumulations


======
AMHST
HIWIRED
CCSPFLD


=========
  -- to configure report writer clients

select 'exec configure_client(''' || client_code || ''', '''|| inst_key ||''', ''RWADPR'', ''t'', ''' || substr(client_table_extensions, 11) || ''');'
from batclientinstance  where client_code in (select client_code from t1) and
 client_code not IN  ('a','b')
 and client_table_extensions is not NULL
 ORDER BY 1;

select 'exec configure_client(''' || client_code || ''', '''|| inst_key ||''', ''RWADPR'', ''f'', ''' || substr(client_table_extensions, 11) || ''');'
from batclientinstance  where client_code in (select client_code from t1) and
 client_code not IN  ('a','b')
  and client_table_extensions is NULL
 ORDER BY 1;

-- security issue requests
select distinct b.client_code -- s.user_login, b.req_key, b.req_timestamp, b.req_xml
from batreq b, secuser s, batclientproduct bp
where b.user_key = s.user_key
and b.client_code = bp.client_code
and b.req_timestamp between to_date('05/13/2010 09:00:00', 'MM/DD/YYYY HH24:MI:SS') and to_date('05/13/2010 14:30:00', 'MM/DD/YYYY HH24:MI:SS')
and bp.prd_code = 'PAYX2' and bp.ver_code = '17' and bp.bcp_extension_value = '_1701'
and b.req_rows > 0;



=========================================================

as SYS
call dbms_java.grant_permission('WEBRW', 'SYS:java.lang.RuntimePermission', 'getClassLoader', '');

/apps/crt/hrb/r25/installations/main/HRB_INSTALL_FINAL/WS/wsfields
install_webservice_catalog.sh webrw catp02

or
loadjava -u webreppilot/webreppilot@crts01 -v -resolve XmlSchemaDateFormat.class
loadjava -u webreppilot/webreppilot@crts01 -v -resolve WSSecurityUtil.class
loadjava -u webreppilot/webreppilot@crts01 -v -resolve Base64.class
loadjava -u webreppilot/webreppilot@crts01 -v -resolve UsernameToken.class



select object_name, object_type, status from user_objects where object_type like 'JAVA%';
select name, accessibility from user_java_classes;

EXEC dbms_mview.refresh(list => 'employeedep', method => 'f');

========================================
-- to get the lob info in sqlplus session:
select REQ_KEY, RLOG_TIMESTAMP,
UTL_RAW.CAST_TO_VARCHAR2( DBMS_LOB.SUBSTR(RLOG_QUERY, 2000) ) ||
UTL_RAW.CAST_TO_VARCHAR2( DBMS_LOB.SUBSTR(RLOG_QUERY, 2000, 2000) ) ||
UTL_RAW.CAST_TO_VARCHAR2( DBMS_LOB.SUBSTR(RLOG_QUERY, 2000, 4000) ) ||
UTL_RAW.CAST_TO_VARCHAR2( DBMS_LOB.SUBSTR(RLOG_QUERY, 2000, 6000) ) ||
UTL_RAW.CAST_TO_VARCHAR2( DBMS_LOB.SUBSTR(RLOG_QUERY, 2000, 8000) ) REQ_XML
from BATREQLOG where rownum < 2;

======================================
 select q.qry_status, count(q.qry_key) from qryquery q, secuser s
   where q.user_key = s.user_key
     and q.qry_active = 't'
     and q.qry_public = 'f'
     and s.user_login = 'ECRAMER@BULKMOLD'
     group by q.qry_status;

The application shows only reports with status > 20 (where 20 = step > 2)
It shows only reports that are on step 3 or after.

 + public reports:
 select count(1) from qryquery where client_code = 'BULKMOLD' and qry_public = 't';

=============================================



php version:
select DBV_PHPVERSION from ADMDBVERSION where DBV_TIMESTAMP = (select max(DBV_TIMESTAMP) from ADMDBVERSION);


https://1hrcrtqa.adp.com/webreppilot/
VNemooriADP@adp
adpadp111



when you import the pfx file into IE in the 3rd screen (next -> next)  there are 2 check boxes... mark the two
go to options and to the certificates tabs to export... export as a pfx and insert some password to import on firefox
with this new cert, you are able to insert on firefox (always with password)


-- to setup GK2:
1. assign a region  hwse_reg0007
   hwse_reg0007/hwse_reg0007@cru02q   -- LIVE
   hwse_reg0007/hwse_reg0007@cru03q   -- CTEST

2. cru02q
   runsyn.sh GK2 DBLINKCRU02QTOHWS01D HWSE_REG0007 cru02q

   cru03q
   runsyn.sh GK2CTEST DBLINKCRU03QTOHWS01D HWSE_REG0007 cru03q


3.  start_hwse_all.sh HWSE_REG0007 CRU02Q
    start_hwse_all.sh HWSE_REG0007 CRU03Q

4.  INSTALL.sh hwse_reg0007 cru02q
    INSTALL.sh hwse_reg0007 cru03q

5.  install_hwse_new_arch.sh cru02q 00 07
    install_hwse_new_arch.sh cru03q 00 07
6.  insert into adpr_hwse_cidn (cidn) values ('GK2');
    insert into adpr_hwse_cidn (cidn) values ('GK2CTEST');

=concatenate("ksh runsyn.sh ", A1, " DBLINKCRU04PTO", C1, " ", B1, " CRU04P")
=concatenate("ksh start_hwse_all.sh ", B1, " CRU04P")
=concatenate("ksh INSTALL.sh ", B1, " CRU04P")
=concatenate("ksh install_hwse_new_arch.sh CRU04P ", B1)
insert into adpr_hwse_cidn (cidn) values ('GK2CTEST');

=================================================================

payx files:

Benefits Provider Information       PX185_BENE_PROVIDER_VW
Check History                       PX185_CHK_COMBO_VW
COBRA Events                        PX185_COBRA_VW
Cost Number Allocation Info         PX185_COSTNUM_ALLOC_VW
Current Payroll Data                PX185_PAYDATA_CURR_VW
Deductions In Arrears               PX185_DED_IN_ARREARS_VW
Department Allocation Info          PX185_DEPT_ALLOC_VW
Dependent/Beneficiary Enrollment    PX185_BENE_ENROLL_VW
Education                           PX185_HR_EDU_RPT_VW
Employee Development                PX185_HR_EMP_DEV_VW
Employee Enrollments                PX185_BENX_ENROLL_VW
Employee Performance Reviews        PX185_PERF_MGMT_VW
HR_CUTOM_FIELD_DETAIL               PX185_HR_CUTOM_FIELD_DETAIL
Identity/Military Information       PX185_PERSON_VW
Licenses and Certifications         PX185_HR_LIC_CER_RPT_VW
Memberships                         PX185_HR_MEM_RPT_VW
Paid Time Off                       PX185_ALLOWED_TAKEN_VW
Payroll Information                 PX185_EMPLOYEE_VW
Performance Reviews (Pre-Rel 17)    PX185_EMP_PERFREV_VW
Personal Information                PX185_PERSON_VW
Previous Employment                 PX185_HR_EMP_DEV_VW
Salary History                      PX185_SALARY_HISTORY_VW
Salary Information                  PX185_SALARY_INFO_VW
Scheduled Deductions - Goal Amts    PX185_DEDUCTION_VW
Scheduled Performance Reviews       PX185_EMPSHD_PERFREV_VW
Skills                              PX185_HR_SKILL_RPT_VW
Special Accumulators                PX185_YTD_ACCUM_VW
Statutory Accumulators              PX185_YTD_INFO_VW
Wage/Garnishment                    PX185_WAGE_GARNISH_VW
Workers Comp Policies               PX185_PBP_JOBCLS_POL_VW
Workers Compensation                PX185_PBP_EMPLOYEE_VW

============================================
PAYX REGIONS Prod schema stat collection procedure:
set echo on
exec dbms_stats.gather_schema_stats(ownname=>'PAYX_REG03_POD34', cascade=>true, estimate_percent=>40, method_opt=>'FOR ALL COLUMNS SIZE 1' ,degree => 8 )
============================================
select * from cstfld where regexp_like(name,'[[:cntrl:]]') AND  REGEXP_LIKE(NAME, '[[:space:]]')
select regexp_replace(source_schema_name, 'CTEST$', ''), target_schema_name from adpr_client_extensions ORDER BY 2;

SELECT 'UPDATE batclientproduct b SET b.bcp_extension_flag = ''t'', b.bcp_extension_value = ''' ||
regexp_replace(target_schema_name, 'HWSE_REG', '_')  || ''' WHERE client_code = ''' ||
  upper(regexp_replace(source_schema_name, 'CTEST$', '')) || ''' AND prd_code = ''BASE'';'
FROM adpr_client_extensions ORDER by 1;


UPDATE batclientproduct b SET b.bcp_extension_flag = 't', b.bcp_extension_value = '_0261' WHERE client_code = '1STNIAGARA' AND prd_code = 'BASE';
========================================================
select qry_key, qry_status, qry_active FROM qryquery
WHERE qry_name = 'DNC First Shift Hours' AND QRY_KEY_COPYOF IS NULL;

SELECT dbms_stats.get_stats_history_retention FROM dual;
====================JOURNAL JOB IMPLEMENTATION========================

drop table hwse_journal;
drop type hwse_tabcnt_tabtyp;
drop type hwse_tabcnt_typ;

create type hwse_tabcnt_typ as object
( tabname varchar2(30), numrows number);
/

create type hwse_tabcnt_tabtyp as table of hwse_tabcnt_typ;
/

create table hwse_journal (
 dt date,
 client varchar2(30),
 tabcntinfo  hwse_tabcnt_tabtyp)
nested table tabcntinfo store as hwse_tabcnt_tabtype;

create or replace procedure refresh_hwse_journal
  authid definer
is
  vcnt    integer;
  vdt     date default trunc(sysdate);
  vtabcnt hwse_tabcnt_tabtyp;
  idx     integer;
begin
  for i in (select distinct source_schema_name
                           ,target_schema_name
            from   ggate.adpr_client_extensions
            )
  loop
    idx     := 1;
    vtabcnt := hwse_tabcnt_tabtyp();
    for j in (select table_name t
              from   all_tables
              where  owner = i.target_schema_name)
    loop
	  execute immediate 'select count(1) from ' || i.target_schema_name
    || '.' || j.t into vcnt;
      vtabcnt.extend;
      vtabcnt(idx) := hwse_tabcnt_typ(j.t, vcnt);
      idx := idx + 1;
    end loop;
    insert into hwse_journal values (vdt, i.source_schema_name, vtabcnt);
    commit;
  end loop;
end;
/


-----------TYPICAL QUERIES--------------------
-- dt client numrows
select t1.dt, t1.client,
(select sum(numrows) numrows from
 table(select tabcntinfo from hwse_journal
  where client = t1.client and dt=t1.dt)) numrows
from hwse_journal t1
order by 1,2;

-- dt tab numrows
select dt, tabname, sum(numrows) from (
select t1.dt, t1.client, t2.*
from hwse_journal t1, TABLE(t1.tabcntinfo) t2
) group by dt, tabname
order by 2,1;

-- dt client tab numrows
select t1.dt, t1.client, t2.*
from hwse_journal t1, TABLE(t1.tabcntinfo) t2;
=======================================================================
PERL Bind based insert stmts
my $sql = qq{ INSERT INTO employees VALUES ( ?, ?, ?, ? ) };
my $sth = $dbh->prepare( $sql );
for( @records ) {
  eval {
    $sth->bind_param( 1, @$_->[0], SQL_INTEGER );
    $sth->bind_param( 2, @$_->[1], SQL_VARCHAR );
    $sth->bind_param( 3, @$_->[2], SQL_VARCHAR );
    $sth->bind_param( 4, @$_->[3], SQL_VARCHAR );
    $sth->execute();
    $dbh->commit();
  };
  if( $@ ) {
    warn "Database error: $DBI::errstr\n";
    $dbh->rollback(); #just die if rollback is failing
  }
}
$sth->finish();
$dbh->disconnect();
======================================================================

SELECT isi_client_id      "Client Code"
       ,cidn
       ,node_code          "Node"
       ,target_schema_name "Region"
FROM   (SELECT isi_client_id
              ,cidn
              ,node_code
              ,target_schema_name
              ,COUNT(1) over(PARTITION BY isi_client_id) t
              ,COUNT(1) over(PARTITION BY isi_client_id, node_code) n
              ,COUNT(1) over(PARTITION BY isi_client_id, target_schema_name) r
        FROM   adpr_client_extensions
        WHERE  isi_client_id IS NOT NULL
        AND    target_deleted_date IS NULL
        AND    replicating = 'Y'
        AND    product_version = '185'
        --and isi_client_id = 'ADP0052'
        )
WHERE  t != n
OR     t != r
ORDER  BY 1 DESC
         ,3
         ,4



Sub colorAlternate()
Dim v As String
Dim coloridx As Integer

v = "nothing"
coloridx = 15
For Row = 2 To 1000
 'For col = 1 To 4
  If Cells(Row, 1).Value <> v Then
    If coloridx = 15 Then
    coloridx = 24
    Else
    coloridx = 15
    End If
    v = Cells(Row, 1).Value
  End If
  Cells(Row, 1).Interior.ColorIndex = coloridx
  Cells(Row, 2).Interior.ColorIndex = coloridx
  Cells(Row, 3).Interior.ColorIndex = coloridx
  Cells(Row, 4).Interior.ColorIndex = coloridx
' Next
Next
End Sub


==================================================
sqlplus hwse_comadm/hwse_comadm@cre02p
exec dbms_mview.refresh('BASE_PROPERTIES', 'c');
exec dbms_mview.refresh('CLIENT', 'c');
exec dbms_mview.refresh('CLIENT_REGISTRY', 'c');
exec dbms_mview.refresh('MEMBER', 'c');
exec dbms_mview.refresh('MEMBER_CLNT_SEC_CD_ASSIGNMENT', 'c');
exec dbms_mview.refresh('MEMBER_ROLE_ASSIGNMENT', 'c');
exec dbms_mview.refresh('MEMBER_ROLE_CLIENT_ASSIGNMENT', 'c');
exec dbms_mview.refresh('PERMISSION', 'c');
exec dbms_mview.refresh('RESOURCE_ITEM', 'c');
exec dbms_mview.refresh('ROLE', 'c');
exec dbms_mview.refresh('ROLE_ENVIRONMENT_ASSO', 'c');
exec dbms_mview.refresh('ROLE_PERMISSION', 'c');
exec dbms_mview.refresh('ROLE_TASK_ASSIGNMENT', 'c');
exec dbms_mview.refresh('STANDARD_BENEFIT_AREA', 'c');
exec dbms_mview.refresh('STANDARD_EVENT_REASON', 'c');
exec dbms_mview.refresh('STANDARD_RELATIONSHIP', 'c');
exec dbms_mview.refresh('TASK', 'c');
exec dbms_mview.refresh('TASK_PERMISSION', 'c');

exec dbms_mview.refresh('base_adp_id', 'c');
exec dbms_mview.refresh('BASE_GROUP_SEC', 'c');
exec dbms_mview.refresh('BASE_ROLE_INFO', 'c');
exec dbms_mview.refresh('BASE_SEC_INFO', 'c');
exec dbms_mview.refresh('HWSE_USER_ENV_ACCESS', 'c');

sqlplus hwse_admin/hwse_admin@cru02s
exec hwse_refresh('HWSE_REG0002');

hwse refresh list:
SELECT 'prompt refreshing ' || mview_name || chr(10) || 'EXEC dbms_mview.refresh(''' || mview_name || ''', ''C'');'
FROM user_mviews ORDER BY 1;

SELECT
'prompt loading ' || substr(view_name, 1, LENGTH(view_name)-1)  || CHR(10) ||
'delete from ' || substr(view_name, 1, LENGTH(view_name)-1) || ';'    || CHR(10) ||
'insert /*+ append */ INTO ' || substr(view_name, 1, LENGTH(view_name)-1) || ' SELECT * FROM ' || view_name || ' nologging;' || CHR(10) ||
'COMMIT;'
FROM user_views;


select * from table(select SCH_NAMES from MV_REFRESH_JOB) order by 1;


create table t1 tablespace data1 as
select distinct c.client_code, c.CLIENT_ORGOID, bcp.BCP_EXTENSION_VALUE
from batclientproduct bcp, catclient c 
where 
bcp.client_code = c.client_code
and prd_code = 'BASE' and 
substr(BCP_EXTENSION_VALUE, 2) in (
)
order by 1;


col ClientName form a70
col IsiClientId form a25
col clientoid form a30
set lines 130
select distinct upper(displayname) ClientName, upper(o) IsiClientId, CLIENTOID from i_isiclient where CLIENTOID in (
  select client_orgoid from t1@dblinkcru40ptocrc11p
) order by 1;



1. change the SOR entries with proper values for REPLICATING etc..

2.
sqlplus hwse_admin/hwse_admin@cru04p
delete from prev_mv_refresh_job;
insert into prev_mv_refresh_job select * from mv_refresh_job;
commit;
delete from mv_refresh_job;
insert into mv_refresh_job (sch_names, num_threads,num_dedicate)
values (cast(multiset(select target_schema_name
      from ggate.adpr_client_extensions
      where replicating is null) as sch_name_list),
	  100,30);
commit;
exec hwse_ref_job;

============================hwse refreshes==============================
exec hwse_refresh('HWSE_REG0017');

sqlplus hwse_admin/hwse_admin@cru04p
set serveroutput on

exec hwse_refresh('HWSE_REG0106');
exec hwse_refresh('HWSE_REG0325');
exec hwse_refresh('HWSE_REG0145');
exec hwse_refresh('HWSE_REG0257');
exec hwse_refresh('HWSE_REG0259');
exec hwse_refresh('HWSE_REG0081');
exec hwse_refresh('HWSE_REG0179');
exec hwse_refresh('HWSE_REG0198');
exec hwse_refresh('HWSE_REG0109');


-- CHECK CURRENTLY REFRESHING MVs
SELECT * FROM V$MVREFRESH ORDER BY 3;

SELECT * FROM V$MVREFRESH
truncate Table mv_refresh_job;

insert into mv_refresh_job (sch_names, num_threads,NUM_DEDICATE) values (
cast(multiset(select TARGET_SCHEMA_NAME from ggate.ADPR_CLIENT_EXTENSIONS
where replicating is null
) as SCH_NAME_LIST), 100,30);
/* ) as SCH_NAME_LIST), 120,25);*/
commit;
exec hwse_ref_job;

select s.chain_name, s.step_name, s.program_name, s.step_type
from all_scheduler_chain_steps s
where s.chain_name = 'M'
order by to_number(regexp_replace(step_name, '[A-Z]',''));


-- for FIT ctest
truncate table mv_refresh_job;
insert into mv_refresh_job (sch_names, num_threads,NUM_DEDICATE) values (
cast(multiset(select 'HWSE_REG0005' from dual) as SCH_NAME_LIST), 100,30);
exec hwse_ref_job1;





exec dbms_scheduler.drop_job('HWSE_NIGHTLY_REFRESH',true);

BEGIN
        dbms_scheduler.create_job('HWSE_NIGHTLY_REFRESH', job_type => 'CHAIN',
        job_action => 'M',
        repeat_interval => 'freq=daily;byhour=11;byminute=32;bysecond=00',
        enabled => TRUE);
END;
/

exec dbms_scheduler.drop_job('HWSE_NIGHTLY_REFRESH',true);

BEGIN
        dbms_scheduler.create_job('HWSE_NIGHTLY_REFRESH', job_type => 'CHAIN',
        job_action => 'M',
        repeat_interval => 'freq=daily;byhour=10;byminute=30;bysecond=00',
        enabled => TRUE);
END;
/

exec dbms_scheduler.drop_job('HWSE_HOURLY_REPORT',true);
BEGIN
        dbms_scheduler.create_job('HWSE_HOURLY_REPORT', job_type => 'PLSQL_BLOCK',
        job_action => 'BEGIN HWSE_HOURLY_REP_PROC; END;',
        repeat_interval => 'freq=hourly;byhour=00,06,07,08,09,10,11,12,13,14,15,16,17,18;byminute=15;bysecond=00',
        enabled => TRUE);
  END;
/

exec dbms_scheduler.drop_job('HWSE_MGMT_REPORT',true);
BEGIN
        dbms_scheduler.create_job('HWSE_MGMT_REPORT', job_type => 'PLSQL_BLOCK',
        job_action => 'BEGIN HWSE_MGMT_REP_PROC; END;',
        repeat_interval => 'freq=daily;byhour=7;byminute=45;bysecond=00',
        enabled => TRUE);
  END;
/

select JOB_NAME ||' to run '||JOB_ACTION||' has been '|| STATE||' at '|| START_DATE||' for '|| NEXT_RUN_DATE job_details
from user_scheduler_jobs where JOB_NAME in ('HWSE_HOURLY_REPORT','HWSE_MGMT_REPORT','HWSE_NIGHTLY_REFRESH')
and NEXT_RUN_DATE is not null;

select JOB_NAME ||' to run '||JOB_ACTION||' has been '|| STATE||
' at '|| START_DATE||' for '|| NEXT_RUN_DATE job_details
from user_scheduler_jobs where JOB_NAME in ('ADPR_MINUTE_TEST', 'ADPR_RESET_CC','ADPR_BLOCK_CC')
and NEXT_RUN_DATE is not null;


exec dbms_scheduler.drop_job('HWSE_HOURLY_REPORT',true);
BEGIN
        dbms_scheduler.create_job('HWSE_HOURLY_REPORT', job_type => 'PLSQL_BLOCK',
        job_action => 'BEGIN HWSE_HOURLY_REP_PROC; END;',
        repeat_interval => 'freq=hourly;byhour=22,23,00,01,02,03,04,05,06,07;byminute=45;bysecond=00',
        enabled => TRUE);
  END;
/

ggsupport@dc2prf002db04:~/HWSE


delete from prev_mv_refresh_job;
insert into prev_mv_refresh_job select * from mv_refresh_job;
commit;

update mv_refresh_job set sch_names =
(cast(multiset(select column_value from table(select sch_names from mv_refresh_job)) as SCH_NAME_LIST)
multiset union
cast(multiset(select 'HWSE_REG0003' from dual) as SCH_NAME_LIST)
multiset union
cast(multiset(select 'HWSE_REG0006' from dual) as SCH_NAME_LIST)
multiset union
cast(multiset(select 'HWSE_REG0013' from dual) as SCH_NAME_LIST)
multiset union
cast(multiset(select 'HWSE_REG0019' from dual) as SCH_NAME_LIST)
multiset union
cast(multiset(select 'HWSE_REG0021' from dual) as SCH_NAME_LIST))
;
commit;




SELECT hwse_schema_name
      ,mv_name
      ,refresh_start_time
      ,refresh_end_time
      ,(refresh_end_time-refresh_start_time) runtime
      ,refresh_status
      ,refresh_error
      ,run_date
FROM   mv_refresh_log_hist
WHERE trunc(run_date) = TRUNC(SYSDATE)-2
AND mv_name = 'PEND_EVNT_ELE_VW'
ORDER BY runtime DESC;


This procedure is to diagnose and resolve issues during HWSE refresh which occur due to the Oracle scheduler bug. This issue can hapen for cru03p or cru04p

Steps to determine if slowness is due to the bug:
=================================================
Run the following query.  If the "Sessions waiting for JS latch" count is close to the "Active refresh sessions" count then we are being affected by the Oracle bug and need to restart the database.


SELECT 'Sessions waiting for JS latch: ' NAME,
       (SELECT COUNT(*)
       FROM    gv$latch a,
               gv$session b
       WHERE   a.inst_id =b.inst_id
       AND     a.latch#  =b.p2
       AND     a.name    ='JS broadcast kill buf latch'
       AND     b.username='HWSE_ADMIN'
       AND     b.status  ='ACTIVE'
       AND     b.event   ='latch free')
       COUNT
FROM   dual
UNION ALL
SELECT   'Active refresh sessions: ' NAME,
         (SELECT COUNT(*)
         FROM    gv$session
         WHERE   username='HWSE_ADMIN')
         COUNT
FROM     dual
ORDER BY NAME;


The output will look similar to this:

NAME                                  COUNT
-------------------------------- ----------
Active refresh sessions:                 44
Sessions waiting for JS latch:           32




Steps to request DB Restart for this issue:
===========================================

1.  Submit an emergency CO to db hosting to restart the affected database
2.  Contact hosting to perform the restart





++++++++++++++++++++++++++++++++++++++++++++

Which HWSE schemas are refreshing from scheduler:
SELECT x.program_name, x.program_action FROM dba_scheduler_jobs j, all_scheduler_chain_steps cs, all_scheduler_programs x
 WHERE j.job_name = 'HWSE_NIGHTLY_REFRESH' AND j.STATE='RUNNING'
 AND cs.program_name = j.program_name
 AND cs.program_name = x.program_name ORDER BY 2;



select x.program_action from all_scheduler_programs x,
all_scheduler_chain_steps s
 where x.program_name = s.program_name
 AND s.step_type != 'SUBCHAIN'
 AND chain_name not like 'HWSE_REG%'
 --AND program_action LIKE '%HWSE_REFRESH%';


 col progname format a100
 col program_name format a10
 col step_name format a10
 col chain_name format a10

SELECT LEVEL, chain_name, step_name, step_type, program_name,
(select x.program_action from all_scheduler_programs x WHERE
x.program_name = s.program_name) progname
FROM all_scheduler_chain_steps s
 WHERE chain_name NOT LIKE 'HWSE_REG%'
START WITH chain_name = 'M' --AND step_name = 'MS0'
CONNECT BY PRIOR program_name = chain_name
ORDER BY LEVEL,
To_Number(regexp_replace(chain_name, '[A-Z]', '')),
To_Number(regexp_replace(program_name, '[A-Z]', ''));




ggate@cru04p
set serveroutput on size 1000000
exec display_chains('M');

copy the o/p to /export/home/infor/vijay/hwse_tuning/hwse_stats.txt
cd /export/home/infor/vijay/hwse_tuning/
perl hwse_stats.pl


-- which chain took how long to complete ?
select distinct chain, st, et, (et-st) duration from (
select chain, schm, --refresh_start_time, refresh_end_time,
min(refresh_start_time) over (partition by chain) st,
max(refresh_end_time) over (partition by chain) et
from ggate.hwse_steps
) order by 4;


-- which program is in which chain ?
select chain, step, prog, schm from ggate.hwse_steps where chain = 'C100'


-- Most recent refresh durations
col REFRESH_END_TIME format a30
col refresh_finish_time format a30
col duration format a30
col hwse_schema_name format a13
col REFRESH_START_TIME format a30
select run_date, hwse_schema_name, REFRESH_START_TIME, refresh_finish_time, (refresh_finish_time-REFRESH_START_TIME)  duration
from (
select run_date, hwse_schema_name, REFRESH_START_TIME, REFRESH_END_TIME,
lead (REFRESH_END_TIME) over (partition by run_date, hwse_schema_name order by REFRESH_END_TIME) refresh_finish_time
from MV_REFRESH_LOG_HIST where 1=1
--and hwse_schema_name in ( 'HWSE_REG0259', 'HWSE_REG0198', 'HWSE_REG0251')
and MV_NAME in ('ADDRESS_DETAIL', 'VOL_BENEFITS_VW')
and run_date = (
	select run_date from (
	select run_date, row_number() over(order by run_date desc ) rn
	 from (select distinct run_date from MV_REFRESH_LOG_HIST where hwse_schema_name = 'HWSE_REG0198')
	 ) where rn = 1
)
) where refresh_finish_time is not null
order by run_date, (refresh_finish_time-REFRESH_START_TIME)
/


-- What is running now with duration...
col REFRESH_START_TIME format a30
col DURATION format a30
select MV_NAME, REFRESH_START_TIME, (REFRESH_END_TIME-REFRESH_START_TIME) DURATION
FROM MV_REFRESH_LOG WHERE HWSE_SCHEMA_NAME = 'HWSE_REG0179'
--and MV_NAME like 'ELECTION%'
order by REFRESH_START_TIME;

HWSE_REG0112  ELECTION_ALL_MV
HWSE_REG0116
HWSE_REG0145
HWSE_REG0179
HWSE_REG0251



-- What is currently Processing...
col HWSE_SCHEMA_NAME format a13
col MV_NAME format a30
col REFRESH_STATUS format a20
SELECT HWSE_SCHEMA_NAME, MV_NAME, REFRESH_STATUS
FROM MV_REFRESH_LOG WHERE REFRESH_STATUS = 'Processing'
OR REFRESH_STATUS IS NULL
order by 1;

SELECT SOURCE_SCHEMA_NAME, ISI_CLIENT_ID
FROM GGATE.ADPR_CLIENT_EXTENSIONS
WHERE TARGET_SCHEMA_NAME = 'HWSE_REG0081';

-- how long each mv took for this region
set lines 180
col REFRESH_START_TIME format a30
col REFRESH_END_TIME format a30
col duration format a30
col dursec format 999999
col MV_NAME format a30
select mv_name, dursec, trunc(100*ratio_to_report(dursec) over())  from (
select MV_NAME, REFRESH_START_TIME, REFRESH_END_TIME, (REFRESH_END_TIME-REFRESH_START_TIME)  duration,
( CAST( REFRESH_END_TIME AS DATE ) - CAST( REFRESH_START_TIME AS DATE ) ) * 86400 dursec
from MV_REFRESH_LOG_HIST
WHERE 1=1
--AND MV_NAME = 'ELECTION_ALL_MV'
AND run_date = (
	select run_date from (
	select run_date, row_number() over(order by run_date desc ) rn
	 from (select distinct run_date from MV_REFRESH_LOG_HIST where hwse_schema_name = 'HWSE_REG0112')
	 ) where rn = 1
)
and hwse_schema_name = 'HWSE_REG0112'
ORDER BY REFRESH_START_TIME) order by 3 desc ;


-- How long each MV refresh took last time?
select hwse_schema_name, mv_name,-- refresh_start_time, refresh_end_time,
(REFRESH_END_TIME-REFRESH_START_TIME) DURATION
FROM MV_REFRESH_LOG_HIST WHERE 1=1
and hwse_schema_name = 'HWSE_REG0116'
AND RUN_DATE = (SELECT MAX(RUN_DATE) FROM MV_REFRESH_LOG_HIST
WHERE HWSE_SCHEMA_NAME = 'HWSE_REG0116')
ORDER BY (REFRESH_END_TIME-REFRESH_START_TIME) DESC;

select hwse_schema_name, to_char(refresh_start_time, 'MM/DD/YYYY') , duration from (
select hwse_schema_name, refresh_start_time, (REFRESH_END_TIME-REFRESH_START_TIME) DURATION
from MV_REFRESH_LOG_HIST WHERE 1=1
and mv_name = 'ADDRESS_USAGE'
and hwse_schema_name='HWSE_REG0116'
order by 2 desc
) where rownum < 30;

select 'approach 1 start time: ' || systimestamp from dual;
exec dbms_mview.refresh('ELECTION_ALL_MV1', 'C');
select 'approach 1 end time: ' || systimestamp from dual;
drop index IDX_MV_ELECTION1;
drop index IDX_MV_ELECTION1_2 ;
drop index IDX_MV_ELECTION1_3 ;
drop index IDX_MV_ELECTION1_4 ;
select 'approach2 start time: ' || systimestamp from dual;
exec dbms_mview.refresh('ELECTION_ALL_MV1', 'C');
create index IDX_MV_ELECTION1 on ELECTION_ALL_MV1 (ELECTION_SNAPSHOT_ID) tablespace index1 nologging;
create index IDX_MV_ELECTION1_2 on ELECTION_ALL_MV1 (BEN_ELECTION_STATUS_ID) tablespace index1 nologging;
create index IDX_MV_ELECTION1_3 on ELECTION_ALL_MV1 (EE_PARTICIPANT_ID) tablespace index1 nologging;
create index IDX_MV_ELECTION1_4 on ELECTION_ALL_MV1(participant_id ) tablespace index1 nologging;
select 'approach2 end time: ' || systimestamp from dual;




select * from all_scheduler_chains where owner = 'HWSE_ADMIN' and chain_name not like 'HWSE_REG%';
select * from all_scheduler_chain_steps;

select * from all_scheduler_chain_rules where owner = 'HWSE_ADMIN' and chain_name not like 'HWSE_REG%';
SELECT * FROM ALL_SCHEDULER_PROGRAMS WHERE owner = 'HWSE_ADMIN' and program_name not like 'HWSE_REG%';
select * from all_rule_sets;
select * from all_rule_set_rules where rule_set_name = 'SCHED_RULESET$3';

select chain_name, condition, action, rule_name from all_scheduler_chain_rules  where chain_name = 'M';

select s.chain_name, s.step_name, s.program_name, s.step_type
from all_scheduler_chain_steps s
where s.chain_name = 'N'
order by to_number(regexp_replace(step_name, '[A-Z]',''));


How long (seconds) refresh took ?
select SUM(extract (hour from DURATION)*60*60) +
SUM(extract (minute from DURATION)*60) +
SUM(extract (second from DURATION))
from (
select HWSE_SCHEMA_NAME, MV_NAME,REFRESH_START_TIME, REFRESH_END_TIME,
(REFRESH_END_TIME-REFRESH_START_TIME) DURATION
from MV_REFRESH_LOG_HIST where 1=1
and hwse_schema_name = 'HWSE_REG0198'
AND RUN_DATE = (SELECT MAX(RUN_DATE) FROM MV_REFRESH_LOG_HIST
where HWSE_SCHEMA_NAME = 'HWSE_REG0198')
and MV_NAME like 'ELECTION%'
and mv_name not in ('ELECTION_ALL_MV', 'ELECTION_DATA_VW', 'ELECTION')
order by REFRESH_END_TIME desc
)


-- How long each day refersh took ?
SELECT (Trunc(clnten)-1) run_date, clntst, clnten,
(clntst-(Trunc(clnten)-1+ INTERVAL '22' HOUR + INTERVAL '30' MINUTE)) commondur,
(clnten-clntst) clntdur,
(clnten-(Trunc(clnten)-1+ INTERVAL '22' HOUR + INTERVAL '30' MINUTE)) totdur
FROM (
SELECT DISTINCT run_date, Min(refresh_start_time) OVER (PARTITION BY RUN_date) clntst, Max(refresh_end_time) OVER (PARTITION BY RUN_date) clnten
 FROM mv_refresh_log_histl
WHERE 1=1
--AND hwse_schema_name = 'HWSE_REG0251'
AND mv_name IN ( 'ADDRESS_DETAIL', 'DVS_DATA_VW' )
AND  run_date > To_Date('12/01/2013 22:00:00', 'MM/DD/YYYY HH24:MI:SS')
 AND run_date < To_Date('12/17/2013 22:00:00', 'MM/DD/YYYY HH24:MI:SS')
) ORDER BY 1





TO POPULATE HWSE CLIENT REFRESH DATA FOR ANALYSIS
===================================================

ggate@cru04p
set serveroutput on size 1000000
exec display_chains('M');

copy the o/p to /export/home/infor/vijay/hwse_tuning/hwse_stats.txt
cd /export/home/infor/vijay/hwse_tuning/
perl hwse_stats.pl



==========================================

Table Mode    Insert Mode     ArchiveLog mode      result
-----------   -------------   -----------------    ----------
LOGGING       APPEND          ARCHIVE LOG          redo generated
NOLOGGING     APPEND          ARCHIVE LOG          no redo
LOGGING       no append       ""                   redo generated
NOLOGGING     no append       ""                   redo generated
LOGGING       APPEND          noarchive log mode   no redo
NOLOGGING     APPEND          noarchive log mode   no redo
LOGGING       no append       noarchive log mode   redo generated
NOLOGGING     no append       noarchive log mode   redo generated

===========================================
crontab:
min(0-59) hour(0-23) day (1-31) month (1-12) dayofweek(0-6) (0=sunday)

36 2 * * * root /bin/run.sh
   runs /bin/run.sh as root every day at 2:36 am


===========================================
new client
   isiclient
   isiproduct_sc_client
 SQL> select DISTINCT adpuserstatus, clientoid, adpproducts_full, adpactivedate
  2  from appadm.isiuser where userid = 'RDUNCAN@SOEASTFIRE';



  SELECT session_id, user_login, session_timestamp, session_parent_id  FROM secsession WHERE client_code = 'SOEASTFIRE';
  SELECT user_key FROM secuser WHERE user_login = 'RDUNCAN@SOEASTFIRE';
  select * FROM qryquery WHERE user_key = '52775';
  SELECT * FROM mv_userroleareatable where user_key = '52775';
=====================================================


cat ./apps/listener_impact/rle.sh
SUPPORTED=en_US.UTF-8:en_US:en
JAVA_HOME=/opt/jdk1.5.0_15/jre
export JAVA_HOME
CLASSPATH=.
for i in lib/*.jar; do
        CLASSPATH="$CLASSPATH":$i
done;

start() {
   "$JAVA_HOME"/bin/java -Xms64m -Xmx1536m -Dlog4j.configuration=conf/log4j.properties -cp $CLASSPATH -jar rle.jar $1 $2 $3 &
   sleep 4
   echo
}

add() {
   "$JAVA_HOME"/bin/java -Xms64m -Xmx1536m -Dlog4j.configuration=conf/log4j.properties -cp $CLASSPATH -jar rle.jar $1 $2 $3 &
   sleep 4
   echo
}

query() {
   "$JAVA_HOME"/bin/java -Xms64m -Xmx1536m -Dlog4j.configuration=conf/log4j.properties -cp $CLASSPATH -jar rle.jar query
}

dump() {
   "$JAVA_HOME"/bin/java -Xms64m -Xmx1536m -Dlog4j.configuration=conf/log4j.properties -cp $CLASSPATH -jar rle.jar dump
}

stop() {
   "$JAVA_HOME"/bin/java -Xms64m -Xmx1536m -Dlog4j.configuration=conf/log4j.properties -cp $CLASSPATH -jar rle.jar $1 $2
}


case "$1" in
start)
        start "$1" "$2" "$3"
        ;;
add)
        add "$1" "$2" "$3"
        ;;
stop)
        stop "$1" "$2"
        ;;
query)
        query
        ;;
dump)
        dump
        ;;

esac
==================================== */

select a.name, b.value
from gv$statname a, gv$mystat b
where a.statistic# = b.statistic#
and a.name = 'redo size';


set feedback off timing off verify off define off timing off
col area format a30
prompt ######################################################################################
SELECT CASE WHEN rn = 1 THEN area_name ELSE '    ' END AREA, filename, tab_code FROM (
SELECT AREA_NAME, Row_Number() over (PARTITION BY area_name ORDER BY area_name) rn,
       filename, tab_code FROM (
SELECT a.*, b.tab_code,
(select x.TAB_LABEL from cattable x where x.tab_code=b.tab_code and x.TAB_HIDDEN='f') filename
FROM catarea a, catareatable b
WHERE a.area_key = b.area_key
AND b.tab_code like
'%TMS@@%'
) WHERE filename IS NOT NULL ORDER BY 1,2,3);
prompt ######################################################################################


SELECT area_name FROM catarea
WHERE area_key IN (
SELECT DISTINCT area_key FROM catareatable WHERE tab_code LIKE '%HRB@@25'
)

=============ACS=================================
fit cron job:
/ggate/dbtools/acs/acs_common_upd.sh prt01q cru20q sdr02q


iat:
select * from PORTALMAS01_ACS.SAC_USER_ROLE_XREF@Dblinkcrts01toprt01s

prod:
ACS
SELECT Count(1) FROM PORTALMAS01_ACS.sac_user@dblinkcru20ptoPRM01P
SELECT Count(1) FROM PORTALMAS02_ACS.sac_user@dblinkcru20ptoPRM01P
SELECT Count(1) FROM PORTALMASPI_ACS.sac_user@dblinkcru20ptoPRM01P

SELECT Count(1) FROM PORTALMASPI_ACS.sac_user@DBLINKCRU20PTOPRM01P;

create database link CCE_DBLINK connect to common80 identified by commonr8 using 'prt21p';


FIT:

select count(1) from PORTALMAS01_ACS.sac_user@DBLINKCRS01QTOPXS01P where upper(isi_user_id) like '%@AECHELON';


acs developers: Shah Nirav, Ed2 as developers
DL: Portal integration development DBA <Portal_integration_development_DBA@ADP.com>

SD:
cru_user.adpr_portal_mas_client_vw@DBLINKCRTP01TOSDR01P

DECLARE
  VJOB NUMBER DEFAULT 0;
BEGIN
  SELECT JOB INTO VJOB FROM USER_JOBS WHERE UPPER(WHAT) LIKE '%MV_SAC%';
  DBMS_JOB.BROKEN(VJOB,FALSE);
END;
/

sqlplus adprmasfit02/adprmasfit02@crc02q
SELECT * FROM batclientproduct WHERE client_code = 'WEASLY'

SELECT DISTINCT vpd_key, user_id FROM payx_reg02_pod30.security_user@dblinkcrtq01tocru20q
WHERE vpd_key in ('PAYXSCH0105332')
WHERE UPPER(user_id) LIKE '%@WEASLY'
select * from acs_mas_pod02.sac_user WHERE isi_user_id LIKE '%WEASLY'
SELECT * FROM acs_mas_pod02.MV_SAC WHERE upper(isi_user_id) LIKE '%@WEASLY'
select * from dba_jobs where WHAT like '%MV_SAC%' and SCHEMA_USER='ACS_MAS_POD02';

SELECT * FROM acs_mas_common.payx_wfn_client WHERE ORGANIZATION_OID = 'G3HVKPX3GC061CPV';
SELECT * FROM acs_mas_common.acs_client_pod_map WHERE client_oid = 'G3HVKPX3GC061CPV';
INSERT INTO acs_mas_common.payx_wfn_client  VALUES ('E34I2T', 'CHARAH', 'G3HVKPX3GC061CPV', 1);
INSERT INTO acs_mas_common.acs_client_pod_map VALUEs ('E34I2T', 'CHARAH', 'CHARAH', 'G3HVKPX3GC061CPV', 'POD02', '8.0', 'HomepagePortal');

select count(*) from acs_mas_pod01.sac_user where upper(ISI_USER_ID) like '%@CHARAH';
select * from cru_user.adpr_portal_mas_client_vw@DBLINKCRU20QTOSDR12Q where  client_oid = 'G3HVKPX3GC061CPV';

--new dbs
select count(1) from cru_user.adpr_portal_mas_client_vw@DBLINKCRU20STOSDR11S;
select count(1) from cru_user.adpr_portal_mas_client_vw@DBLINKCRU20QTOSDR12Q;
select count(1) from cru_user.adpr_portal_mas_client_vw@DBLINKCRU20PTOSDR12P;

old--> sdr11p

select count(1) from PORTALMAS01_ACS.sac_user@dblinkcrtq01toprt01q where upper(isi_user_id) = 'ADPRWF2@WF2';



select count(1) from PORTALMAS01_ACS.sac_user@dblinkcrtq01toprt01q where upper(isi_user_id) = 'ADPRWF2@WF2';
SQL> select ISI_USER_ID , FIRST_NAME, LAST_NAME
  2  from PORTALMASPI_ACS.SAC_USER@DBLINKCRU20PTOPRM01P where user_oid = 'G4X84B3THEP00ZSM';
LHAWKEN@UCPH
Laura
Hawken

select count(1) from PORTALMAS06_ACS.SAC_USER@DBLINKCRU20PTOPRM01P where client_oid = '9811C450512012D3';




SD LOGIC:
col app_nm format a40
select isi_client_id, app_nm from (
SELECT DISTINCT a.app_nm,
       o.net_secure_id AS isi_client_id,
       o.org_tx AS isi_client_nm,
       o.oid_tx AS client_oid,
       i.inst_nm AS portal_pod,
       v.app_ver_tx AS portal_ver,
       a.app_nm AS portal_app
FROM
       SDADM.t_org@dblinkcru20ptosdr01p o,
       SDADM.t_org_inst@dblinkcru20ptosdr01p oi,
       SDADM.t_app@dblinkcru20ptosdr01p a,
       SDADM.t_app_ver@dblinkcru20ptosdr01p v,
       SDADM.t_inst@dblinkcru20ptosdr01p i
WHERE o.org_id = oi.org_id
   AND i.inst_id = oi.inst_id
   AND a.app_id = v.app_id
   AND v.app_ver_id = i.app_ver_id
) where
client_oid in  (
'FB0803E1F7201F8E',
'20BC20F2FF50A0EF',
'1A35CFCC65201390',
'FFDA5AAD59C002F3',
'D0C77A416130003C',
'F2B84C50EDD005DA',
'1A35CFCC65201390',
'G3NNEYNKXZ3MXYNM')
order by 1,2;


===================================

mig_status 's' is locked for migration, 'P' is in processing of migration 'C' is completed migration , E is error in migration and 'M' is migration completed and version is updated

MIGRATION ENGINE

    Useful queries:
    select * from admclientmigration where client_code = 'PARIVEDA'
    select * from admclientmigrationdetail where acm_key = '32138' and qry_key_target = '1427061634870'
    --select * from qrycalcfieldsel where qrfie_key = '82245874'
    select distinct qry_key_versionof from qryquery where qry_name = 'HR_Headcount & Attrition Report - Active/Term' and client_code = 'PARIVEDA'
    --select * from qryquery where qry_name = 'HR_Headcount & Attrition Report - Active/Term' and client_code = 'PARIVEDA' and qry_active = 't'
    select * from qryfield where qry_key = '1409512657910' -- WFN 5
    select * from qryfield where qry_key = '1427061634870' -- WFN 7

    update batsched set sch_status = 'onhold' where qry_key IN (select qry_key from qryquery where client_code = 'PARIVEDA') and sch_status = 'active';
    commit;



select qry_key, qry_status, qry_name, qry_versiondate, qry_lastchangetime
from qryquery where qry_key_versionof = '1510512544940' order by 4 desc

select sch_key, sch_lastmsg, sch_eff_start, sch_eff_end
from batsched_audit where qry_key IN (select qry_key from qryquery where qry_key_versionof = '1510512544940') order by sch_eff_start desc



SELECT * FROM ggate.v_client_logon WHERE vpd_key in ('PAYXSCH0076912', 'PAYXSCH0018256');
SELECT * FROM payx_wfn_client WHERE organization_oid = '8792E626A3F0BA15'

SELECT * FROM appadm.isiclient@dblinkcrtp03tocrtp01 WHERE clientoid IN ('8792E626A3F0BA15', 'E1D72E8B507004C0')
=====================================

HRII:

ADPR-HRII-FIT  http://10.5.166.126/phpinfo.php
Release 10.00.00.011

cdlfthiarws03:/apps/oracle/product/10.2/network/admin # sqlplus webrepadmin/webrepadmin@cru06q_svc1


-- Create the synonym
create or replace synonym V_CLIENT_LOGON
  for NGAPP.V_CLIENT_LOGON@PYXPR1;

-- Create the synonym
create or replace synonym CLIENT
  for PAYXAPP.CLIENT@PYXPR1;
=============================================
How to add supplemental logging:
alter database add supplemental log data (primary key, unique index) columns;

=============================================
State Disability Insurance (SDI) and State Unemployment Insurance (SUI)


create sd ticket:
http://dpopsweb

3839555

They must all belong to the same schema and instance.

virtual edge
sqlserver distribution database
  -> informatica power exchange

encryption/decryption

I140 TRACKING NUMBER
src1090211735

select DB_SERVER,DB_INSTANCE,DB_USERID,NAME from payxapp.clientdatabase@dblinkcrtp01topyxpr1
where DB_USERID='PAYXSCH0022760';


crr01d db box (dbserver: cdlpfcruap3, ip: 10.5.6.97)   -- server, db same
crr01s db box: 172.20.240.23 (dc1rtf001db02)  -- gg
crr01s ip: 172.21.17.100 (dc1stcrptgg1)   -- gg server is running
crts01 db box: 172.21.17.104 (dc1stcrptdb2)
crr01p ip: 172.24.224.20 (dc2prf002db01)
crtp03 db box: 172.24.32.173 (dc2prcrptdb3)

--------------------------------------------------

wf_LOAD_MOBILE_CLIENTS
-----------------------
/apps/crt/pcs/SessLogs/s_m_MOBILE_CLIENT_DTLS_NAS.log
/apps/crt/pcs/SessLogs/s_m_MOBILE_CLIENT_DTLS.log
cmd_load_mobile_clients
	load_mobile_clients_payx_r17	sh -c "/apps/crt/mobile/scripts/adpr_mobile_payx.sh crtp03 wfn_mobile > /apps/crt/mobile/logs/adpr_mobile_payx_error.log
	load_mobile_clients_payx		sh -c "/apps/crt/mobile/scripts/adpr_mobile_payx.sh crtp03 wfn_mobile > /apps/crt/mobile/logs/adpr_mobile_payx_error.log
	load_mobile_clients_hrb			sh -c "/apps/crt/mobile/scripts/adpr_mobile_hrb.sh crtp03 wfn_mobile > /apps/crt/mobile/logs/adpr_mobile_hrb_error.log
	load_mobile_clients_nas			sh -c "/apps/crt/mobile/scripts/adpr_mobile_nas.sh crtp03 wfn_mobile > /apps/crt/mobile/logs/adpr_mobile_nas_error.log


wf_LOAD_MOBILE_CLIENTS_PAYX_R17
/apps/crt/pcs/SessLogs/s_m_WORKER_DIRECTORY_PAYX_R17.log
/apps/crt/pcs/SessLogs/s_m_WORKER_LOCATION_PAYX_R17.log
	parameter file	/apps/crt/mobile/scripts/mobile_app_parameters_payx_r17.prm
	$DBConnection_Source	GGATE
	$DBConnection_Target	WFN_MOBILE
	$DBLINKVALUE			@DBLINKCRTP05TOCRTP03
	$SCHEMA_NAME			PAYX_REG26_POD01
	$WFN_SCHEMA_NAME		WFN_MOBILE


wf_LOAD_MOBILE_CLIENTS_PAYX
/apps/crt/pcs/SessLogs/s_m_WORKER_DIRECTORY_PAYX.log
/apps/crt/pcs/SessLogs/s_m_WORKER_LOCATION_PAYX.log

	parameter file	/apps/crt/mobile/scripts/mobile_app_parameters_payx.prm
	$DBConnection_Source	GGATE
	$DBConnection_Target	WFN_MOBILE
	$DBLINKVALUE
	$SCHEMA_NAME			PAYX_REG04_POD31
	$WFN_SCHEMA_NAME		WFN_MOBILE


wf_LOAD_MOBILE_CLIENTS_NAS
/apps/crt/pcs/SessLogs/s_m_WORKER_DIRECTORY_NAS.log
/apps/crt/pcs/SessLogs/s_m_WORKER_LOCATION_NAS.log
	param file	/apps/crt/mobile/scripts/mobile_app_parameters_nas.prm
	$DBConnection_Source	ADPRETL
	$DBConnection_Target	WFN_MOBILE
	$DBLINKVALUE
	$SCHEMA_NAME			EM81
	$WFN_SCHEMA_NAME		WFN_MOBILE


wf_LOAD_MOBILE_CLIENTS_HRB
/apps/crt/pcs/SessLogs/s_m_WORKER_DIRECTORY_HRB.log
/apps/crt/pcs/SessLogs/s_m_WORKER_LOCATION_HRB.log
	Parameter file	/apps/crt/mobile/scripts/mobile_app_parameters_hrb.prm
	$DBConnection_Source	GGATE
	$DBConnection_Target	WFN_MOBILE
	$DBLINKVALUE			@DBLINKCRTP05TOCRTP03
	$SCHEMA_NAME			HRB_R25
	$WFN_SCHEMA_NAME		WFN_MOBILE

=====================================
All the company codes of a given client must exist on the same instance and schema on payx source side.


qa selling region
  vpd schema,

vpdkeys to 1 vpd schema

ezlm_common.adpr_ezlm_client_map

ezlm_lcf_table_load
	delete from PREV_LCF_TAB;
	insert into PREV_LCF_TAB select * from LCF_TAB;
    @ezlm_lcf_tab_insert_catp01.sql
catalog_refresh_labels:  EZLM_CUSTOM_LABEL_REFRESH_WEBREPADMIN
	ALTER TRIGGER TMV_BATCLIENTENV DISABLE;
	ALTER TRIGGER TMV_BATCLIENTPROD DISABLE;
	ALTER TRIGGER TMV_CATCLIENT DISABLE;
	exec prc_ezlm_update_labels;    -- ezlm custom labels
	exec prc_hrb_update_labels;     -- hrb custom labels
	exec hrbcustom.run;             -- hrb custom fields
	ALTER TRIGGER TMV_BATCLIENTENV ENABLE;
	ALTER TRIGGER TMV_BATCLIENTPROD ENABLE;
	ALTER TRIGGER TMV_CATCLIENT ENABLE;

exec PRC_REFRESH_MV_TABLES;

SELECT * FROM adpr_ezlm_client_map;
SELECT * FROM adpreportingview;
SELECT * FROM EZLM_REG53_POD01.ezlm_cru;



prc_ezlm_update_labels
   removes entries from batclientconfiguration for clients not having lcf_tab entries
   replaces $Dynamic$ with the client chosen labels
   labels are client specific
prc_hrb_update_labels
   GENERIC_TYPE_LABEL  --CSTFLD  TM_CATEGORY


==============================================
SQL> select VPD_KEY,PAYROLL_AGREEMENT_OID,CANCEL_COV_AMT_CALC from
VPDCLSCH0076000052.TAX_GROUP_TERM_LIFE@DBLINKCRTP03TOPXC02P
where PAYROLL_AGREEMENT_OID = '156333:3778';

================================================
hwse terminated
BELRONUS - TERMINATED
BROWNB – NO START
CC299 – NO START
EDUC – NO START
FLSMIDTH – NO START
FUJIUSA - TERMINATED
GENPACT1 - TERMINATED
HERSHA - TERMINATED
HWD2– TEST CODE
HWSEPOC – TEST CODE
KIDDIEK - TERMINATED
SALES25 - TERMINATED
SOURCE800 - TERMINATED
TBW - TERMINATED
THABITCOMP - TERMINATED
VOITHPREM - TERMINATED
ZDK1 test
ZDK3 test
ZLD1 test

=================================================
CREATE OR REPLACE TYPE MYTEST_TYP IS TABLE OF NUMBER;
CREATE OR REPLACE FUNCTION MYTEST (A NUMBER)
RETURN MYTEST_TYP PIPELINED AS
  CURSOR C1 IS SELECT * FROM EMPLOYEES;
  E1 MYTEST_TYP := MYTEST_TYP();
  E2 MYTEST_TYP := MYTEST_TYP();
BEGIN
  FOR I IN C1
  LOOP
    IF (I.EMPLOYEE_ID = A) THEN
      E1.EXTEND;
      E1(E1.COUNT) := I.EMPLOYEE_ID;
    ELSIF (I.EMPLOYEE_ID >  200) THEN
      E2.EXTEND;
      E2(E2.COUNT) := I.EMPLOYEE_ID;
    END IF;
  END LOOP;
  IF (E1.COUNT>0) THEN
    FOR I IN 1 .. E1.COUNT
    LOOP
      PIPE ROW(E1(I));
    END LOOP;
  ELSIF (E2.COUNT>0) THEN
    FOR I IN 1 .. E2.COUNT
    LOOP
      PIPE ROW(E2(I));
    END LOOP;
  END IF;
  RETURN;
END;
/

SELECT * FROM TABLE(MYTEST(110));
SELECT * FROM TABLE(MYTEST(30));

=======================================================
conn webrepadmin/webrepadmin@catp01
with mysids as
(
select USER_LOGIN, max(session_id) sid from secsession where user_key IN
(select USER_KEY from secuser where USER_LOGIN like '%SHAHMD')
and session_parent_id is null
group by user_login
)
select x.user_login || '  ' || y.val_value
from mysids x, secsessionval y
where x.sid = y.session_id
and y.val_name = 'WS_Session_SSN_Format';
=============================================================

gg commands:


  stats GRPXC01R

The command to reset checkpoints
  alter GXREG02Q begin now
  start GXREG02Q

==============================================================
-- to get the longest run queries from catalog
SELECT * FROM (
SELECT client_code, req_key, (max_rlogts - min_rlogts) duration, rlog_status,
req_rows, rlog_timestamp, max_rlogts,min_rlogts
FROM (
SELECT b.client_code, b.req_rows, bl.req_key, bl.rlog_timestamp,
 MAX(bl.rlog_timestamp) over (partition BY bl.req_key) max_rlogts,
 MIN(bl.rlog_timestamp) over (partition BY bl.req_key) min_rlogts,
 bl.rlog_status
 FROM BATREQ b, batreqlog bl WHERE b.CLIENT_CODE IN (
SELECT CLIENT_CODE from batclientproduct WHERE bcp_extension_value in (
'_1932', '_0231', '_1431', '0331')
AND prd_code = 'PAYX2' AND VER_CODE = '185'
) AND b.req_key = bl.req_key
))
where rlog_status =  'OK'
AND req_rows != 0
order by duration DESC;

======================================================================
Ram
   I guess you are looking for cross product reporting for ASNQ?
   It seems it is a Q client; we never setup any cross product report for Q clients.
1)	Q client code never match with HWSE schema
2)	Q client code never used in HWSE standalone reporting.

===========================================================================
Standard reports tables:

seclink seclinkparam
lnk_id maps one on one to qry_key.

SELECT sl.lnk_id, lnp_val qry_key
FROM seclink sl
,seclinkparam slp
,(SELECT q.qry_key, su.user_key FROM qryquery q,
secuser su WHERE q.user_key = su.user_key AND su.user_login = 'FBRESSLER@ADP'
AND q.qry_mode = 'STD' AND q.QRY_STATUS='90') stdr
WHERE 1=1
AND sl.lnk_key = slp.lnk_key
AND lnp_val = stdr.qry_key AND sl.user_key = stdr.user_key
AND lnp_name = 'iReportKey'




  -hwse standard report run counts
select  client_code, COUNT(1)
from batreq where qry_key IN (
SELECT qry_key FROM qryquery
START WITH qry_key in (
SELECT qry_key
FROM   qryquery
WHERE  qry_mode IN ('STD')
AND    qry_active = 't'
AND    EXISTS (SELECT 1
        FROM   qrytable
        WHERE  qryquery.qry_key = qrytable.qry_key
        AND    tab_code LIKE '%@@BASE@@%17')
)
CONNECT BY PRIOR qry_key = qry_key_copyof
) GROUP BY client_code;



WITH mybatreq AS
 (SELECT a.qry_key_std
        ,a.qry_key
        ,b.client_code
        ,b.req_timestamp
        ,a.qry_title
        ,b.req_title
        ,b.req_status
  FROM   batreq b
        ,(SELECT DISTINCT substr(sys_connect_by_path(qry_key, '/'), 2, 13) qry_key_std
                         ,qry_key
                         ,qry_title
          FROM   qryquery
          START  WITH qry_key IN
                      (SELECT qry_key
                       FROM   qryquery
                       WHERE  qry_mode IN ('STD')
                       AND    qry_active = 't'
                       AND    EXISTS
                        (SELECT 1
                               FROM   qrytable
                               WHERE  qryquery.qry_key = qrytable.qry_key
                               AND    tab_code LIKE '%@@BASE@@%17'))
          CONNECT BY PRIOR qry_key = qry_key_copyof) a
  WHERE  b.qry_key = a.qry_key)
SELECT a.qry_key_std
      ,(SELECT qry_title FROM qryquery WHERE qry_key = a.qry_key_std) qry_key_std_title
      ,a.numclients
      ,d90.numruns r90
      ,d30.numruns r30
      ,d7.numruns r7
FROM   (SELECT qry_key_std
              ,COUNT(1) numclients
        FROM   (SELECT DISTINCT qry_key_std
                               ,client_code
                FROM   mybatreq)
        GROUP  BY qry_key_std) a
      ,(SELECT qry_key_std
              ,COUNT(1) numruns
        FROM   mybatreq
        WHERE  (trunc(systimestamp) - trunc(req_timestamp)) <= 7
        GROUP  BY qry_key_std) d7
      ,(SELECT qry_key_std
              ,COUNT(1) numruns
        FROM   mybatreq
        WHERE  (trunc(systimestamp) - trunc(req_timestamp)) <= 30
        GROUP  BY qry_key_std) d30
      ,(SELECT qry_key_std
              ,COUNT(1) numruns
        FROM   mybatreq
        WHERE  (trunc(systimestamp) - trunc(req_timestamp)) <= 90
        GROUP  BY qry_key_std) d90
WHERE  a.qry_key_std = d7.qry_key_std
AND    a.qry_key_std = d30.qry_key_std
AND    a.qry_key_std = d90.qry_key_std

=============================================================================


SELECT 'UPDATE acs_client_pod_map SET portal_pod=''' ||
Decode(B.portal_pod, 'PORTALMAS01', 'POD01', 'PORTALMAS02', 'POD02', 'PORTALMASPI', 'POD03')
  ||''' where client_oid = ''' ||
a.client_oid || ''';'
FROM acs_mas_common.acs_client_pod_map a,
       cru_user.adpr_portal_mas_client_vw@DBLINKCRTP03TOSDR01P b
       WHERE a.client_oid = b.client_oid
       AND a.portal_pod  != Decode(B.portal_pod, 'PORTALMAS01', 'POD01', 'PORTALMAS02', 'POD02', 'PORTALMASPI', 'POD03')
      -- AND a.client_oid = 'G2TF5NWSTCH000N3'

SELECT * FROM cru_user.adpr_portal_mas_client_vw@DBLINKCRTP03TOSDR01P
WHERE isi_client_id IN ( 'ARBORHLTH', 'ARBORHCARE')
union
select
isi_client_id,
isi_client_nm, client_oid,  portal_pod, portal_ver, portal_app
FROM acs_mas_common.acs_client_pod_map WHERE
isi_client_id IN ( 'ARBORHLTH', 'ARBORHCARE');
======================================================================

How to flush the cursor:

server: dc2prcrptdb3
database: crtp03

Run query to ensure values for the procedure call are correct:
select address, hash_Value from v$sql where sql_id='b3hxqhc5xpw0z';

ADDRESS HASH_VALUE
---------------- ----------
000000046AEA8100 198897695

Run these commands as sysdba (substitute values if needed):
alter session set events '5614566 trace name context forever';
exec sys.dbms_shared_pool.purge('000000046AEA8100,198897695','C');

Run this to ensure the cursor has been removed:
select count(*) from v$sql where sql_id='b3hxqhc5xpw0z';

=============================================================================
session tracing settings:

alter session set max_dump_file_size=UNLIMITED;
alter session set statistics_level=ALL;
alter session set tracefile_identifier='CUSTOM_TRACE';
exec dbms_monitor.session_trace_enable(NULL,NULL,TRUE,TRUE);


============================================================================
SELECT B.REQ_KEY, B.REQ_TITLE, B.REQ_XML, B.REQ_ROWS, BR.RLOG_QUERY, B.REQ_TIMESTAMP
 FROM BATREQ B, BATREQLOG BR, QRYQUERY Q, QRYTABLE QT WHERE
 B.REQ_KEY = BR.REQ_KEY AND
 B.QRY_KEY = Q.QRY_KEY AND
 Q.QRY_KEY = QT.QRY_KEY AND
 QT.TAB_CODE LIKE '%EZ%1118' AND
 B.CLIENT_CODE IN (
SELECT CLIENT_CODE FROM BATCLIENTENVIRONMENT B WHERE B.BCE_DBLINK_VALUE IS NOT NULL
) AND
B.REQ_ROWS > 0 AND ROWNUM < 10 ORDER BY B.REQ_TIMESTAMP DESC;
===================================================


---------------------------------------------------
HRB Webservice calls
We need this rule 172.24.224.xxx, 172.24.32.xxx  <-->  172.20.228.xxx on 80, 443

172.24.224.xxx, ADPR DB servers
172.24.32.xxx , adpr app servers
172.20.228.xxx, HRB App server

Ports: 80, 443

WS ENDPOINT:
  https://commonrpt.ecxml%40adpprod:b6fa2516d691833c9637c326f0ce36c3be9aa4ab@172.20.184.150/wsi

---------------------------------------------------

[7/15/2015 5:24 PM] Morassutti, Fernando (ESI):
dc1rfwfn4arwb02:/apps/primarypod/Reporting # telnet dc1rfwfn4arwb02.whc.dc01.us.adp 9999
Trying 10.136.7.177...
telnet: connect to address 10.136.7.177: Connection refused
[7/15/2015 5:24 PM] Morassutti, Fernando (ESI):
app is not able to connect to bridge

NOT all adpr ws calls are made through bridge.. some are through application php code. But check bridge for HRB.




SET SERVEROUTPUT ON
declare
  l_http_request  utl_http.req;
  errmsg varchar2(4000);
  p_wallet_dir varchar2(1000);
begin
	p_wallet_dir := '/home/oracle/wallet';
	--p_wallet_dir := '/export/home/oracle/wallet';
	utl_http.set_wallet('file:' || p_wallet_dir, 'oracle@2008');
  l_http_request := utl_http.begin_request('https://172.20.184.150/wsi', 'POST','HTTP/1.0');
  dbms_output.put_line('CAN CONNECT');
 EXCEPTION
    when Utl_Http.Request_Failed then
      errmsg := Utl_Http.Get_Detailed_Sqlerrm;
      dbms_output.put_line ( errmsg );
    when OTHERS then
      dbms_output.put_line ( 'othererror: ' || SQLCODE || ' - ' || SQLERRM );
end;
/

10.5.58.232/wsi
10.33.62.20/wsi
SELECT
UTL_HTTP.REQUEST('https://172.24.208.174/wsi','','file:/export/home/oracle/wallet','oracle@2008')
FROM dual;

SELECT
UTL_HTTP.REQUEST('https://172.24.192.151/wsi','','file:/home/oracle/wallet','oracle@2008')
FROM dual;

SELECT
UTL_HTTP.REQUEST('https://10.5.100.44/wsi','','file:/export/home/oracle/wallet','oracle@2008')
FROM dual;

-- Connectivity test:
SET SERVEROUTPUT ON

declare
  r  utl_http.req;
  errmsg varchar2(1000);
begin
    r := utl_http.begin_request('https://172.24.192.151/wsi', 'POST','HTTP/1.0');
	dbms_output.put_line('CAN CONNECT');
 exception
    when utl_http.request_failed then
      errmsg := utl_http.get_detailed_sqlerrm;
      dbms_output.put_line ( errmsg );
    when others then
      dbms_output.put_line ( 'othererror: ' || sqlcode || ' - ' || sqlerrm );
end;
/



-- USE THIS WHEN DEALING WITH F5:
SET SERVEROUTPUT ON
declare
  l_http_request  utl_http.req;
  l_http_response  utl_http.resp;
  errmsg varchar2(4000);
  p_wallet_dir varchar2(1000);
  data VARCHAR2(1024) := 'GetCRRightsInformation ';
  l_string long default null;
begin
	--p_wallet_dir := '/home/oracle/wallet';
	p_wallet_dir := '/export/home/oracle/wallet';
	utl_http.set_wallet('file:' || p_wallet_dir, 'oracle@2008');
  --qa--l_http_request := utl_http.begin_request('https://10.5.100.44/wsi', 'POST','HTTP/1.0');
  --iat--l_http_request := utl_http.begin_request('https://172.24.208.174/wsi', 'POST','HTTP/1.0');
  l_http_request := utl_http.begin_request('https://172.24.192.151/wsi', 'POST','HTTP/1.0');
  --l_http_request := utl_http.begin_request('https://172.20.184.150/wsi', 'POST','HTTP/1.0');
  --prod-url--l_http_request := utl_http.begin_request('http://172.20.93.10/wsi', 'POST','HTTP/1.0');
	dbms_output.put_line('CAN CONNECT');
	utl_http.set_header(l_http_request, 'Content-Length', length(data));
	utl_http.set_header(l_http_request, 'OrgOID', 'G3MXK08TQN0P3ESY');


  -- Now, send the request body
  utl_http.write_text(l_http_request, data);

  -- Get the regular response
  l_http_response := utl_http.get_response(l_http_request);
  utl_http.read_text(l_http_response, data);
  utl_http.end_response(l_http_response);

  dbms_output.put_line ('status code: ' || l_http_response.status_code);
  dbms_output.put_line ('reason: ' || l_http_response.reason_phrase);
  l_string := data;
     loop
        exit when l_string is null;
        dbms_output.put_line( substr( l_string, 1, 250 ) );
        l_string := substr( l_string, 251 );
     end loop;
 EXCEPTION
    when Utl_Http.Request_Failed then
      errmsg := Utl_Http.Get_Detailed_Sqlerrm;
      dbms_output.put_line ( errmsg );
    when OTHERS then
      dbms_output.put_line ( 'othererror: ' || SQLCODE || ' - ' || SQLERRM );
end;
/

---------------

DECLARE
  req utl_http.req;
  resp utl_http.resp;
  resp_name  VARCHAR2(256);
  resp_value VARCHAR2(1024);
  value VARCHAR2(32767);
  l_wallet_location VARCHAR2(200) := 'c:\oracle_home\mywallet';
BEGIN
  utl_http.set_follow_redirect(0);
  utl_http.set_wallet('file:'||g_wallet_location);

  req := utl_http.begin_request('http://www.google.com');
  resp := utl_http.get_response(req);

  FOR i IN 1..utl_http.get_header_count(resp) LOOP
    utl_http.get_header(resp, i, resp_name, resp_value);
    dbms_output.put_line(resp_name || ': ' || resp_value);
  END LOOP;

  if resp.status_code = 200 then

  LOOP
    utl_http.read_line(resp, value, TRUE);
    dbms_output.put_line(value);
  END LOOP;
  utl_http.end_response(resp);

EXCEPTION
    WHEN utl_http.end_of_body THEN
      utl_http.end_response(resp);
END;
/
======================================================


alter session set "_PUSH_JOIN_PREDICATE"=false;
alter session set "_push_join_union_view"=false;

=======================================================
This is to check policies set on the objects:
SELECT * FROM v$vpd_policy WHERE object_name = 'PX185_CHECK_HDR'

SELECT object_owner, object_name, policy, predicate
 FROM v$vpd_policy WHERE object_owner = 'VPD_PAYX_REG10_POD30' AND sql_hash = '3329342189';

SELECT s.synonym_name, b.* FROM all_objects a, all_tab_columns b, all_synonyms s  --all_dependencies b
WHERE a.owner = 'PAYX_REG10_POD31'
AND b.owner = 'PAYX_REG10_POD31'
and a.object_name = b.table_name
AND b.column_name IN ('COMPANY_CODE', 'CO_CODE')
AND s.table_owner = 'PAYX_REG10_POD31'
AND s.table_name = b.table_name


SELECT distinct b.*, a.*
from
(SELECT owner, referenced_name FROM all_dependencies WHERE owner = 'VPD_PAYX_REG17_POD31'
AND name IN ('PX185_CHK_COMBO_VW', 'PX185_CHK_VW_SUMMARY_VW', 'PX185_CHKERNHRMEMDED_VW')) a,
(SELECT --address, sql_hash, sql_id,
object_owner, object_name, policy, predicate
 FROM v$vpd_policy WHERE --object_owner = 'VPD_PAYX_REG10_POD30' AND
 --object_name = 'PX185_CHECK_HISTORY'
 sql_id = '2pxgu6gp5n03v') b
WHERE a.owner = b.object_owner (+)
  AND a.referenced_name = b.object_name (+)
oRDER BY 1


============================================================
User getting kicked out...
Client custom count:

update catclient c
   set c.client_custom_count = (select ((select count(1)
                                           from cattable
                                          where client_code = 'E503HWSE1') +
                                       (select count(1)
                                           from catcolumn
                                          where client_code = 'E503HWSE1') +
                                       (select count(1)
                                           from catrelat
                                          where client_code = 'E503HWSE1')) as tot
                                  from dual)
where client_code = 'GLADERUN';

SELECT * FROM (
SELECT c.client_code
      ,c.client_custom_count
      ,(SELECT ((SELECT COUNT(1) FROM cattable WHERE client_code = c.client_code) +
               (SELECT COUNT(1) FROM catcolumn WHERE client_code = c.client_code) +
               (SELECT COUNT(1) FROM catrelat WHERE client_code = c.client_code)) AS tot
        FROM   dual) correct_custom_count
FROM   catclient c
) WHERE client_custom_count != correct_custom_count;



connect webrepadmin@catp01
exec prc_refresh_mv_tables;


=================================================================

\\Rosepisid6017b\crushare\Deployments\ADPR.ACS.GG.BULKLOAD

UPDATE catversion c SET c.prd_loginwebservice = 'https://commonrpt.ecxml%40adpprod:92dbe449fa9c6f65b295ade88b2efb82435eb1bf@10.33.61.180/wsi', c.prd_wsfield_url = 'https://commonrpt.ecxml%40adpprod:92dbe449fa9c6f65b295ade88b2efb82435eb1bf@10.33.61.180/wsi'
WHERE prd_code ='HRB';

https://commonrpt.ecxml%40adpprod:92dbe449fa9c6f65b295ade88b2efb82435eb1bf@10.5.58.232/wsi
https://commonrpt.ecxml%40adpprod:92dbe449fa9c6f65b295ade88b2efb82435eb1bf@10.5.58.229/wsi

UPDATE catversion c SET
c.prd_loginwebservice = 'https://commonrpt.ecxml%40adpprod:92dbe449fa9c6f65b295ade88b2efb82435eb1bf@10.5.58.232/wsi',
c.prd_wsfield_url = 'https://commonrpt.ecxml%40adpprod:92dbe449fa9c6f65b295ade88b2efb82435eb1bf@10.5.58.232/wsi'
WHERE prd_code ='HRB';

===========================================
HRB listener inserts data into ws* tables.


exec prc_hrb_wsrequest('https://commonrpt.ecxml@adpprod:92dbe449fa9c6f65b295ade88b2efb82435eb1bf@172.20.93.20/wsi'
                                            , '1111005693907'
                                            , 'TABLE0'
                                            , '<IntegrationUser><AdpClientOId>02WJE6EY3C20000D</AdpClientOId><AdpAssociateOId>028XQQAZD3800062</AdpAssociateOId><IsiClientId>IATBMQSTG</IsiClientId><IsiUserId>ULAA@iATBMQSTG</IsiUserId></IntegrationUser>'
                                            , '<ReportEffectiveDates><EffectiveOnGivenDate>2011-04-18</EffectiveOnGivenDate></ReportEffectiveDates>'
                                            , 'http://172.20.17.75/ReportingBE/ws/hrb.php'
                                            , '/export/home/oracle/wallet') ;

pull this info from the wsrequest
=================================================

while getopts hsi:p:f:t:c:e: opt
do
    case $opt in
    h) usage; exit;;
    s) SILENT=1;;
    i) INST=$OPTARG;;
    p) PRD_CODE=$(echo $OPTARG | tr [a-z] [A-Z]);;
    f) CURR_VER=$OPTARG;;
    t) TO_VER=$OPTARG;;
    c) CLIENT_ID=$(echo $OPTARG | tr [a-z] [A-Z]);;
    e) SCRIPT_FILE=$OPTARG;;
    *) exit;;
    esac
done

yousayno() {
    typeset -u ans=N
    printf 'Confirm: (y/n) ? ' >& 2
    read arg < /dev/tty
    arg=$(echo $arg | cut -c1)
    case $arg in
    Y|y) return 1;;
    *) return 0;;
    esac
}

==================================================


set serveroutput on size 1000000
declare
  v varchar2(1000);
  vtab varchar2(100);
  vout number;
begin
 for i in (select tname from tab where tabtype = 'TABLE' order by 1)
 loop
  v := 'select ''' || i.tname || ''', count(1) from ' || i.tname;
  execute immediate v into vtab, vout;
  dbms_output.put_line(rpad(i.tname, 30, ' ') || ' : ' || vout);
 end loop;
end;
/

declare
  v varchar2(1000);
  vtab varchar2(100);
  vout number;
begin
 for i in (select a.table_name from user_tables a, user_tab_columns b
              where a.table_name = b.table_name and b.column_name = 'COMPANY_ID'
              and a.table_name not like 'BIN$%' order by 1)
 loop
  v := 'select ''' || i.table_name || ''', count(1) from ' || i.table_name || ' where company_id = ''' || '14943''' ;
  execute immediate v into vtab, vout;
  dbms_output.put_line(rpad(vtab, 30, ' ') || ' : ' || vout);
 end loop;
end;
/


===================================================
select a.segment_NAME, sum(a.bytes) from DBA_segments a,
DBA_indexes b, (select table_name from dzisman.adp_tables) c
where a.segment_name = b.index_name
and b.table_name = c.table_name
and b.owner = a.owner
and b.table_owner = a.owner
GROUP BY A.SEGMENT_NAME;

======================================================


nohup comp.pl 2>&1 > /dev/null &
for i in `ps -eaf | grep compt.pl | grep -v grep| awk '{print $2}'`; do echo kill -9 $i; done


create table GG_COMP_LIST
(
  prd_code      VARCHAR2(5) not null,
  gcl_key          NUMBER(15) not null,
  source_schema VARCHAR2(30) not null,
  target_schema VARCHAR2(30) not null,
  sdblink       VARCHAR2(30) not null,
  tdblink       VARCHAR2(30) not null,
  vpd_key       VARCHAR2(30) not null,
  client_code   VARCHAR2(30) not null,
)
tablespace DATA1;

alter table GG_COMP_LIST
  add constraint PK_GG_COMP_LIST primary key (GCL_KEY)
  using index tablespace INDEX1;

create sequence SEQ_GCL_KEY
minvalue 1 maxvalue 999999999999999999999999999
start with 1 increment by 1 NOCACHE CYCLE;
=========================================================


begin
  -- Call the procedure
  pkg_catalog_generator_create.prc_create_catalog(product_code => 'PAYX2',
                                                  product_version => '185',
                                                  custom_name => null,
                                                  reporting_release_csv_list => '15',
                                                  core_spec_release_number => null,
                                                  custom_spec_release_number => null,
                                                  test_catalog => null,
                                                  catalog_release_number => 'ADPR TEST1');
end;
/

====================================================
qryoptimizer queries;


SELECT crj.rel_key, DECODE(crj.crj_logoper, NULL, '['||cr.tab_code1||'].'||crj.crj_fieldname1||' = ' , crj.crj_logoper) ||
DECODE(crj.crj_logoper, NULL, '['||cr.tab_code2||'].'||crj.crj_fieldname2, NULL) j
from catrelat cr, catrelatjoin crj
WHERE cr.rel_key = crj.rel_key
AND cr.tab_code1 in (
select DISTINCT qt.tab_code from batreq b, qrytable qt
WHERE b.qry_key = qt.qry_key
  AND b.req_key = '1107795972221'
) AND cr.tab_code2 in (
select DISTINCT qt.tab_code from batreq b, qrytable qt
WHERE b.qry_key = qt.qry_key
  AND b.req_key = '1107795972221'
)
ORDER by crj.rel_key, crj.crj_order


select DISTINCT qt.tab_code, qt.qry_key from batreq b, qrytable qt
WHERE b.qry_key = qt.qry_key
  AND b.req_key = '1107795972221'



SELECT qry_key
      ,ltrim(MAX(sys_connect_by_path(tab_code, ','))
             keep(dense_rank LAST ORDER BY curr)
            ,',') AS tab_codes
FROM   (SELECT qry_key
              ,tab_code
              ,row_number() over(PARTITION BY qry_key ORDER BY qrtab_order) AS curr
              ,row_number() over(PARTITION BY qry_key ORDER BY qrtab_order) - 1 AS prev
        FROM   (SELECT DISTINCT b.req_title
                               ,qt.qrtab_key
                               ,qt.qry_key
                               ,qt.tab_code
                               ,qt.qrtab_order
                FROM   qrytable qt
                      ,(SELECT qry_key
                              ,req_title
                        FROM   batreq
                        WHERE  req_key IN ('1103631576721'
                                          ,'1105355822434'
                                          ,'1105459589726'
                                          ,'1106476259099'
                                          ,'1107592920432'
                                          ,'1107693318061'
                                          ,'1107795972221'
                                          ,'1108199699076')) b
                WHERE  qt.qry_key = b.qry_key
                ORDER  BY qt.qry_key
                         ,qt.qrtab_key
                         ,qt.qrtab_order))
GROUP  BY qry_key
CONNECT BY prev = PRIOR curr
    AND    qry_key = PRIOR qry_key
START  WITH curr = 1;

==========================================================

to run the label jobs:

-- Drop MVs
exec prc_drop_mv;

-- Enable necessary triggers
alter trigger TEXT_BATCLIENTCFG enable;
alter trigger TEXT_BATCLIENTPRD enable;

-- Clear BATCONFIG* tables Uncomment if needed.
-- delete from BATCONFIGURATION;
-- delete from BATCLIENTCONFIGURATION;
-- delete from BATCONFIGURATIONGROUP;

-- Clear client configurations
--update catclient set client_configurations = null where client_configurations is not null;

-- Run the customs
exec prc_ezlm_update_labels;
exec prc_hrb_update_labels;
exec hrbcustom.run;

-- Deploy MVs
exec prc_deploy_mv;

======================================================
--- To find client replication mismatches in payx r17

SELECT isi_client_id      "Client Code"
       ,cidn
       ,node_code          "Node"
       ,target_schema_name "Region"
FROM   (SELECT isi_client_id
              ,cidn
              ,node_code
              ,target_schema_name
              ,COUNT(1) over(PARTITION BY isi_client_id) t
              ,COUNT(1) over(PARTITION BY isi_client_id, node_code) n
              ,COUNT(1) over(PARTITION BY isi_client_id, target_schema_name) r
        FROM   adpr_client_extensions
        WHERE  isi_client_id IS NOT NULL
        AND    target_deleted_date IS NULL
        AND    replicating = 'Y'
        AND    product_version = '17'
        --and isi_client_id = 'ADP0052'
        )
WHERE  t != n
OR     t != r
ORDER  BY 1 DESC
         ,3
         ,4

======================================================


select CONTAINS_VIEWS,UNUSABLE,RESTRICTED_SYNTAX,INC_REFRESHABLE,KNOWN_STALE,INVALID,REWRITE_ENABLED,REFRESH_METHOD,LAST_REFRESH_DATE
 from user_MVIEW_ANALYSIS where MVIEW_NAME = 'MV_USERROLEAREATABLE';
N Y N N N N N FAST     2011-05-12 23:28:00

=======================================================

SELECT * FROM wsrequest WHERE req_key = '1114012400871';
SELECT * FROM wsrequest_person WHERE req_key = '1114012400871';
SELECT * FROM wsrequest_entity WHERE req_key = '1114012400871';

SELECT * FROM wsresponse_benefits_dep WHERE task_id IN (
 SELECT task_id FROM wsrequest WHERE req_key = '1114012400871');
SELECT * FROM wsresponse_benefits_emp WHERE task_id IN (
 SELECT task_id FROM wsrequest WHERE req_key = '1114012400871');
SELECT * FROM wsresponse_dependent WHERE task_id IN (
 SELECT task_id FROM wsrequest WHERE req_key = '1114012400871');
SELECT * FROM wsresponse_employee WHERE task_id IN (
 SELECT task_id FROM wsrequest WHERE req_key = '1114012400871');
SELECT * FROM wsresponse_leave WHERE task_id IN (
 SELECT task_id FROM wsrequest WHERE req_key = '1114012400871');


==========================================================

hwse mv refresh:

exec dbms_scheduler.stop_job('HWSE_ADMIN.HWSE_HOURLY_REPORT ',force=>true) ;

conn hwse_admin/hwse_admin@
SELECT DISTINCT hwse_schema_name, mv_name, refresh_error
FROM mv_refresh_log WHERE refresh_status = 'Error';



===============================================================

select REQ_KEY,REQ_PRIORITY,REQ_STATUS,REQ_TIMESTAMP,REQ_CHECKED,USER_KEY,QRY_KEY,REQ_TITLE,
REQ_ROWS,CLIENT_CODE,SCH_KEY,LIS_KEY,REQ_ACTIVE,REQ_CALL_WS,REQ_MODE,REQ_KEY_DEPENDENCY1,
REQ_KEY_DEPENDENCY2,REQ_HIDDEN,REQ_SDGMESSAGE,INST_KEY,CLIENT_ENV,CPE_KEY
from batreq where req_timestamp > trunc(sysdate)

==========================================================================
--How to pull complex queries:
select b.req_key, b.req_timestamp, b.client_code, b.req_xml, BR.RLOG_QUERY, B.REQ_ROWS, b.req_status
from (select qry_key, count(1) cnt from qrytable group by qry_key) qt, batreq b, batreqlog br
where b.qry_key = qt.qry_key and b.req_key = br.req_key and br.rlog_status = 'RUN' and b.req_status = 'OK'
and qt.cnt > 6
and b.req_timestamp > trunc(sysdate)-30
order by b.req_timestamp desc;
==========================================================================
-- Query I used to track deploy_mv progress
SELECT a.sid, a.serial#, a.sql_id, b.sql_text from v$session a, v$sql b
WHERE a.status ='ACTIVE' and a.username = 'WEBREPADMIN'
AND a.sql_id = b.sql_id AND UPPER(sql_text) LIKE 'CREATE%'
============================================================================
  Hwse new clients:
connect BASESUPER/BASESUPER@&&1
set pages 1000
col schema_user_id for a25
col appl_major_ver_id for 999

alter session set NLS_DATE_FORMAT='DD-MON-YYYY HH24:MI:SS';

spool get_new_clients.log

select schema_user_id, appl_major_ver_id version, create_dt
from admin.server_session_config s, admin.client_registry c
where s.logical_schema_id=c.logical_schema_id
and create_dt > trunc(sysdate - &&2)
order by create_dt
;

spool off

exit

================================================================

columns to rows flattenning with a comma separator:
SELECT
'MAP  #sschema.'||table_name||', TARGET #tschema.' || table_name||', KEYCOLS (' || clist ||');'
FROM (
SELECT
table_name, index_name,
  LTRIM(SYS_CONNECT_BY_PATH(column_name, ','), ',') clist
  FROM (
    SELECT a.index_name, a.table_name, a.column_name, a.column_position ,
           count(*) over(PARTITION BY a.index_name) tot
    FROM all_ind_columns a, all_indexes b where b.owner = 'PORTAL' AND b.uniqueness = 'UNIQUE'
    AND a.index_name = b.index_name
AND A.TABLE_NAME IN (
'PR_PS_PG_JOBTITLE',
'PS_PT_ADMIN_APPS',
'PS_SECURITY_ACCESS',
'PS_TS_EMPL_TLM_STATUS'
)
    ORDER BY a.index_name, a.table_name, a.column_position
  )
WHERE column_position=tot
START WITH column_position = 1
CONNECT BY PRIOR column_position = column_position -1 AND PRIOR index_name = index_name
ORDER BY 1, 2
) ORDER BY 1;

=================================================================
select * FROM webrepadmin.batreq WHERE req_key = '1116533963053';
select * FROM webrepadmin.batreqlog WHERE req_key = '1116533963053';
SELECT * FROM wsrequest WHERE req_key = '1116533963053';
SELECT * FROM wsrequest_column WHERE req_key = '1116533963053';
SELECT * FROM wsrequest_entity WHERE req_key = '1116533963053';
SELECT * FROM wsrequest_person WHERE req_key = '1116533963053';
====================================================================
-- check hrb wrong dblinks
SELECT * from (
select b.client_code,
'@CDBLINK' || decode(inst_key, 1, 'CRTP01', 2, 'CRTP02', 4, 'CRTP04', 5, 'CRTP05', 6, 'CRTP06', 20, 'CRU20P', 'UNDEF') || 'TOCRTP03' expected_dblink,
(SELECT bce.bce_dblink_value FROM batclientenvironment bce WHERE bce.client_code = b.client_code AND bce.prd_code ='HRB') actual_dblink
 FROM batclientenvironment b WHERE b.prd_code = 'PAYX2'
 AND EXISTS (SELECT 1 FROM batclientenvironment b1 WHERE b.client_code = b1.client_code AND  b1.prd_code = 'HRB')
) WHERE expected_dblink != actual_dblink;
======================================================================

-- compile all invalid objects
begin
for i in (select 'alter ' || object_type || ' ' || object_name || ' compile' cmd
from user_objects where status != 'VALID' and object_name != 'PX185_EMPLOYEE_VW' order by 1)
loop
 -- dbms_output.put_line(i.cmd);
  execute immediate i.cmd;
end loop;
end;
/


=============================================================================

update catclient orgid:

DECLARE
  vcnt NUMBER DEFAULT 0;
  bcnt NUMBER DEFAULT 0;
BEGIN
 FOR i IN (SELECT DISTINCT o.org_id, o.isiclientid FROM racs_r1.org_nonvpd o, catclient c,
                  (SELECT isiclientid FROM racs_r1.org_nonvpd GROUP BY isiclientid
                  HAVING COUNT(1)=1) b
                  WHERE o.isiclientid = b.isiclientid
                  AND c.client_code = o.isiclientid AND c.client_orgoid is NULL)
 LOOP
   vcnt := vcnt + 1;
   bcnt := mod(vcnt, 100);
   IF (bcnt=0) THEN COMMIT; end IF;
   --dbms_output.put_line('list: ' || i.org_id);
   UPDATE catclient c SET c.client_orgoid = i.org_id WHERE c.client_code = i.isiclientid;
 END LOOP;
 COMMIT;
END;
/
insert into config_pod_mapping (id)  values ('-1');
commit;



----On hwse mas pod, did this to correct missing org_oids:
SELECT * FROM CATCLIENT C WHERE C.CLIENT_ORGOID IS NULL AND EXISTS (
 SELECT 1 FROM BATCLIENTPRODUCT B WHERE B.BCP_EXTENSION_FLAG = 't' AND B.CLIENT_CODE = C.CLIENT_CODE AND B.PRD_CODE = 'BASE')

UPDATE catclient c SET c.CLIENT_ORGOID =
(select DISTINCT org_id from racs_r1.org_nonvpd@dblinkcatp01tocrtp02 x where x.isiclientid = c.client_code)
 WHERE C.CLIENT_ORGOID IS NULL AND EXISTS (
 SELECT 1 FROM BATCLIENTPRODUCT B WHERE B.BCP_EXTENSION_FLAG = 't' AND B.CLIENT_CODE = C.CLIENT_CODE AND B.PRD_CODE = 'BASE')


---- Query them and check
select c.client_code,
 'configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || c.pod_code
                    || ''',''' || bcp.bcp_extension_flag || ''', ''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''', '''||
                     c.CLIENT_ORGOID || ''')'
FROM
catclient c,
batclientproduct bcp,
batclientenvironment bce
WHERE c.pod_code = 'BENEFITS' AND
      c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code LIKE 'BASE' AND
      bcp.bcp_extension_flag = 't';

=================================================================================
ALTER TRIGGER TMV_BATCLIENTENV DISABLE;
ALTER TRIGGER TMV_BATCLIENTPROD DISABLE;
ALTER TRIGGER TMV_CATCLIENT DISABLE;
ALTER TRIGGER TSYNC_BATCLIENTPRODUCT DISABLE;
ALTER TRIGGER TSYNC_BATINSTANCE DISABLE;

--update catalog statements

exec PRC_REFRESH_MV_TABLES;
ALTER TRIGGER TMV_BATCLIENTENV ENABLE;
ALTER TRIGGER TMV_BATCLIENTPROD ENABLE;
ALTER TRIGGER TMV_CATCLIENT ENABLE;
ALTER TRIGGER TSYNC_BATCLIENTPRODUCT ENABLE;
ALTER TRIGGER TSYNC_BATINSTANCE ENABLE;
=====================================================================================

To check the rollback:
  SELECT a.sid, a.username, b.xidusn, b.used_urec, b.used_ublk
  FROM gv$session a, gv$transaction b
  WHERE a.saddr = b.ses_addr
    and a.sid = '324';

select used_urec, used_ublk from gv$transaction;

set lines 150
col status form a10
col username form a25
col start_time form a15
  SELECT a.inst_id, a.sid, a.serial#, a.username, b.xidusn, b.used_urec, 
  b.used_ublk, b.status, b.start_time, a.seq#
  FROM gv$session a, gv$transaction b
  WHERE a.saddr = b.ses_addr
  and b.used_urec > 100;
  

  select usn, state, undoblockstotal "Total", undoblocksdone "Done", undoblockstotal-undoblocksdone "ToDo",
             decode(cputime,0,'unknown',sysdate+(((undoblockstotal-undoblocksdone) / (undoblocksdone / cputime)) / 86400))
              "Estimated time to complete"
   from v$fast_start_transactions
   where state = 'RECOVERING';



select sysdate, KTUXESIZ from x$ktuxe where KTUXECFL='DEAD' and KTUXESTA='ACTIVE';
 alter session set NLS_DATE_FORMAT='DD-MON-YYYY HH24:MI:SS';
  SELECT usn
        ,state
        ,undoblockstotal "Total"
         ,undoblocksdone "Done"
         ,undoblockstotal - undoblocksdone "ToDo"
         ,decode(cputime
               ,0
               ,'unknown'
               ,SYSDATE + (((undoblockstotal - undoblocksdone) /
                (undoblocksdone / cputime)) / 86400)) "Estimated time to complete"
  FROM   v$fast_start_transactions;
========================================================================================

select * from wsrequest where wsr_dtcreate > TRUNC(SYSDATE)-5

select * from wsrequest where req_key = '1119174233995'
select * from wsrequest_person where req_key = '1119174233995';
select * from wsrequest_entity where req_key = '1119174233995';
select * from wsrequest_column where req_key = '1119174233995';

select * from wsresponse_benefits_dep
 where task_id in (select task_id from wsrequest where req_key = '1119174233995' )
select * from wsresponse_benefits_emp
where task_id in (select task_id from wsrequest where req_key = '1119174233995' )
select * from wsresponse_employee
where task_id in (select task_id from wsrequest where req_key = '1119174233995' )
select * from wsresponse_dependent
where task_id in (select task_id from wsrequest where req_key = '1119174233995' )
select * from wsresponse_leave
where task_id in (select task_id from wsrequest where req_key = '1119174233995' )

=====================================================================================

CATALOG GENERATION:


insert into spcrelease
  (spc_key
  ,prd_code
  ,ver_code
  ,spc_release
  ,spc_description)
values
  (seq_spc_key.nextval
  ,'WRKSCP'
  ,'1'
  ,1
  ,'Workscape Initial Release');


select * from spctable where spc_key = 278;
select * from spccolumn WHERE spc_key = 278;
spcrelat
select * FROM spcversion;

select * from release_vw t
Use spcresourcetale to control file access by acs resource oids.

-- to generate catalog
ssh oracle@10.95.0.6
cd /opt/oracle/home/scripts
sqlplus impl/impl@webreport
set serveroutput on size 1000000
execute pkg_catalog_generator_create.prc_create_catalog('TMS', '10', '', '124', null, null, 'f', 'ADPR01.001TMS14.300');
execute pkg_catalog_generator_create.prc_create_crossproduct('TMS','10', '124', null, null, null, null);

execute pkg_catalog_generator_create.prc_create_catalog('OBA', '8', '', '124', null, null, 'f', 'ADPR01.001OBA09.00');
execute pkg_catalog_generator_create.prc_create_crossproduct('OBA','8', '124', null, null, null, null);



VANTAGE 15.3 Catalog Package Generator scripts:
[10/8/2015 11:26 AM] Fernandes, Ismael (ESI):
call  pkg_catalog_generator_create.prc_create_catalog('HRII',
                                                  '153',
                                                  null,
                                                  '132,133',
                                                  null,
                                                  null,
                                                  null,
                                                  'ADPR01.000.HRII.15.03');

call pkg_catalog_generator_create.prc_create_resources('HRII',
                                                    '153',
                                                    null,
                                                    '132,133',
                                                    null,
                                                    'ADPR01.000.HRII.15.03');
                                                   
call pkg_catalog_generator_create.prc_create_env_param('HRII',
                                                    '153',
                                                    null,
                                                    null,
                                                    '132,133',
                                                    'ADPR01.000.HRII.15.03');
                                                  
call pkg_catalog_generator_create.prc_create_label_path('HRII',
                                                     '153',
                                                     null,
                                                     '132,133');                                                   
                                                      
call pkg_catalog_generator_r132.prc_create_custom_english('HRII',
                                                   '153',
                                                   490);
                                                  
call pkg_catalog_generator_r133.prc_create_custom_english('HRII',
                                                   '153',
                                                   490);
                                                                                                         
                                                                                                         
call pkg_catalog_generator_r133.prc_create_catbundle('HRII',
                                                   '153',
                                                   490);









insert into spccrossrelat select
3 , TAB_CODE1 ,TAB_CODE2 ,REL_LABEL1 ,REL_LABEL2 ,REL_WHERE ,REL_NAME ,REL_DEFAULT_JOIN ,
REL_SECTION ,REL_PREFERENCE ,REL_NAME_EN_NLS ,REL_NAME_ES_NLS ,REL_NAME_FR_NLS
from spcrelat where spc_key = 388
and tab_code2 like '%@@NASPOR%' and tab_code1 like '%@@OBA%';
commit;

exec pkg_catalog_generator_create.prc_create_crossproduct('OBA','8', '124', null, 'NASPORTAL', null, 'f');

exec pkg_catalog_generator_create.prc_create_crossproduct (  'OBA', '8', '124', '388', 'NASPORTAL', '3', 'f');

quit

rm oba8/*
*/
mv r124_oba8* oba8/
mv install_catalog_oba8.sh oba8/
rm -f oba8.tar oba8.tar.gz
tar cvf oba8.tar oba8/
gzip oba8.tar

cd ~/oba9/catalog
rm -f oba8.tar oba8.tar.gz
scp oracle@10.95.0.6:/opt/oracle/home/scripts/workscpae.tar .
oracle

gunzip oba8.tar.gz
tar -xvf oba8.tar
mv oba8/* .
*/
chmod +x *.sh

ksh install_catalog_oba8.sh ADPRNASR12DIT CRW01D
ksh install_catalog_oba8.sh ADPRNASR12FIT03 CRW01Q
ksh install_catalog_oba8.sh adprnasr12fit02 CRW01Q

ksh install_crossproduct_oba8.sh ADPRNASR12DIT CRW01D
ksh install_crossproduct_oba8.sh ADPRNASR12FIT03 CRW01Q
ksh install_crossproduct_oba8.sh adprnasr12fit02 CRW01Q


execute pkg_catalog_generator_create.prc_create_catalog('TSPEO', '1', '', '111', null, null, 'f', 'ADPR.01.014.TS.01.000');

execute pkg_catalog_generator_create.prc_create_catalog('TSASO', '1', '', '111', null, null, 'f', 'ADPR.01.014.TS.01.000');

execute pkg_catalog_generator_create.prc_create_catalog('TMS', '8', '', '102', null, null, 'f', 'ADPR01.004TMS08.001');

execute pkg_catalog_generator_create.prc_create_catalog('TMS', '10', '', '121,122', null, null, 'f', 'ADPR01.004TMS08.001');


exec pkg_catalog_generator_create.prc_create_catalog('WFN','5',null,'122,123',null,null,'f','ADPR05.000WFN05.00');
exec pkg_catalog_generator_create.prc_create_resources('WFN','5',null,'122,123','f','ADPR03.000WFN05.00');
exec pkg_catalog_generator_create.prc_create_env_param('WFN','5','DIT',null,'122,123','ADPR03.000WFN05.00');
exec pkg_catalog_generator_create.prc_create_env_param('WFN','5','FIT',null,'122,123','ADPR03.000WFN05.00');
exec pkg_catalog_generator_create.prc_create_env_param('WFN','5','DIT',null,'122,123','ADPR03.000WFN05.00');


prc_create_resources, and prc_create_env_param

  To clone the catalog pkg:
  exec pkg_clone_spc.prc_clone_spc_product_version('WFN', '5', 'WFN', '5', 'WFN5 Iteration 3', (SELECT spc_key FROM release_vw WHERE prd_code = 'WFN' AND ver_code = '5'));

  exec pkg_clone_spc.prc_clone_spc_product_version('WFN', '5', 'WFN', '5', 'WFN5 Iteration 3', 327);


  DECLARE
  P_PRD_CODE_FROM VARCHAR2(200);
  P_PRD_VERSION_FROM VARCHAR2(200);
  P_PRD_CODE_TO VARCHAR2(200);
  P_PRD_VERSION_TO VARCHAR2(200);
  P_DESCRIPTION VARCHAR2(200);
  P_SPC_KEY_FROM NUMBER;
BEGIN
  P_PRD_CODE_FROM := 'HRII';
  P_PRD_VERSION_FROM := '153';
  P_PRD_CODE_TO := 'HRII';
  P_PRD_VERSION_TO := '153';
  P_DESCRIPTION := 'Cloned from SPC_KEY = 485 to include NG related changes';
  P_SPC_KEY_FROM := 485;

  PKG_CLONE_SPC.PRC_CLONE_SPC_PRODUCT_VERSION(
    P_PRD_CODE_FROM => P_PRD_CODE_FROM,
    P_PRD_VERSION_FROM => P_PRD_VERSION_FROM,
    P_PRD_CODE_TO => P_PRD_CODE_TO,
    P_PRD_VERSION_TO => P_PRD_VERSION_TO,
    P_DESCRIPTION => P_DESCRIPTION,
    P_SPC_KEY_FROM => P_SPC_KEY_FROM
  );
END;



ssh oracle@10.95.0.6
password: oracle
cd /opt/oracle/home/scripts

pkg_catalog_generator_create.prc_create_mig_data(‘WFN’, ‘4’, 16, null, ‘PKGCLIMIG’, ‘ADPR.01.000.WFN4TOWFN4.12.000’);

pkg_catalog_generator_create.prc_create_mig_data(pprdcodetarget => :pprdcodetarget,
                                                   pvercodetarget => :pvercodetarget,
                                                   pmigkey => :pmigkey,
                                                   pspckey => :pspckey,
                                                   pscriptcode => :pscriptcode,
                                                   pscriptversion => :pscriptversion);

mig_key come from our migration spec
here are the tables we have on impl schema...
spcmig
spcmigmappings
spcmigjoinorder
spcmigmapcalcfieldsel
select * from vw_adpr_properties where 1=1
 and resource_key like 'adpr.EmployeeJobHistory.CPD_JOB_HISTORY%'

adpr.EmployeeBasicInfo.CPD_PERSON.HOURLY_IND.HourlyInd   ->               adpr.EmployeeBasicInfo.CPD_PERSON.RATE_TYPE_CODE.RateType
adpr.EmployeeBasicInfo.CPD_PERSON.HOURLY_RATE.HourlyRate  ->              adpr.EmployeeBasicInfo.CPD_PERSON.PAY_RATE.PayRate
adpr.EmployeeBasicInfo.CPD_PERSON.REF_HOURLY_RATE.RefrenceHourlyRate  ->  adpr.EmployeeBasicInfo.CPD_PERSON.REF_PAY_RATE.RefrencePayRate


adpr.EmployeeBasicInfo.CPD_PERSON.HOURLY_IND.HourlyInd   ->
adpr.EmployeeBasicInfo.CPD_PERSON.HOURLY_RATE.HourlyRate  ->
adpr.EmployeeBasicInfo.CPD_PERSON.REF_HOURLY_RATE.RefrenceHourlyRate  ->

adpr.EmployeeJobHistory.CPD_JOB_HISTORY.HOURLY_IND.HourlyIndicator  ->
adpr.EmployeeJobHistory.CPD_JOB_HISTORY.HOURLY_RATE.HourlyRate  ->



select distinct 'exec prc_delete_qryquery(''' || qry_key || ''');'
from TMP_INSTALLATION_ERRORS order by 1;

exec prc_delete_qryquery('1125102018423');

delete from ADTREQVIEW where req_key in (
select req_key from batreq where qry_key in (select qry_key from TMP_INSTALLATION_ERRORS));


DELETE FROM secrolecol WHERE tab_code like 'PEO_EMP_DATA@@TSPEO@@1' AND COL_CODE = 'EMPL_STATUS'
DELETE FROM qryfilterel WHERE tab_code like 'PEO_EMP_DATA@@TSPEO@@1' AND COL_CODE = 'EMPL_STATUS'

select /*qq.qry_key
     , qq.qry_name
     , qq.qry_active
     , qq.qry_status
     , qq.user_key
     , (select su.user_login from secuser su where su.user_key = qq.user_key) user_login
     , qq.client_code*/
      'call prc_delete_qryquery(''' || qq.qry_key || ''');' del_rpt_cmd
  from qryquery qq
where qry_key in ( select qt.qry_key
                      from qrytable qt, qryfield qf
                      where qt.qry_key = qf.qry_key
                        and qt.tab_code = 'COMPETENCY_EVAL@@TMS@@8'
                        and qf.col_code = 'CALC_RATING_ID'
                    )
order by qq.qry_name
        , qq.qry_status;


-----------------------------------------

select sysdate, KTUXESIZ from x$ktuxe where KTUXECFL='DEAD' and KTUXESTA='ACTIVE';
 alter session set NLS_DATE_FORMAT='DD-MON-YYYY HH24:MI:SS';
  SELECT usn
        ,state
        ,undoblockstotal "Total"
         ,undoblocksdone "Done"
         ,undoblockstotal - undoblocksdone "ToDo"
         ,decode(cputime
               ,0
               ,'unknown'
               ,SYSDATE + (((undoblockstotal - undoblocksdone) /
                (undoblocksdone / cputime)) / 86400)) "Estimated time to complete"
  FROM   v$fast_start_transactions;

  SELECT b.inst_key,
         c.pod_code,
         b.req_key,
         q.qry_name,
         qt.tab_code,
         ss.user_login
    FROM qryquery q,
         qrytable qt,
         batreq b,
         secuser ss,
         catclient c
   WHERE     q.qry_datetime > TRUNC (SYSDATE) - 7
         AND q.qry_key = qt.qry_key
         AND qt.tab_code LIKE '%25'
         AND b.qry_key = q.qry_key
         AND b.req_rows > 0
         AND q.user_key = ss.user_key
         AND c.client_code = q.client_code
         AND (qt.tab_code LIKE 'BENEFITS_EMPLOYEE_INFO%'
         OR qt.tab_code LIKE 'WORK_TIME_OFF_IN%')
ORDER BY 1, 2, 3

SELECT * from (
select b.client_code,
'@CDBLINK' || decode(inst_key, 1, 'CRTP01', 2, 'CRTP02', 4, 'CRTP04', 5, 'CRTP05', 6, 'CRTP06', 20, 'CRU20P', 'UNDEF') || 'TOCRTP03' expected_dblink,
(SELECT bce.bce_dblink_value FROM batclientenvironment bce WHERE bce.client_code = b.client_code AND bce.prd_code ='HRB') actual_dblink
 FROM batclientenvironment b WHERE b.prd_code = 'PAYX2'
 AND EXISTS (SELECT 1 FROM batclientenvironment b1 WHERE b.client_code = b1.client_code AND  b1.prd_code = 'HRB')
) WHERE expected_dblink != actual_dblink;







SQL> SELECT extract(YEAR FROM b.session_timestamp), Count(1)
  2  --, a.session_id, a.val_value
  3  from secsessionval a, secsession b WHERE
  4  a.val_name = 'HTTP_CODES'
  5  AND
  6  a.val_value LIKE '%|iPayAdmin'
  7  AND a.SESSION_id = b.session_id
  8  GROUP BY extract(YEAR FROM b.session_timestamp);

                                2008                                   6
                                2009                                   7
                                2010                                1736
                                2011                               20836
====================================


Clients having reports and sor at one location and catalog pointing differently:

SELECT 'configure_client(''' || client_code || ''', ''' || TO_NUMBER(NODE_CODE) ||
''', '''', ''t'',''' ||
'_' || SUBSTR(TARGET_SCHEMA_NAME, 9, 2) || SUBSTR(TARGET_SCHEMA_NAME, 15, 2) || ''', ''PAYX2'', ''17'');'
FROM (
SELECT DISTINCT
bcp.client_code, bcp.ver_code, sor.product_version, SOR.NODE_CODE, SOR.TARGET_SCHEMA_NAME,
substr(qt.tab_code, instr(qt.tab_code, '@@', 2)) repprd
 FROM
catclient c,
batclientproduct bcp, ggate.adpr_client_extensions@dblinkcatp01tocrtp01 sor,
qryquery q, qrytable qt
 WHERE bcp.prd_code = 'PAYX2'
AND c.client_code = bcp.client_code
AND bcp.client_code = sor.isi_client_id
AND bcp.prd_code = sor.product_code
AND bcp.ver_code != sor.product_version
AND q.qry_key = qt.qry_key
AND q.client_code = c.client_code
AND c.pod_code = 'PROD'
AND substr(qt.tab_code, instr(qt.tab_code, '@@', 2)) LIKE '%@@PAYX2@@17'
AND substr(qt.tab_code, LENGTH(qt.tab_code)-1) != bcp.ver_code
ORDER BY 1,2
)
========================================

URLS:
Environment
PRODUCTION
NAS
NAS Payroll PILOT - https://adpreporter1.adp.com
NAS Payroll GA - https://adpreporter.adp.com
NAS Payroll GA DC2 - https://adpreporting1.us.adp.com
MAS
MAS PILOT - https://reporting1.adp.com
MAS GA - https://reporting.adp.com
MAS RW - https://reporting.adp.com/rw
HWSE
HWSE LIVE -  https://reporting.adp.com/benefits


IAT (DC)
PILOT MAS -  https://stgreporting1.adp.com
PROD MAS - https://stgreporting.adp.com
Benefits (HWSE) -  https://stgreporting.adp.com/benefits
IAT (AA)
PILOT NAS - https://adpreportingstag1.adp.com
GA NAS - https://adpreportingstag.adp.com

FIT (Roseland)
MAS FIT (HRB) - https://1hrcrtqa.adp.com/hrb/
MAS FIT (WEBREP) - https://1hrcrtqa.adp.com/webreppilot
FIT (AA)
NAS FIT (PILOT) - https://adpreporterqa.adp.com/pilot


-----------------------------------------------------------

CREATE OR REPLACE PROCEDURE "DBADM"."CR_SET_SCHEMA_CONTEXT"
  (isi_client_oid IN VARCHAR2,
   operator_id IN VARCHAR2)
  AUTHID CURRENT_USER
AS
schema_name VARCHAR2(30);
BEGIN
DECLARE
    sql_stmt VARCHAR2(254);
    schema_role VARCHAR2(60);
    oper_comp_ind CHAR(1);
BEGIN
    sql_stmt := 'SELECT OWNERID FROM PS.PSDBOWNER WHERE CLIENT_OID = :1' ;
    EXECUTE IMMEDIATE sql_stmt INTO schema_name USING isi_client_oid;
    schema_role := schema_name || '_ROLE' ;
    sql_stmt := 'SELECT RPTACCESS FROM ' || schema_name || '.PSOPRDEFN WHERE
     OPRID '||'||'||' '||'''_'''||' '||'||'||' ''' || schema_name ||''' = :2';
    EXECUTE IMMEDIATE sql_stmt INTO oper_comp_ind USING operator_id;
    SYS.DBMS_SESSION.SET_CONTEXT('adpreporter', 'oper_comp_ind', oper_comp_ind);

    EXECUTE IMMEDIATE 'ALTER SESSION SET CURRENT_SCHEMA = ' || schema_name ||''
;
    SYS.DBMS_SESSION.SET_ROLE('NONE');
    SYS.DBMS_SESSION.SET_ROLE(schema_role);
END;
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    dbms_output.put_line('Unable to set the schema context for the Client ID');
   NULL; -- Client OID and/or operator ID not found.
END;


E503T1
G449B7XCHWF0001R
E503T1_ROLE
------------------------------------------------------------
NAS MV REFRESH ENABLING TRACE

The next time we perform a complete refresh I would like to have a trace collected on the session performing the refresh.  Here are the steps to setup the trace:

1.	Have a DBA run the following grant for the user that will execute the refresh command
Grant execute on dbms_monitor to theUserThatRunsTheRefresh;
2.	Connect as the user that will run the refresh and run the following:
alter session set timed_Statistics=TRUE;
alter session set statistics_level=ALL;
alter session set max_dump_file_size=UNLIMITED;
alter session set tracefile_identifier=MVREFRESH;
exec dbms_monitor.session_trace_enable(null,null,true,true);
select * from dual;
                                               exit;
Those last two items are to ensure the cursors all close out properly.
Thanks,

call ts_peo_sec_context.set_app_context('MHOLTRY5159@EZV', 'ER', 'G2ZGBPRKWDG0004H', 'G2ATYR3E2MQ00001');


------------------------------------------------------

impldb:

For multiple ER roles (practitioner, manager etc.) there are multiple secrolekeys. To generated them in the catalog, we need to do 2 steps:
1.
  update spcrelease sr set sr.use_acs_roles = 't' where sr.spc_key = 259;
  commit
2.
insert into SPCSECROLES (SPC_KEY, ROLE_KEY, ROLE_NAME, ROLE_DESC, ACS_GROUP_TYPE_NAME, ACS_GROUP_TYPE_OID, ACS_GROUP_TYPE_ORDER)
values (260, -1, 'ALL', 'ALL ROLES', '', null, null);

insert into SPCSECROLES (SPC_KEY, ROLE_KEY, ROLE_NAME, ROLE_DESC, ACS_GROUP_TYPE_NAME, ACS_GROUP_TYPE_OID, ACS_GROUP_TYPE_ORDER)
values (260, null, 'ER', 'PRACTITIONER', 'practitioner', 3, 1);

insert into SPCSECROLES (SPC_KEY, ROLE_KEY, ROLE_NAME, ROLE_DESC, ACS_GROUP_TYPE_NAME, ACS_GROUP_TYPE_OID, ACS_GROUP_TYPE_ORDER)
values (260, null, 'ER', 'MANAGER', 'manager', 2, 2);

insert into SPCSECROLES (SPC_KEY, ROLE_KEY, ROLE_NAME, ROLE_DESC, ACS_GROUP_TYPE_NAME, ACS_GROUP_TYPE_OID, ACS_GROUP_TYPE_ORDER)
values (260, null, 'ER', 'SUPERVISOR', 'supervisor', 4, 3);



For R11, priorities are added to tables:
1. set the priority of the files
  UPDATE spctable SET tab_preference = 2 WHERE tab_code like '%TS%@@1' AND spc_key IN ('259', '260')
  UPDATE spctable SET tab_preference = 1 WHERE tab_code = 'ASO_EMP_DATA@@TSASO@@1' AND spc_key IN ('259', '260')

2. Set the following relationships to  catrelat.rel_preference = ‘99’
  select * from catrelat where tab_code1 = tab_code2 and tab_code1 like '%TS%@@1'
  (there should be 2 entries where ‘employment data’ is connected to ‘employment data’ which is for migration, but should not be used by join engine, therefore gets a priority of ‘99’)

-------------------------------------------

In step 3, 'Create or Edit Coded Amounts' button will show the entries from catcolumncoded table
for the selected files.
The select codes will be populated by the query in:

catcolumn.colcodesquery against the ADDITIONAL_EARNINGS_CODE column.

---------------------------------------------------
Where is the payx client?

select 'select ''' || owner || ''', count(1) from ' || owner ||
       '.SECURITY_USER where upper(user_id) like ''%IATAMD'';'
from all_objects where object_name = 'SECURITY_USER';



-----------------------------------------
SELECT
'v_Return := isiWSInterface.addClientResourceGroup( '''|| client_code || ''', NULL, ''http://10.1.129.223/services/jaxws/ISIJWSClientService'', ''CRT'', ''ADPR'', ''ADPRPOD03'');' || CHR(10) || 'dbms_output.put_line(''' || client_code || ':'' || v_return); '
FROM
batclientproduct where client_code not in ('ADPADMIN', 'CSRADMIN')
and prd_code = 'NASPORTAL' order by 1;

---------------------------------------------------------
totalsource iat is in DC1.
ADPR GG is in DC1.  172.20
dc2: 172.24.....

============================================================
-- Generate batinstance entries:
select 'insert into batinstance
(INST_KEY'|| chr(10) || ',INST_SID'|| chr(10) || ',INST_DESC'|| chr(10) || ',INST_USER'|| chr(10) ||
',INST_PASSWORD'|| chr(10) || ',INST_HOST'|| chr(10) || ',INST_PORT'|| chr(10) || ',INST_WEBSERVICEURL'|| chr(10) ||
',INST_MAXREQ'|| chr(10) || ',INST_TNS_RAC'|| chr(10) || ',INST_SHORTNAME'|| chr(10) ||
',INST_WALLET_DIR) values (' || chr(10) || '''' || INST_KEY || ''''|| chr(10) || ',''' || INST_SID ||
''''|| chr(10) || ',''' || INST_DESC || ''''|| chr(10) || ',''' || INST_USER || ''''|| chr(10) || ',''' ||
INST_PASSWORD || ''''|| chr(10) || ',''' || INST_HOST || ''''|| chr(10) || ','''
|| INST_PORT || ''''|| chr(10) || ',''' || INST_WEBSERVICEURL || ''''|| chr(10) || ',''' ||
INST_MAXREQ || ''''|| chr(10) || ',''' || INST_TNS_RAC || ''''|| chr(10) || ',''' ||
INST_SHORTNAME || ''''|| chr(10) || ',''' || INST_WALLET_DIR || ''');'
 from batinstance where inst_key = 13;

insert into batinstance
(INST_KEY
,INST_SID
,INST_DESC
,INST_USER
,INST_PASSWORD
,INST_HOST
,INST_PORT
,INST_MAXREQ
,INST_TNS_RAC
,INST_SHORTNAME
,INST_WALLET_DIR) values (
'16','WSI01D', 'TMS WSI01D Box', 'cruvpd', 'f18fe820fc2947cacd3ccb020e98fed2', '', '1521', '25',
'(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=yes)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=cdlpff006db-scan.nj.adp.com)(PORT=1521)))(CONNECT_DATA=(service_name=wsi01d_svc1)))',
'',''
);
commit;

select
'INST_KEY           :' || inst_key ||  CHR(10)||
'INST_SID           :' || INST_SID ||  CHR(10)||
'INST_DESC          :' || INST_DESC ||  CHR(10)||
'INST_USER          :' || INST_USER ||  CHR(10)||
'INST_PASSWORD      :' || INST_PASSWORD ||  CHR(10)||
'INST_HOST          :' || INST_HOST ||  CHR(10)||
'INST_PORT          :' || INST_PORT ||  CHR(10)||
'INST_WEBSERVICEURL :' || INST_WEBSERVICEURL ||  CHR(10)||
'INST_MAXREQ        :' || INST_MAXREQ ||  CHR(10)||
'INST_TNS_RAC       :' || INST_TNS_RAC ||  CHR(10)||
'INST_SHORTNAME     :' || INST_SHORTNAME ||  CHR(10)||
'INST_WALLET_DIR    :' || INST_WALLET_DIR
from batinstance
where INST_KEY IN (102);

where inst_shortname = 'AE8P';






select
'POD_CODE             :' || POD_CODE ||  CHR(10)||
'POD_URL              :' || POD_URL ||  CHR(10)||
'POD_CURRENT          :' || POD_CURRENT ||  CHR(10)||
'POD_ACCESS_TYPE      :' || POD_ACCESS_TYPE ||  CHR(10)||
'POD_ACCESS_CODE      :' || POD_ACCESS_CODE ||  CHR(10)||
'POD_BE_URL           :' || POD_BE_URL ||  CHR(10)
from batpod;



SELECT
'VER_CODE                        : ' || VER_CODE                       || chr(10) ||
'PRD_CODE                        : ' || PRD_CODE                       || chr(10) ||
'PRD_PROCEDURE                   : ' || PRD_PROCEDURE                  || chr(10) ||
'PRD_LOGINWEBSERVICE             : ' || PRD_LOGINWEBSERVICE            || chr(10) ||
'PRD_WEBSERVICETIMEOUT           : ' || PRD_WEBSERVICETIMEOUT          || chr(10) ||
'VER_ONLYROOTWHERE               : ' || VER_ONLYROOTWHERE              || chr(10) ||
'PRD_DYNAMIC_JOINS               : ' || PRD_DYNAMIC_JOINS              || chr(10) ||
'PRD_DERIVED_COND                : ' || PRD_DERIVED_COND               || chr(10) ||
'PRD_SQL_NGS                     : ' || PRD_SQL_NGS                    || chr(10) ||
'PRD_DATAGROUPING                : ' || PRD_DATAGROUPING               || chr(10) ||
'PRD_1904EXCELSYSTEM             : ' || PRD_1904EXCELSYSTEM            || chr(10) ||
'PRD_XPRD_FILTERS                : ' || PRD_XPRD_FILTERS               || chr(10) ||
'PRD_DERIVEDNUMERICAGGFUNCT      : ' || PRD_DERIVEDNUMERICAGGFUNCT     || chr(10) ||
--'PRD_DIRECTDOWNLOAD              : ' || PRD_DIRECTDOWNLOAD             || chr(10) ||
'PRD_WEBSERVICEVERSION           : ' || PRD_WEBSERVICEVERSION          || chr(10) ||
'PRD_NESTEDCONDITIONALS          : ' || PRD_NESTEDCONDITIONALS         || chr(10) ||
'VER_LABEL                       : ' || VER_LABEL                      || chr(10) ||
'PRD_WSFIELD_URL                 : ' || PRD_WSFIELD_URL                || chr(10) ||
'PRD_SENSITIVEWARNING            : ' || PRD_SENSITIVEWARNING           || chr(10) ||
'PRD_EFFDATECONSOLIDATEDUI       : ' || PRD_EFFDATECONSOLIDATEDUI      || chr(10) ||
'PRD_SHOWCODESDROPDOWN           : ' || PRD_SHOWCODESDROPDOWN          || chr(10) ||
'PRD_HAS_MULTIPLE_ENVIRONMENT    : ' || PRD_HAS_MULTIPLE_ENVIRONMENT   || chr(10) ||
'PRD_MULTIENVIRONMENT_URL        : ' || PRD_MULTIENVIRONMENT_URL       || chr(10)
--'PRD_USE_ACS_INTEGRATION         : ' || PRD_USE_ACS_INTEGRATION        || chr(10) ||
--'PRD_USE_MC                      : ' || PRD_USE_MC                     || chr(10)
--'PRD_USE_CMS_INTEGRATION         : ' || PRD_USE_CMS_INTEGRATION        || chr(10)
FROM CATVERSION
WHERE PRD_CODE = 'HRB'; and VER_CODE = '502';


SELECT
'CLIENT_CODE                     : ' || CLIENT_CODE                    || chr(10) ||
'POD_CODE                        : ' || POD_CODE                       || chr(10) ||
'CLIENT_MAXREQ                   : ' || CLIENT_MAXREQ                  || chr(10) ||
--'CLIENT_CUSTOM_COUNT             : ' || CLIENT_CUSTOM_COUNT            || chr(10) ||
--'CLIENT_TABLE_EXTENSIONS         : ' || CLIENT_TABLE_EXTENSIONS        || chr(10) ||
'CLIENT_ORGOID                   : ' || CLIENT_ORGOID                  || chr(10) ||
'CLIENT_REGION_CODE              : ' || CLIENT_REGION_CODE             || chr(10) ||
--'CLIENT_CONFIGURATIONS           : ' || CLIENT_CONFIGURATIONS          || chr(10) ||
'CLIENT_LOGIN_SCHEMA             : ' || CLIENT_LOGIN_SCHEMA            || chr(10)  ||
'CLIENT_LOGO_FILE_EXT            : ' || CLIENT_LOGO_FILE_EXT           || chr(10)  ||
'CLIENT_ACTIVE                   : ' || CLIENT_ACTIVE                  || chr(10) ||
'CLIENT_UNDERMAINTENANCE         : ' || CLIENT_UNDERMAINTENANCE        || chr(10) ||
'ORG_NAME                        : ' || ORG_NAME                       || chr(10)
FROM catclient
WHERE CLIENT_CODE ='17JULFIT02';


SELECT
'CLIENT_CODE                     : ' || CLIENT_CODE                    || chr(10) ||
'POD_CODE                        : ' || POD_CODE                       || chr(10) ||
'CLIENT_MAXREQ                   : ' || CLIENT_MAXREQ                  || chr(10) ||
'CLIENT_CUSTOM_COUNT             : ' || CLIENT_CUSTOM_COUNT            || chr(10) ||
'CLIENT_TABLE_EXTENSIONS         : ' || CLIENT_TABLE_EXTENSIONS        || chr(10) ||
'CLIENT_ORGOID                   : ' || CLIENT_ORGOID                  || chr(10) ||
'CLIENT_REGION_CODE              : ' || CLIENT_REGION_CODE             || chr(10) ||
'CLIENT_CONFIGURATIONS           : ' || CLIENT_CONFIGURATIONS          || chr(10) ||
'CLIENT_LOGIN_SCHEMA             : ' || CLIENT_LOGIN_SCHEMA            || chr(10)  ||
'CLIENT_LOGO_FILE_EXT            : ' || CLIENT_LOGO_FILE_EXT           || chr(10)  ||
'CLIENT_ACTIVE                   : ' || CLIENT_ACTIVE                  || chr(10)
--'CLIENT_UNDERMAINTENANCE         : ' || CLIENT_UNDERMAINTENANCE        || chr(10) ||
--'ORG_NAME                        : ' || ORG_NAME                       || chr(10)
FROM catclient
WHERE CLIENT_CODE ='17JULFIT02';

EXEC configure_client('PEO516', p_node => '6', p_pod => 'WFN_FIT', p_extn_fl => 'f', p_extn => NULL, p_prd => 'TSPEO', p_ver => '1', p_dblink_fl => 'f', p_dblink => NULL, p_CLIENT_ORGOID => 'G3FG4EWPZT2C0R25');


SELECT
'CLIENT_CODE                     : ' || CLIENT_CODE                    || chr(10) ||
'PRD_CODE                        : ' || PRD_CODE                       || chr(10) ||
'VER_CODE                        : ' || VER_CODE                       || chr(10) ||
'BCP_GRANT_ALL_USERS             : ' || BCP_GRANT_ALL_USERS            || chr(10) ||
'BCP_EXTENSION_FLAG              : ' || BCP_EXTENSION_FLAG             || chr(10) ||
'BCP_EXTENSION_VALUE             : ' || BCP_EXTENSION_VALUE            || chr(10) ||
'BCP_PRIORITY                    : ' || BCP_PRIORITY                   || chr(10)
FROM batclientproduct
WHERE
CLIENT_CODE ='ADPR01';



SELECT
'BCE_KEY                         : ' || BCE_KEY                        || chr(10) ||
'CLIENT_CODE                     : ' || CLIENT_CODE                    || chr(10) ||
'PRD_CODE                        : ' || PRD_CODE                       || chr(10) ||
'INST_KEY                        : ' || INST_KEY                       || chr(10) ||
'CPE_KEY                         : ' || CPE_KEY                        || chr(10) ||
'BCE_DBLINK_FLAG                 : ' || BCE_DBLINK_FLAG                || chr(10) ||
'BCE_DBLINK_VALUE                : ' || BCE_DBLINK_VALUE               || chr(10) ||
'BCE_SCHEMA                      : ' || BCE_SCHEMA                     || chr(10)
FROM batclientenvironment
WHERE
CLIENT_CODE ='ADPR01';

insert into batclientenvironment values
(seq_bce_key.nextval, 'IATCOPART', 'BASE', 112, 2, 'f', '', 'IATCOPARTCTEST');


SELECT
'CPE_KEY                         : ' || CPE_KEY                        || chr(10) ||
'CPE_ENVIRONMENT                 : ' || CPE_ENVIRONMENT                || chr(10) ||
'PRD_CODE                        : ' || PRD_CODE                       || chr(10) ||
'VER_CODE                        : ' || VER_CODE                       || chr(10) ||
'CPE_LABEL                       : ' || CPE_LABEL                      || chr(10) ||
'CPE_ORDER                       : ' || CPE_ORDER                      || chr(10)
FROM catenvironment;

========================================

EXEC configure_client('CAPROCK', '103', 'WEBPILOT', 't', '_0230', 'PAYX2', '185', 'f', '')
EXEC configure_client('E503T', '12', 'NEWPILOT', 'f', '', 'NASPORTAL', '502', 'f', '');
EXEC configure_client('QN13FIT2', '115', 'HRII_FIT', 'f', '', 'HRII', '101', 'f', '');
EXEC configure_client('ALLCLEAN', '3', 'WFN_FIT', 't', '_0002', 'WFN', '3', 'f', '');

============================================


==============================================

\[\033[1;30m\] - Sets the color for the characters that follow it. Here 1;30 will set them to Dark Gray.
\u \h \W \$ - Look to the table above
\[\033[0m\] - Sets the colours back to how they were originally.

Black       0;30     Dark Gray     1;30
Blue        0;34     Light Blue    1;34
Green       0;32     Light Green   1;32
Cyan        0;36     Light Cyan    1;36
Red         0;31     Light Red     1;31
Purple      0;35     Light Purple  1;35
Brown       0;33     Yellow        1;33
Light Gray  0;37     White         1;37


-----------------------------------------------------

Clients in WRS vs CDC:
-- 7866
SELECT  DISTINCT A.CLIENT_CODE, b.ooid, b.company_id
 FROM batclientenvironment A, HRB_R25.COMPANY_AUTH@DBLINKCATP01TOCRTP03 B,
(SELECT DISTINCT UPPER(O) O, CLIENTOID FROM APPADM.ISICLIENT@DBLINKCATP01TOCRTP01) C
 where A.prd_code ='HRB'
 AND A.CLIENT_CODE = C.O
 AND B.OOID = C.CLIENTOID
 AND b.ooid is NOt NULL
 ORDER BY 3


-- 337
SELECT DISTINCT A.CLIENT_CODE, b.ooid, b.company_id FROM batclientenvironment A,
HRB_REG0001.COMPANY_AUTH@DBLINKCATP01TOCRH01P B,
(SELECT DISTINCT UPPER(O) O, CLIENTOID FROM APPADM.ISICLIENT@DBLINKCATP01TOCRTP01) C
 where A.prd_code ='HRB'
 AND A.CLIENT_CODE = C.O
 AND B.OOID = C.CLIENTOID
 AND b.ooid is NOT NULL
 ORDER BY 3

 ---------------------------------------------------------


select 'exec configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || 'WFN_PROD' --c.pod_code
                    || ''', ''' || bcp.bcp_extension_flag || ''',''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''');'
FROM
catclient c,
batclientproduct bcp,
batclientenvironment bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code and
      c.client_code = 'METGLASIAT'
AND C.CLIENT_CODE IN ( ) order by 1;


==========================================================

  for x in ( select count(*) cnt
               from dual
              where exists ( select NULL from foo where bar ) )
  loop
        if ( x.cnt = 1 )
        then
          found do something
        else
          not found
        end if;
  end loop;
----------------------------------------------------------------

resource groups

set serveroutput on
exec isiwsinterfacetest.getclientresourcegroups('WFN3FIT148');

exec isiwsinterfacetest.deleteclientresourcegroup('PEOMGZ', 'ADPRPROD02');

exec isiwsinterfacetest.ADDclientresourcegroup('PEOMGZ', 'ADPRPROD02');
COMMIT;

===================================================================

initial load:
DELETE FROM client_config_cmds WHERE prd_code = 'WFN';
INSERT INTO client_config_cmds
select 'WFN', c.client_code,
 'configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || c.pod_code
                    || ''',''' || bcp.bcp_extension_flag || ''', ''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''', '''||
                     c.CLIENT_ORGOID || ''')', '', '0'
FROM
webrepadmin.catclient@dblinkcrtp01tocrc02p c,
webrepadmin.batclientproduct@dblinkcrtp01tocrc02p bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocrc02p bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code LIKE 'WFN%'
      ORDER BY 1;
COMMIT;
DELETE FROM client_config_cmds WHERE prd_code = 'HRB';
INSERT INTO client_config_cmds
select 'HRB', c.client_code,
 'configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || c.pod_code
                    || ''',''' || bcp.bcp_extension_flag || ''', ''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''', '''||
                     c.CLIENT_ORGOID || ''')', '', '0'
FROM
webrepadmin.catclient@dblinkcrtp01tocatp01 c,
webrepadmin.batclientproduct@dblinkcrtp01tocatp01 bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocatp01 bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code LIKE 'HRB'
      ORDER BY 1;
COMMIT;



  SINGLE URL COMMANDS:
  ====================


     ----First time loading command:
DELETE FROM prev_client_config_cmds WHERE prd_code = 'PAYX2';
INSERT INTO prev_client_config_cmds
select 'PAYX2', c.client_code,
 'configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || c.pod_code
                    || ''',''' || bcp.bcp_extension_flag || ''', ''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''', '''||
                     c.CLIENT_ORGOID || ''')', '', '0'
FROM
webrepadmin.catclient@dblinkcrtp01tocrc02p c,
webrepadmin.batclientproduct@dblinkcrtp01tocrc02p bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocrc02p bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code LIKE 'PAYX2'
      ORDER BY 1;
COMMIT;

INSERT INTO prev_client_config_cmds
select 'PAYX2', c.client_code,
 'configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || c.pod_code
                    || ''',''' || bcp.bcp_extension_flag || ''', ''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''', '''||
                     c.CLIENT_ORGOID || ''')', '', '0'
FROM
webrepadmin.catclient@dblinkcrtp01tocatp01 c,
webrepadmin.batclientproduct@dblinkcrtp01tocatp01 bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocatp01 bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code LIKE 'PAYX2'
      ORDER BY 1;
COMMIT;

DELETE FROM prev_client_config_cmds
WHERE rowid IN (
SELECT rowid
FROM prev_client_config_cmds WHERE prd_code = 'PAYX2'
MINUS
SELECT MAX(rowid)
FROM prev_client_config_cmds WHERE prd_code = 'PAYX2'
GROUP BY clnt, prd_code, cmd
);
COMMIT;


            ---- first time loading command ends






-- Changes to existing client configurations.
select * from (
select clnt, prd_code, cmd FROM client_config_cmds
MINUS
select clnt, prd_code, cmd FROM prev_client_config_cmds
) a WHERE EXISTS (SELECT 1 FROM
  prev_client_config_cmds b WHERE
  a.clnt = b.clnt AND
  a.prd_code = b.prd_code;

-- Changes to new client configurations.
select * from (
select clnt, prd_code, cmd FROM client_config_cmds
MINUS
select clnt, prd_code, cmd FROM prev_client_config_cmds
) a WHERE NOT EXISTS (SELECT 1 FROM
  prev_client_config_cmds b WHERE
  a.clnt = b.clnt AND
  a.prd_code = b.prd_code;


-- CHECK FOR A CLIENT
select 'configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || c.pod_code
                    || ''',''' || bcp.bcp_extension_flag || ''', ''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''', '''||
                     c.CLIENT_ORGOID || ''')'
FROM
webrepadmin.catclient@dblinkcrtp01tocatp01 c,
webrepadmin.batclientproduct@dblinkcrtp01tocatp01 bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocatp01 bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      --bcp.prd_code = 'EZLM' AND ROWNUM < 10
      c.client_code = 'THEHEARTGR'
UNION
select CMD  FROM  client_config_cmds WHERE clnt = 'THEHEARTGR';


-- UPDATE SINGLE CLIENT
SELECT * FROM client_config_cmds WHERE clnt = 'TAYLORPR';
DELETE FROM client_config_cmds WHERE clnt = 'TAYLORPR';
COMMIT;
exec configure_isi_client.populate_client_config_cmds('G37A054N1094EVQR', '0');

-- reload single client
#!/usr/bin/ksh
if [ $# -lt 2 ]; then
  echo "Usage: `basename $0` <client_code> <org_oid>"
  echo "ex:    `basename $0` ABCIINC G3Z4GAR4Q75361RX"
  exit;
fi
ccd=$(echo $1 | tr '[a-z]' '[A-Z]')
orgoid=$(echo $2 | tr '[a-z]' '[A-Z]')

$ORACLE_HOME/bin/sqlplus -s ggate/ggate@crtp01<<!
prompt Listing current configuration
prompt
prompt   Current commands
SELECT * FROM client_config_cmds WHERE clnt = '$ccd';
prompt   Current product profiles
SELECT distinct * FROM curr_isi_client_load WHERE org_id = '$orgoid';
prompt   Deleting current commands and product profiles
DELETE FROM client_config_cmds WHERE clnt = '$ccd';
DELETE FROM curr_isi_client_load WHERE org_id = '$orgoid';
prompt   Reloading product profiles
INSERT INTO curr_isi_client_load (org_id, client_code, product_code)
SELECT org_id, client_code, product_code FROM adpr_isi_client_vw
WHERE org_id = '$orgoid';
COMMIT;
prompt   Reloading commands
exec configure_isi_client.populate_client_config_cmds('$orgoid', '0');
COMMIT;
prompt   New product profiles
SELECT distinct * FROM curr_isi_client_load WHERE org_id = '$orgoid';
prompt   New commands
SELECT * FROM client_config_cmds WHERE clnt = '$ccd';
!


-------------------------
-------------------------


   -- generate it for bunch of HRB clients:
  SELECT 'delete from client_config_cmds where clnt = ''' || isiclientid || ''';'
  FROM  adpr_hrb_client_vw WHERE ooid IS not NULL
   ORDER BY 1;
  select 'exec configure_isi_client.populate_client_config_cmds(''' || ooid || ''', ''0'');'
  FROM adpr_hrb_client_vw WHERE ooid IS not NULL --AND isiclientid = 'AGILETECH'
   ORDER BY 1;

   -- generate it for bunch of WFN3 clients:
  SELECT 'delete from client_config_cmds where clnt = ''' || isi_client_id || ''';'
  FROM  adpr_client_extensions WHERE isi_client_id IS not NULL
  AND  product_code = 'WFN' AND replicating = 'Y'
   ORDER BY 1;
   select 'exec configure_isi_client.populate_client_config_cmds(''' || organization_oid || ''', ''0'');'
  FROM adpr_client_extensions WHERE organization_oid IS not NULL --AND isiclientid = 'AGILETECH'
    AND  product_code = 'WFN' AND replicating = 'Y'
   ORDER BY 1;

   -- generate it for bunch of EZLM clients:
  SELECT 'delete from client_config_cmds where clnt = ''' || upper(isi_client_id) || ''';'
  FROM  adpr_ezlm_client WHERE isi_client_id IS not NULL
  AND  integrated = 'Y'
   ORDER BY 1;
   select 'exec configure_isi_client.populate_client_config_cmds(''' || organization_oid || ''', ''0'');'
  FROM  adpr_ezlm_client WHERE isi_client_id IS not NULL
  AND  integrated = 'Y'
   ORDER BY 1;

-- get client rg
exec isiwsinterfacetest.getclientresourcegroups('IEEE');
exec isiwsinterfacetest.deleteclientresourcegroup('PEOMGZ');
exec isiwsinterfacetest.getclientresourcegroups('CDINCQ');

exec isiwsinterfacetest.ADDclientresourcegroup('PEOMGZ', 'ADPRPROD02');
exec isiwsinterfacetest.ADDclientresourcegroup('TERRATECH', 'ADPRPROD02');
COMMIT;

----#########  Troubleshooting:
  -- ALL commands for HRB corrections + additons.
with list as (select clnt from (
SELECT clnt FROM client_config_cmds WHERE prd_code = 'HRB'
MINUS
select c.client_code
FROM
webrepadmin.catclient@dblinkcrtp01tocatp01 c,
webrepadmin.batclientproduct@dblinkcrtp01tocatp01 bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocatp01 bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code = 'HRB'
))
select CMD  FROM  client_config_cmds c, LIST l
 WHERE c.clnt = l.clnt AND c.prd_code = 'HRB'



-- ALL commands for HRB existing configuration.
with list as (select clnt from (
SELECT clnt FROM client_config_cmds WHERE prd_code = 'HRB'
MINUS
select c.client_code
FROM
webrepadmin.catclient@dblinkcrtp01tocatp01 c,
webrepadmin.batclientproduct@dblinkcrtp01tocatp01 bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocatp01 bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code = 'HRB'
))
select 'configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || c.pod_code
                    || ''',''' || bcp.bcp_extension_flag || ''', ''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''', '''||
                     c.CLIENT_ORGOID || ''') x'
FROM
webrepadmin.catclient@dblinkcrtp01tocatp01 c,
webrepadmin.batclientproduct@dblinkcrtp01tocatp01 bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocatp01 bce,
list l
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code = 'HRB' AND
      c.client_code =  l.clnt


-- ALL commands for WFN3 corrections + additons.
with list as (select clnt from (
SELECT DISTINCT clnt FROM client_config_cmds
WHERE prd_code = 'WFN' AND CMD LIKE '%WFNEZLM%'
MINUS    --INTERSECT
select DISTINCT  c.client_code
FROM
webrepadmin.catclient@dblinkcrtp01tocrc02p c,
webrepadmin.batclientproduct@dblinkcrtp01tocrc02p bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocrc02p bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code = 'WFNEZLM'
))
select DISTINCT CMD  FROM  client_config_cmds c, LIST l
 WHERE c.clnt = l.clnt AND c.prd_code = 'WFN' AND cmd LIKE '%WFNEZLM%'
      ORDER BY 1;

-- ALL commands for WFN3 existing configuration.
with list as (select clnt from (
SELECT DISTINCT clnt FROM client_config_cmds
WHERE prd_code = 'WFN' AND CMD LIKE '%WFNEZLM%'
INTERSECT
select DISTINCT  c.client_code
FROM
webrepadmin.catclient@dblinkcrtp01tocrc02p c,
webrepadmin.batclientproduct@dblinkcrtp01tocrc02p bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocrc02p bce
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code = 'WFNEZLM'
))
select 'configure_client(''' || c.client_code  ||''', ''' || bce.inst_key || ''', ''' || c.pod_code
                    || ''',''' || bcp.bcp_extension_flag || ''', ''' || bcp.bcp_extension_value ||
                     ''', ''' || bcp.prd_code || ''', ''' || bcp.ver_code || ''', ''' ||
                     bce.bce_dblink_flag || ''', ''' ||  bce.bce_dblink_value || ''', '''||
                     c.CLIENT_ORGOID || ''')'
FROM
webrepadmin.catclient@dblinkcrtp01tocrc02p c,
webrepadmin.batclientproduct@dblinkcrtp01tocrc02p bcp,
webrepadmin.batclientenvironment@dblinkcrtp01tocrc02p bce,
list l
WHERE c.client_code = bce.client_code AND
      c.client_code = bcp.client_code AND
      bcp.prd_code = bce.prd_code AND
      bcp.prd_code = 'WFNEZLM' AND
      c.client_code =  l.clnt
      ORDER BY 1;
-----------------------------------


CLIENT CONFIG MISMATCH BETWEEN MAS 94 POD AND R11 POD:

select * from webrepadmin.batclientenvironment@dblinkcrtp01tocatp01 a ,
webrepadmin.batclientenvironment@dblinkcrtp01tocrc02p b
WHERE a.client_code = b.client_code AND a.prd_code = b.prd_code
AND (a.inst_key != b.inst_key OR nvl(a.bce_dblink_flag, 'x') != nvl(b.bce_dblink_flag, 'x')
OR nvl(a.bce_dblink_value, 'x') != nvl(b.bce_dblink_value, 'x'))
AND a.client_code IN (

select * from webrepadmin.batclientproduct@dblinkcrtp01tocatp01 a ,
webrepadmin.batclientproduct@dblinkcrtp01tocrc02p b
WHERE a.client_code = b.client_code AND a.prd_code = b.prd_code
AND (a.ver_code != b.ver_code OR nvl(a.bcp_extension_flag, 'x') != nvl(b.bcp_extension_flag, 'x')
OR nvl(a.bcp_extension_value, 'x') != nvl(b.bcp_extension_value, 'x'))
AND a.client_code IN (


-----------------------------------

My Report is when an user saves an standard external report, making it private – this way he can edit the report.

------------------------------------------
ggate@crtd01
SELECT filename, tabname, colname, Count(1) FROM tms_files_fields
GROUP BY rollup(filename, tabname, colname)
ORDER BY 1,2,3
----------------------------------------------

ipay test cases.
call app_security_context_ipay.set_Region_ccode('(0030, ''ORD''),(0030, ''R3W''),(0030, ''R3W''),(0030, ''UBV'')','ER');
call app_security_context_ipay.set_Region_ccode('','CSR')
call app_security_context_ipay.set_Region_ccode('(0020, ''351''),(0020, ''70Z''),(0020, ''70Z''),(, '''')','ER')
call app_security_context_ipay.set_Region_ccode('(, ''''),(0070, ''N1Z''),(0070, ''N1Z'')','ER')
call app_security_context_ipay.set_Region_ccode('(, '''')','ER')
select * FROM t_ipay_user;

-------------------------------------------------------

variable x refcursor
set autoprint on
DECLARE
  vcnt PLS_INTEGER DEFAULT 10;
BEGIN
  OPEN :x FOR
  SELECT person_seqnum, data_set_id FROM cpd_person
  WHERE ROWNUM < vcnt;
END;
/

declare
  p_deptno number default 10;
begin
  open :x for
  'select deptno, dname, cursor( select ename from emp where emp.deptno = dept.deptno) from dept
  where deptno = :p_deptno' USING p_deptno;
end;
/



-------------------------------------------------------------

$ cat RefCursor.java

import java.sql.*;
import java.io.*;
import oracle.jdbc.driver.*;

class RefCursor
{

public static void main (String args [])
throws SQLException, ClassNotFoundException
{
   String query  = "begin "+
                        "open ? for "+
                        "'select dname, CURSOR(select ename "+
                                                "from emp "+
                                               "where emp.deptno=dept.deptno) "+
                           "from dept'; "+
                    "end;";

   DriverManager.registerDriver
        (new oracle.jdbc.driver.OracleDriver());

   Connection conn=
       DriverManager.getConnection
       ("jdbc:oracle:thin:@aria-dev:1521:ora817dev",
         "scott", "tiger");

   Statement trace = conn.createStatement();

   CallableStatement  cstmt = conn.prepareCall(query);

   cstmt.registerOutParameter(1,OracleTypes.CURSOR);
   cstmt.execute();

   ResultSet rset= (ResultSet)cstmt.getObject(1);

   for(int i = 0;  rset.next(); i++ )
   {
    System.out.println( rset.getString(1) );
    ResultSet rset2 = (ResultSet)rset.getObject(2);
    for( int j = 0; rset2.next(); j++ )
        System.out.println( "   " + rset2.getString(1) );
    rset2.close();

   }

   rset.close();
   cstmt.close();
}
}

----------------------------------------------------------------------

How many reports are run today in MAS:
select sum(c) from (
SELECT COUNT(1) c from batreq WHERE req_timestamp > TRUNC(SYSDATE)
union all
SELECT COUNT(1) c from webreppilot.batreq WHERE req_timestamp > TRUNC(SYSDATE)
union all
SELECT COUNT(1) c from webreppod.batreq WHERE req_timestamp > TRUNC(SYSDATE)
union all
SELECT COUNT(1) c from webrw.batreq@dblinkcatp01tocatp02 WHERE req_timestamp > TRUNC(SYSDATE)
);

------------------------------------------------------------------------

HRB client detection:
select DISTINCT --a.company_id, a.ooid,
b.o FROM
(SELECT company_id, ooid FROM hrb_r25.company_auth@dblinkcrtp01tocrtp03
UNION
SELECT company_id, ooid FROM hrb_reg0001.company_auth@dblinkcrtp01tocrh01p) a,
appadm.isiclient b,
appadm.isiproduct_sc_client c
WHERE c.adpproductcode = 'HRB'
AND a.ooid = b.clientoid
AND c.o = b.o
 AND EXISTS (SELECT 1 FROM  appadm.isiproduct_sc_client x
 WHERE x.o = c.o
 AND x.adpproductcode = 'CRT')


SELECT DISTINCT upper(isiclientid) from adpr_hrb_client

SELECT DISTINCT client_code from webrepadmin.batclientenvironment@dblinkcrtp01tocatp01 WHERE prd_code = 'HRB'

SELECT DISTINCT upper(isiclientid) from adpr_hrb_client


-------------------------------------------------------------------------

catalog field - vs - view columns match checking:
SELECT DECODE(a.rn, 1, a.col_fieldname, a.col_fieldname || ','),
       DECODE(a.rn, 1, (select DISTINCT 'FROM ' || x.tab_table || '_0003;' || CHR(10) || 'SELECT '  from cattable x where x.tab_code = a.tab_code), '') from (
SELECT col_fieldname, tab_code, row_number() OVER (PARTITION BY tab_code ORDER BY col_fieldname) rn FROM CATCOLUMN WHERE TAB_CODE LIKE '%TMS%8' ORDER BY 2, 1 DESC
) a;

--------------------------------------------------------------------------------

We added this entry in secsession when we created adpadmin
in the new DC2 Pilot pod:
insert into secsession (session_id, user_login, session_timestamp, remote_id, client_code, session_parent_id, user_key)
VALUES (fnckey('SEQ_SESSION_ID'), 'ADMIN', SYSDATE, '', 'ADPADMIN', '', (select user_key from secuser where user_login = 'ADMIN'));
commit;


----------------------------------------------------------------------------------

call tms8_sec_context_0003.set_app_cont('JGEMBRY@TMSFIT3','ER','G3S815BDNZE89BTA','G341N9H4DCFMJ5XE',
'WS_EMP_BASIC_INFO_VW WS_EMP_PLAN_DATA_VW','');


call ts_peo_sec_context.set_app_context('PMEYER1@WRRTEST','ER','G30VH7W440S3BDQM','G369Z1Y4WR73FSKN',
'PEO_CHECK_DATA.FILE_NBR#=#''000053'',PEO_CHECK_DATA.CHECK_DT#=#TO_DATE(''11/30/2011'', ''MM/DD/YYYY'')');

---------------------------------
How to fix 11G ACL issue:

we create an acl with resolve capability, add the connect privlege,
and assign the acl to an address...
We just use * with no ports so it is wide open

It should be part of the schema setup file.


All catalog schemas will need to have network acl added going forward.  Below are the commands to accomplish this.  The principal variable is where the schema will go.

-- Run this if the db is new
BEGIN
DBMS_NETWORK_ACL_ADMIN.CREATE_ACL (
  acl          => 'adprconnect.xml',
  description  => 'open connections for adpr',
  principal    => 'RPTTEST1242',
  is_grant     => TRUE,
  privilege    => 'resolve',
  start_date   => null,
  end_date     => null);
END;
/

BEGIN
DBMS_NETWORK_ACL_ADMIN.ADD_PRIVILEGE (
  acl          => 'adprconnect.xml',
  principal    => 'RPTTEST1242',
  is_grant     => TRUE,
  privilege    => 'connect');
END;
/

BEGIN
DBMS_NETWORK_ACL_ADMIN.ASSIGN_ACL (
  acl          => 'adprconnect.xml',
  host         => '*');
END;
/

-- Run this if the db exists and there is already a functional adpr catalog schema housed in the db
BEGIN
DBMS_NETWORK_ACL_ADMIN.ADD_PRIVILEGE (
  acl          => 'adprconnect.xml',
  principal    => 'RPTTEST1242',
  is_grant     => TRUE,
  privilege    => 'resolve');
END;
/

BEGIN
DBMS_NETWORK_ACL_ADMIN.ADD_PRIVILEGE (
  acl          => 'adprconnect.xml',
  principal    => 'RPTTEST1242',
  is_grant     => TRUE,
  privilege    => 'connect');
END;
/


The following commands will also need to be run for any new catalog database.  This has already been done on the dit db.

-- ADPR specific parameters
alter system set '_always_semi_join'=off sid='*' scope=both;
alter system set cursor_sharing=EXACT  sid='*' scope=both;

-- Disable auto stats jobs
exec dbms_scheduler.disable('BSLN_MAINTAIN_STATS_JOB');
EXEC dbms_auto_task_admin.disable( 'auto optimizer stats collection', NULL, NULL);

-- Disable default resource plan
alter system set resource_manager_plan='' sid='*' scope=both;
execute dbms_scheduler.set_attribute('WEEKNIGHT_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('WEEKEND_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('SATURDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('SUNDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('MONDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('TUESDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('WEDNESDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('THURSDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('FRIDAY_WINDOW','RESOURCE_PLAN','');



Catalog Stats Jobs

Sqlplus ‘/as sysdba’@crw21p
Set serveroutput on
Exec dbms_Scheduler.run_job(‘ADPR_STATS_DAILY_WEBREPADMIN’);
Exit;

Sqlplus ‘/as sysdba’@crw21p
Set serveroutput on
Exec dbms_Scheduler.run_job(‘ADPR_STATS_DAILY_ADPRMASPRD01’);
Exit;

Sqlplus ‘/as sysdba’@crw22p
Set serveroutput on
Exec dbms_Scheduler.run_job(‘ADPR_STATS_DAILY_ADPRMASPRD02’);
Exit;

Sqlplus ‘/as sysdba’@crw23p
Set serveroutput on
Exec dbms_Scheduler.run_job(‘ADPR_STATS_DAILY_ADPRMASPRD03’);
Exit;



=================================================

some queries:



select (code || '-' || description) from px185_TYPE_CLIENT_0179 where oid = '1583670:24636';

select oid from px185_payroll_agreement_0196 where file_no = '041614';
select HOME_DEPT_OID from px185_position_0196 where PAYROLL_AGREEMENT_OID in (select oid from px185_payroll_agreement_0196 where file_no = '041614');
select distinct CO_CODE,oid from px185_COMPANY_CODE;


select parent_code, id_code, schema_name, vpd_key, schema_version, selling_
region_code, instance_name, organization_oid from v_client_logon where organizat
ion_oid = '0VA01PB1MQY000NW';

select distinct pay_date from VPDCLSCH0010000166.CHECK_HISTORY@DBLINKCRU20PTOPXC23P CH ,VPDCLSCH0010000166.CHECK_HISTORY_DISTRIBUTION@DBLINKCRU20PTOPXC23P CD where CH.VPD_KEY=CD.VPD_KEY
  2  and CH.oid = CD.check_history_oid and CH.file_no = '001150' AND CH.VPD_KEY = 'PAYXSCH0079913';

select code from VPDCLSCH0010000084.TYPE_CLIENT@DBLINKCRU20PTOPXC07P where oid  = 'SYS:4:2993' and VPD_KEY = 'PAYXSCH0088377';
select opt_emp_pay_rates from VPDCLSCH0010000084.SECURITY_USER_PROFILE@DBLINKCRU20PTOPXC07P where vpd_key ='PAYXSCH0088377' and oid = '7:327';



select count(1) from TM_EE_ATTRIBUTE_VALUE where TM_EE_ATTRIBUTE_ID in (select TM_EE_ATTRIBUTE_ID from TM_EE_ATTRIBUTE where EMPLOYEE_ID ='15130381') and CSTFLD_ID = '38982661';

select user_key from secuser where user_login = upper('dlazarski@SYRCATCHAR');
select count(1) from secfolder where USER_KEY = '211678';


select user_key from secuser where user_login  = 'BGUTOWSKI@ARCPORTAL';
select max(session_id) from secsession where user_key = 11689;
select SESSION_TIMESTAMP from secsession where session_id = 1201818678660;
select * from secsessionval where session_id = 1201818678660;


=========================================================

cpu: psrinfo -pv
ram: prtconf | grep -i mem
   deatils: /usr/platform/`uname -i`/sbin/prtconf


==========================================================


select a.associate_id,a.org_id, a.formatted_nm, a.email,
       o.isi_org_cd, ap.profile_ui_id, ap.display_nm
FROM
REGPOD15.appl_profile_user@DBLINKCRTP02TOREG01P apu,
REGPOD15.appl_profile@DBLINKCRTP02TOREG01P ap,
REGPOD15.associate@DBLINKCRTP02TOREG01P a,
REGPOD15.org@DBLINKCRTP02TOREG01P o
 where ap.profile_ui_id like 'CRT%' and
       ap.appl_profile_id = apu.appl_profile_id and
       a.associate_id=apu.associate_id AND
       o.org_id=a.org_id   AND
       o.org_id = 'G3JD9GYMC3M21RKB';

	   G370PF5Q9TGQF222
select count(1) from regpod15.org_role@DBLINKCRS01QTOREG12Q where org_id = 'G3JXWXWA6METN3XY';
select count(1) from regpod14.org_role@DBLINKCRS01QTOREG12Q where org_id = 'G3JXWXWA6METN3XY';
select count(1) from regpod13.org_role@DBLINKCRS01QTOREG12Q where org_id = 'G3JXWXWA6METN3XY';
select count(1) from regpod11.org_role@DBLINKCRS01QTOREG12Q where org_id = 'G3JXWXWA6METN3XY';


select count(1) from ISI_REG15.org_role where org_id = 'G3JXWXWA6METN3XY';

DBLINKCRTP01TOREG11P
select count(1) from regpod15.ORG@DBLINKCRTP01TOREG11P WHERE upper(org.isi_org_cd) = 'OLU';
select count(1) from regpod14.ORG@DBLINKCRTP01TOREG11P WHERE upper(org.isi_org_cd) = 'OLU';
select count(1) from regpod13.ORG@DBLINKCRTP01TOREG11P WHERE upper(org.isi_org_cd) = 'OLU';
select count(1) from regpod11.ORG@DBLINKCRTP01TOREG11P WHERE upper(org.isi_org_cd) = 'OLU';

-- Registry Side
select distinct ass.ASSOCIATE_ID,
       upper(org.isi_org_cd) isiclientid
  FROM regpod14.ORG@DBLINKCRTP01TOREG11P org,
       regpod14.ASSOCIATE@DBLINKCRTP01TOREG11P ass
where org.org_id = ass.org_id
 and  upper(org.isi_org_cd) = 'OLU';

-- ADPR Side
select distinct ass.ASSOCIATE_ID,
       upper(org.isi_org_cd) isiclientid
  FROM ISI_REG14.ORG@dblinkcrtp01tocru40p org,
       ISI_REG14.ASSOCIATE@dblinkcrtp01tocru40p ass
where org.org_id = ass.org_id
 and  upper(org.isi_org_cd) = 'OLU';



select org_id from org where upper(isi_org_cd) = 'P83TEST';
select distinct upper(LOGIN_ID) from ASSOCIATE_USER where upper(LOGIN_ID) like '%P83TEST' order by 1;

============================================================

call app_security_context_ipay.set_Region_ccode('0030','ADP');

select distinct CCODE, CCODE_INIT, EMAIL_ADDR, USER_ID,
(select DISTINCT ADPLASTLOGINDATE FROM ISIUSER WHERE userid = a.user_id) last_login_dat,
CREATED, SSN, FILEN
  FROM T_IPAY_USER a
where ccode in
       ('PX1', 'X58', 'UCA', 'RTM', 'PX3', 'PW6', 'PW5', 'PW3', 'P8R', 'NLA',
        'LIZ', 'KU7', 'K7T', 'FXC', 'EE6', 'D0E', '3QI', '3Q6', '186')
AND SUBSTR(user_id, INSTR(user_id,'@')+1)
IN ('HSCARE', 'PARKSTAFF', 'JASTAFF');

=============================================================

CONN STR:
Data Source=cru07d;Persist Security Info=True;User ID=webrepadmin;Password=webrepadmin;Unicode=True

===============================================================
Overwrite file, write to multiple files
$ ls | tee file
$ ls | tee file1 file2 file3
Append.. do not overwrite
$ ls | tee -a file

The following command will take a backup of the crontab entries, and pass the crontab entries as an input to sed command
$ crontab -l | tee crontab-backup.txt | sed 's/old/new/' | crontab -


==================================================================
shel input and output
<&-           close stdin
>&-           close stdout
<>filename    open filename for read-write
2>&1          open 2 for write and dup as 1

Examples:
  cmd 2>/dev/null
  cmd >/dev/null 2>&1
  exec 1<&-           # close descriptor 1
  exec 2<&-           # close descriptor 2
  exec 1< /dev/null   # open descriptor 1
  exec 2< /dev/null   # open descriptor 2

======================================================================
HRB Status:
100 => billable
200 => non-billable
300 => implementation
400 => implementation complete
500 => suspended
======================================================================

Query to get TMS view/table references and the key dependencies:

SELECT (CASE WHEN rn1 = 1 THEN name ELSE '' END) viewname,
       (CASE WHEN rn2 = 1 THEN table_name ELSE '' END) table_name,
       column_name, position, rn1, rn2
  FROM (WITH XVAL
             AS (SELECT --u.CONSTRAINT_NAME,
                       uc.table_name, uc.column_name, uc.position
                   FROM all_constraints u, all_cons_columns uc
                  WHERE     u.owner = 'CLIENTONE_ADM'
                        AND uc.owner = 'CLIENTONE_ADM'
                        AND uc.CONSTRAINT_NAME = u.CONSTRAINT_NAME
                        AND uc.table_name = u.table_name
                        AND u.CONSTRAINT_TYPE NOT IN ('C', 'R')
                        AND UC.TABLE_NAME NOT LIKE 'BIN%'),
             YVAL
             AS (SELECT u.name, --u.referenced_name,
                        (SELECT x.table_name
                           FROM user_synonyms x
                          WHERE x.synonym_name = u.referenced_name)
                           table_name
                   FROM user_dependencies u
                  WHERE u.name LIKE '%_VW_0003%')
          SELECT y.name,
                 y.table_name,
                 x.column_name,
                 x.position,
                 ROW_NUMBER () OVER (PARTITION BY y.name ORDER BY y.name) rn1,
                 ROW_NUMBER ()
                 OVER (PARTITION BY y.name, y.table_name
                       ORDER BY y.name, y.table_name)
                    rn2
            FROM xval x, yval y
           WHERE x.table_name = y.table_name
        ORDER BY 1,2,3,4);
=====================================================================

-------------------------------------------------
ISICLIENTID ORGOID           REGION
TMSQA1      G369Z1Y4WR7360X5 0003
TMSFIT3     G341N9H4DCFMJ5XE 0004
SIT2        G5E0YHOT6XFURFCB 0002
QH01FIT2    051CSJSNPEG00038 0001
-------------------------------------------------
ORGANIZATION_OID DB_INSTANCE DB_SCHEMA_NAME
G369Z1Y4WR7360X5 wsp01q_svc1 TMSONEQUERY
G341N9H4DCFMJ5XE wsp01q_svc1 TMSTWOQUERY
051CSJSNPEG00038 wsp01q_svc1 CLIENTONEQUERY
G5E0YHOT6XFURFCB wsp01q_svc1 CLIENTTWOQUERY
-------------------------------------------------

-- LIST OF HRB CLIENTS CONFIGRED TO USE ADPR
sqlplus webrepadmin@catp01
SELECT *
FROM   (SELECT DISTINCT b.client_code
                       ,c.client_orgoid
        FROM   batclientenvironment b
              ,catclient            c
        WHERE  b.prd_code = 'HRB'
        AND    c.client_code = b.client_code
        AND    c.pod_code = (SELECT x.pod_code FROM batpod x WHERE x.pod_current = 't')
        UNION
        SELECT DISTINCT b.client_code
                       ,c.client_orgoid
        FROM   webreppilot.batclientenvironment b
              ,webreppilot.catclient            c
        WHERE  b.prd_code = 'HRB'
        AND    c.client_code = b.client_code
        AND    c.pod_code = (SELECT x.pod_code FROM webreppilot.batpod x WHERE x.pod_current = 't')
        UNION
        SELECT DISTINCT b.client_code
                       ,c.client_orgoid
        FROM   webrw.batclientenvironment@dblinkcatp01tocatp02 b
              ,webrw.catclient@dblinkcatp01tocatp02            c
        WHERE  b.prd_code = 'HRB'
        AND    c.client_code = b.client_code
        AND    c.pod_code =
               (SELECT x.pod_code FROM webrw.batpod@dblinkcatp01tocatp02 x WHERE x.pod_current = 't')) a
WHERE  EXISTS (SELECT 1
        FROM   ggate.curr_isi_client_load@dblinkcatp01tocrtp01 x
        WHERE  x.client_code = a.client_code
        AND    x.product_code = 'HRB')
ORDER  BY 1;
=====================================================================

Findout hrb client location:

SELECT * FROM (
SELECT 'WRS', cs.company_id
      ,(CASE WHEN cs.status_code = 100 THEN 'Billable'
            WHEN cs.status_code = 200 THEN 'Non-Billable'
            WHEN cs.status_code = 300 THEN 'Implementation In Progress'
            WHEN cs.status_code = 400 THEN 'Implementation Complete'
            WHEN cs.status_code = 500 THEN 'Suspended'
       END) status
      ,cs.timestamp
FROM   hrb_r25.company_status@dblinkcatp01tocrtp03 cs
      ,hrb_r25.company_auth@dblinkcatp01tocrtp03   ca
WHERE  cs.effective_date = (SELECT MAX(cs1.effective_date)
                            FROM   hrb_r25.company_status@dblinkcatp01tocrtp03 cs1
                            WHERE  cs.company_id = cs1.company_id
                            AND    cs1.effective_date < SYSDATE)
AND    ca.company_id = cs.company_id
AND    ca.ooid = 'F2B84C50EDD0030B'
UNION
SELECT 'CDC', cs.company_id
      ,(CASE WHEN cs.status_code = 100 THEN 'Billable'
            WHEN cs.status_code = 200 THEN 'Non-Billable'
            WHEN cs.status_code = 300 THEN 'Implementation In Progress'
            WHEN cs.status_code = 400 THEN 'Implementation Complete'
            WHEN cs.status_code = 500 THEN 'Suspended'
       END) status
      ,cs.timestamp
FROM   hrb_reg0001.company_status@dblinkcatp01tocrh01p cs
      ,hrb_reg0001.company_auth@dblinkcatp01tocrh01p   ca
WHERE  cs.effective_date = (SELECT MAX(cs1.effective_date)
                            FROM   hrb_reg0001.company_status@dblinkcatp01tocrh01p cs1
                            WHERE  cs.company_id = cs1.company_id
                            AND    cs1.effective_date < SYSDATE)
AND    ca.company_id = cs.company_id
AND    ca.ooid = 'F2B84C50EDD0030B'
) ORDER  BY timestamp;
==================================================================

HWSE Prod clients not in SOR but configured in catalog:
select client_code, bcp_extension_value
select
'update batclientproduct set bcp_extension_flag = ''f'', bcp_extension_value = null where client_code = ''' || a.client_code || ''' and prd_code = ''BASE'';'
from batclientproduct a
where not exists (select 1 from
 ggate.adpr_client_extensions@dblinkcatp01tocru04p b
 where a.client_code = upper(b.isi_client_id)
) and prd_code = 'BASE'
and bcp_extension_value is not null;

======================================================================

hwse r17-> r185 migration commands generation scripts:
live:
select distinct
'ksh runsyn.sh,' || table_owner || ',' || db_link || ',' || OWNER || ',CRU04P'
 from dba_synonyms
where
table_owner in (  <<client list>>
);

select distinct
'ksh INSTALL.sh ' || OWNER || ' cru04p'
 from dba_synonyms
where
table_owner in (
);

select distinct
'ksh start_hwse_all.sh ' || OWNER || ' cru04p'
 from dba_synonyms
where
table_owner in (
);

select distinct
'ksh install_hwse_new_arch.sh cru04p '  || substr(OWNER, 9,2) || ' ' || substr(OWNER, 11,2)
 from dba_synonyms
where
table_owner in (
);

--PEND ELE
SELECT
'CONN ' || TABLE_OWNER || '/' || TABLE_OWNER || '@' || SUBSTR(DB_LINK, 15)
|| CHR(10) ||
DECODE(SUBSTR(DB_LINK, 15), 'HWS11P', '@PEND_EVNT_ELE_VW.sql',
'@PEND_EVNT_ELE_VW_dblink.sql COMMON_HWS11P_SVC1_P ' || TABLE_OWNER)
FROM dba_synonyms  WHERE SYNONYM_NAME = 'SYN_ELECTION' AND
owner in (
  select distinct owner from all_objects where object_name = 'PEND_EVNT_ELE_VW'
  AND OWNER LIKE '%REG%'
) order by 1;


CTEST:
=======
select distinct
'ksh runsyn.sh,' || table_owner || ',' || db_link || ',' || OWNER || ',CRU03P'
 from dba_synonyms
where
substr(table_owner, 1, instr(table_owner, 'CTEST')-1) in (
);


select distinct
'ksh INSTALL.sh ' || OWNER || ' cru03p'
 from dba_synonyms
where
substr(table_owner, 1, instr(table_owner, 'CTEST')-1) in (
);


select distinct
'ksh start_hwse_all.sh ' || OWNER || ' cru03p'
 from dba_synonyms
where
substr(table_owner, 1, instr(table_owner, 'CTEST')-1) in (
);

select distinct
'ksh install_hwse_new_arch.sh cru03p '  || substr(OWNER, 9,2) || ' ' || substr(OWNER, 11,2)
 from dba_synonyms
where
substr(table_owner, 1, instr(table_owner, 'CTEST')-1) in (
);

--PEND ELE
SELECT
'CONN ' || TABLE_OWNER || '/' || TABLE_OWNER || '@' || SUBSTR(DB_LINK, 15)
|| CHR(10) ||
DECODE(SUBSTR(DB_LINK, 15), 'HWS11P', '@PEND_EVNT_ELE_VW.sql',
'@PEND_EVNT_ELE_VW_dblink.sql COMMON_HWS11P_SVC1_P')
FROM dba_synonyms  WHERE SYNONYM_NAME = 'SYN_ELECTION' AND
substr(table_owner, 1, instr(table_owner, 'CTEST')-1) in (
);

SELECT
'CONN ' || TABLE_OWNER || '/' || TABLE_OWNER || '@' || SUBSTR(DB_LINK, 15)
|| CHR(10) ||
DECODE(SUBSTR(DB_LINK, 15), 'HWS11P', '@PEND_EVNT_ELE_VW.sql ',
'@PEND_EVNT_ELE_VW_dblink.sql COMMON_HWS11P_SVC1_P '
) || substr(table_owner, 1, instr(table_owner, 'CTEST')-1)
FROM dba_synonyms  WHERE SYNONYM_NAME = 'SYN_ELECTION' AND
owner in (
  select distinct owner from all_objects where object_name = 'PEND_EVNT_ELE_VW'
  AND OWNER LIKE '%REG%'
) order by 1;


isi client id is called external system client id in HWSE.




+++++++++DR LOAD+++++++++++++


select username from all_users where username like 'VPD_1%' order by 1;


begin
 for i in (select username from all_users where username like 'VPD_1%' order by 1)
 loop
   execute immediate 'drop user ' || i.username || ' cascade';
 end loop;
end;
/
col titl format a15
col crup format a10
col table_owner format a15
col db_link format a30
col owner format a20
select distinct
'ksh runsyn.sh' titl, table_owner , db_link || 'DR' db_link, OWNER, 'CRU04P' crup
 from dba_synonyms
where 1=1 and synonym_name = 'SYN_ELECTION' AND
owner in ();

select distinct
'ksh start_hwse_all.sh ' || OWNER || ' cru04p'
 from dba_synonyms
where 1=1 and synonym_name = 'SYN_ELECTION' AND
owner in ();

select distinct
'ksh INSTALL.sh ' || OWNER || ' cru04p'
 from dba_synonyms
where 1=1 and synonym_name = 'SYN_ELECTION' AND
owner in ();



==========================================================================

#!/bin/ksh

x=`sqlplus / <<endl | grep KEEP | sed 's/KEEP//;s/[   ]//g'
select 'KEEP' , max(sal) from emp;
exit
endl`

echo the answer is $x


the SEDs are all on the same line and in the [ ] is a SPACE and a TAB.  When I run this,
I get:

$ ./test
the answer is 5000
=======================================================================================

is the client in hwse r17 or r185 ?

B185_BEN_ELECTION_STS_LK  BEN_ELECTION_STS_LK
B185_EVENT_DEP_PROOF_REQ  EVENT_DEP_PROOF_REQ
B185_PENDING_STS_LK       PENDING_STS_LK

select count(1) from HALDEX.PENDING_STS_LK@DBLINKCRU04PTOHWS14P;
select count(1) from UBS1.PENDING_STS_LK@DBLINKCRU04PTOHWS11P;
=======================================================================================

The refresh mode for the materialized view MV MV_USERROLEAREATABLE_ORIG is set to ON DEMAND on webreppilot@crtq01; hence it needs to refreshed in order to see the changes in ADPR.
EXECUTE DBMS_MVIEW.REFRESH('MV_USERROLEAREATABLE_ORIG','C');
=====================================================================================

select
'select ''' || SYNONYM_NAME || ''', (select count(1) from ' || SYNONYM_NAME || ') localcnt,' || chr(10) ||
 '(select count(1) from ' || TABLE_OWNER || '.' || TABLE_NAME || '@' || DB_LINK || ') remote from dual;'
from user_synonyms where SYNONYM_NAME like 'SYN_ELEC%'
order by 1;

select
'select (select cidn from adpr_hwse_cidn) clnt, ''' || TABLE_NAME || ''', ' || chr(10) ||
 '(select count(1) from ' || SYNONYM_NAME || ') localcnt,' || chr(10) ||
 '(select count(1) from ' || TABLE_NAME || ') remote from dual;'
from user_synonyms where SYNONYM_NAME like 'SYN_ELEC%'
order by 1;
=======================================================================================

SET ECHO ON
SET FEED ON
SET VERIFY ON
SET TIMING ON

SET DEFINE "^"
DEFINE SSID=^^1
DEFINE TSID=^^2
DEFINE SRSID=^^3

  FROM   cru_user.adpr_portal_mas_client_vw@dblink^^TSID.to^^SRSID. a
=======================================================================================

Reports are staying in processing state
Does the requests have INST_KEY on BATREQ? If they don’t, Listener will not pick it up.
=======================================================================================

SELECT 'conn ' || table_owner || '/' || table_owner ||  '@' || substr(db_link, 15)
|| CHR(10) ||
DECODE(substr(db_link, 15), 'HWS11P', '@PEND_EVNT_ELE_VW.sql', '@PEND_EVNT_ELE_VW_dblink.sql COMMON_HWS11P_SVC1_P'),
db_link
FROM dba_synonyms WHERE synonym_name = 'SYN_ELECTION' ORDER BY 2,1

SELECT 'conn ' || table_owner || '/' || table_owner ||  '@' || substr(db_link, 15)
|| CHR(10) ||
DECODE(substr(db_link, 15), 'HWS11P', 'select ''' || table_owner || ''', count(1) from common.member;',
                                      'select ''' || table_owner || ''', count(1) from common.member@COMMON_HWS11P_SVC1_P;'),
db_link
FROM dba_synonyms WHERE synonym_name = 'SYN_ELECTION' ORDER BY 2,1

===============================================================================================

=================================================================================================
log to varchar2
dbms_lob.substr( clob_column, for_how_many_bytes, from_which_byte );


for example:

  select dbms_lob.substr( x, 4000, 1 ) from T;

will get me the first 4000 bytes of the clob.  Note that when using SQL as I did, the max
length is 4000.  You can get 32k using plsql:


declare
   my_var long;
begin
   for x in ( select X from t )
   loop
       my_var := dbms_lob.substr( x.X, 32000, 1 );
       ....
=========================================================================================

dbms_output.put_line has a documented limit of 255 characters/line.  you have exceeded that.


create or replace procedure p ( p_str in varchar2 )
is
   l_str   long := p_str;
begin
   loop
      exit when l_str is null;
      dbms_output.put_line( substr( l_str, 1, 250 ) );
      l_str := substr( l_str, 251 );
   end loop;
end;
/

is a little dump routine I use.  Furthermore, SQL is limited to returning 4000 characters from
VARCHAR types.

ops$tkyte@ORA817DEV> create table t ( x clob );

Table created.

ops$tkyte@ORA817DEV>
ops$tkyte@ORA817DEV> declare
  2          l_data long;
  3          l_clob clob;
  4  begin
  5          l_data := rpad( '*', 4245, '*' );
  6          insert into t values ( empty_clob() )
  7          returning x into l_clob;
  8          dbms_lob.writeAppend( l_clob, 4245, l_data );
  9  end;
 10  /

PL/SQL procedure successfully completed.

ops$tkyte@ORA817DEV>
ops$tkyte@ORA817DEV> select dbms_lob.getLength(x) from t;

DBMS_LOB.GETLENGTH(X)
---------------------
                 4245

ops$tkyte@ORA817DEV>
ops$tkyte@ORA817DEV>
ops$tkyte@ORA817DEV> declare
  2          l_data varchar2(10000);
  3  begin
  4          select dbms_lob.substr(x,4245,1) into l_data from t;
  5          dbms_output.put_line( 'length = ' || length(l_data) );
  6  end;
  7  /
declare
*
ERROR at line 1:
ORA-06502: PL/SQL: numeric or value error: character string buffer too small
ORA-06512: at line 1
ORA-06512: at line 4


ops$tkyte@ORA817DEV>
ops$tkyte@ORA817DEV> declare
  2          l_data varchar2(10000);
  3          l_clob clob;
  4  begin
  5          select x into l_clob from t;
  6          l_data := dbms_lob.substr( l_clob, 4245, 1 );
  7          dbms_output.put_line( 'length = ' || length(l_data) );
  8  end;
  9  /
length = 4245

PL/SQL procedure successfully completed.

would be the way to fetch that.
================================================================================
QRYQUERY.QRY_USE_SQL_REWRITE= 't'

How to get complex queries:

select
br.req_key,
((select count(1) from qrytable where qry_key = qq.qry_key) +
(select count(1) from qrytable where qry_key = qq.qry_key and qrel_key is not null) +
(select count(1) from qryfield where qry_key = qq.qry_key and QRFIE_INSTANCEOF = 'FIE') +
(select count(1) from qryfield where qry_key = qq.qry_key and QRFIE_INSTANCEOF in ('CAL', 'COD')) +
(select count(1) from qrycalcfieldsel where qrfie_key in (select qrfie_key from qryfield where qry_key = qq.qry_key)) +
(select count(1) from qryfilterel where flt_key = qq.flt_key)) elements
from batreq br inner join qryquery qq on qq.qry_key = br.qry_key
where br.client_code = 'ADPADMIN' and br.req_active = 't'
order by elements desc;

===================================================================================

select username, tablespace from v$sort_usage where username is not null;

===================================================================================
Currently ME is setting report role (qryquery.role_key) to PRACTITIONER (role_key = 7) - but this rule only applies for WFN.

For NAS, ME need to leave the report key to ER (role_key = 1).

Workaround is run this update after the client is migrated in NAS:

update qryquery set role_key = 1 where client_code = '<CLIENT_CODE>';

====================================================================================
Client Name: Cliffs Natural Resources T Database
System of Record: EV5
Database: clvt
COID: G3TP60E66C573Z16
Client ID: CLC2T
Report Name: N/A
Enterprise URL: https://enterprisehr.us.adp.com/clvt/clvt.html
ADPR URL: https://adpreporting1.us.adp.com/Reporting/clientLogin.do
====================================================================================


CREATE PUBLIC DATABASE LINK DBLINKCRU04PTOHWS11PDR
CONNECT TO ggate IDENTIFIED BY ggate USING 'HWS11PDG_SVC1';

CREATE PUBLIC DATABASE LINK DBLINKCRU04PTOHWS12PDR
CONNECT TO ggate IDENTIFIED BY ggate USING 'HWS12PDG_SVC1';

CREATE PUBLIC DATABASE LINK DBLINKCRU04PTOHWS13PDR
CONNECT TO ggate IDENTIFIED BY ggate USING 'HWS13PDG_SVC1';

CREATE PUBLIC DATABASE LINK DBLINKCRU04PTOHWS14PDR
CONNECT TO ggate IDENTIFIED BY ggate USING 'HWS14PDG_SVC1';


cru03p:

CREATE PUBLIC DATABASE LINK DBLINKCRU03PTOHWS12PDR
CONNECT TO ggate IDENTIFIED BY ggate USING 'HWS12PDG_SVC1';

CREATE PUBLIC DATABASE LINK DBLINKCRU03PTOHWS13PDR
CONNECT TO ggate IDENTIFIED BY ggate USING 'HWS13PDG_SVC1';

CREATE PUBLIC DATABASE LINK DBLINKCRU03PTOHWS14PDR
CONNECT TO ggate IDENTIFIED BY ggate USING 'HWS14PDG_SVC1';


====================================================================================
error key word in logs of gg
exception key word in logs of cdc

====================================================================================
NAS R10->R12 Migrations:

@sor2 -> with parameters..
		and
select
'update batclientenvironment set cpe_key = ' || decode(bce.cpe_key, 3, 4, 4, 5, '')
|| ', bce_schema = ''' || bce.bce_schema
||''' where CLIENT_CODE = ''' || bce.CLIENT_CODE
||''' and PRD_CODE = ''' || bce.PRD_CODE
||''' and INST_KEY = ' || bce.INST_KEY
||' and BCE_DBLINK_FLAG = ''' || bce.BCE_DBLINK_FLAG
|| DECODE(bce.BCE_DBLINK_FLAG, 't', ''' and BCE_DBLINK_VALUE = ''' || bce.BCE_DBLINK_VALUE || '''',
''' and BCE_DBLINK_VALUE is null')
|| ';'
from batclientenvironment bce
where 1=1
and prd_code = 'BASE'
and client_code in (
<<client list>>
);

====================================================================================
HWSE Big client identification by # of participants
declare
  vcnt pls_integer;
  nstr varchar2(100);
begin
for i in
(select TARGET_SCHEMA_NAME from adpr_client_extensions where REPLICATING is null order by 1 )
loop
 vcnt := 0;
 nstr:='select count(1) from ' || i.TARGET_SCHEMA_NAME || '.primary_participant';
 execute immediate nstr into vcnt;
 dbms_output.put_line(i.TARGET_SCHEMA_NAME || ' : ' || vcnt);
end loop;
end;
/


====================================================================================

select count(*) into v_num_products
 from tx t
 ,TABLE(XMLSequence(extract(xmltype(t.val),'//product/productName'))) v;

select extract(xmltype(val), '//product[position()=3]') into v_prod_list from tx;

 with tx1 as (
select v.column_value prdElement
 from tx t
 ,TABLE(XMLSequence(extract(xmltype(t.val),'//product'))) v
)
select
EXTRACTVALUE(extract(t.prdElement, '//productName'), '/productName') PRDNAME,
EXTRACTVALUE(extract(t.prdElement, '//productCode'), '/productCode') PRDCODE,
EXTRACTVALUE(extract(t.prdElement, '//productStatus'), '/productStatus') PRDSTATUS
FROM TX1 T;


====================================================================================
recursive calls are queries oracle runs to run your query. A big number usually
indicates that you were likely hard parsing a large sql statement and oracle
had to run a lot of sql to figure out how to run your sql. From there comes
big number of consistent gets.

====================================================================================
Make the snapshot complex, for instance:

create snapshot snap_test1 as select s1.* from snap_test@readlink s1, dual;
A suggestion to make the mview complex is to add the predicate with rownum (" WHERE ROWNUM>0").

====================================================================================
R11 CLIENTS WITH WFN AND/OR EZLM PROFILES

TRUNCATE TABLE t;

insert INTO t(c) SELECT
client_code FROM webrepadmin.catclient@dblinkcrtp01tocrc02p
WHERE POD_CODE = 'WFN_PROD';

ALTER TABLE t add CONSTRAINT pk_t PRIMARY KEY (c);

BEGIN
dbms_stats.gather_table_stats(ownname => user, tabname => 'T', estimate_percent => 10, method_opt => 'FOR ALL INDEXED COLUMNS SIZE 1', cascade => TRUE, degree => 8);
END;
/

select * from (
SELECT client_code
      ,org_id
      ,wfn
      ,decode(ezlm, '', decode(prev_h, 'E', 'Y', ''), ezlm) ezlm
FROM   (SELECT client_code
              ,org_id
              ,decode(prdcode, 'W', 'Y') wfn
              ,decode(prdcode, 'E', 'Y') ezlm
              ,lead(prdcode, 1, 0) over(PARTITION BY org_id, client_code ORDER BY prdcode DESC NULLS LAST) prev_h
              ,row_number() over(PARTITION BY org_id, client_code ORDER BY prdcode DESC NULLS LAST) rn
              ,prdcode
        FROM   (SELECT DISTINCT /*+ FIRST_ROWS */ org_id
                               ,client_code
                               ,(CASE
                                  WHEN product_code = 'EZLABORMANAGER' THEN
                                   'E'
                                  WHEN product_code = 'WFNPORTAL' THEN
                                   'W'
                                  ELSE
                                   ''
                                END) prdcode
                FROM   curr_isi_client_load a
                      ,t                    x
                WHERE  x.c = a.client_code
				and x.c = 'ARABIANNTS')
        WHERE  prdcode IS NOT NULL
        ORDER  BY 1)
WHERE  rn = 1
ORDER  BY 1)
where rownum < 100;



====================================================================================
Second highest req_key from batreq:
select * from (
select req_key, row_number() over (order by req_key desc) rn from batreq
) where rn =2;

====================================================================================


select u_dump.value || '/' || instance.value || '_ora_' || v$process.spid
 || nvl2(v$process.traceid, '_' || v$process.traceid, null ) || '.trc' "Trace File"
from V$PARAMETER u_dump
cross join V$PARAMETER instance
cross join V$PROCESS
join V$SESSION on v$process.addr = V$SESSION.paddr
where u_dump.name = 'user_dump_dest'
and instance.name = 'instance_name'
and V$SESSION.audsid=sys_context('userenv','sessionid');


select prev_sql_id prevSqlID
from
 v$session where sid=(select distinct sid from v$mystat);


select *
from
 table(dbms_xplan.display_cursor('0mzrbb21mv1gp',NULL,'ALLSTATS LAST'));

Turning on 10046 tracing
exec dbms_monitor.session_trace_enable(NULL,NULL,TRUE,TRUE);

====================================================================================
WFN3.0-4.0 MIGRATION PRE CLIENT CONFIG COMMANDS SCRIPTS:

select 'EXEC ' || regexp_replace(cmd,'\)') || ',''US'');' from client_config_cmds
where clnt in (
);

Search:
'1', 'PILOT','f', '', 'IPAY',
Replace:
'20', 'PILOT','f', '', 'IPAY',

Search:
WFN_PROD
Replace:
WFN4_PROD

====================================================================================
HWSE DATA SIZE:
~~~~~~~~~~~~~~~~~~~~~~~~
col sz format 99999999999999

select a.owner, sum(s.bytes) sz
from all_tables a, dba_segments s where 1=1
and a.table_name = s.segment_name
and a.owner = s.owner
and exists (select 1 from all_objects x where x.object_name = a.table_name and x.object_type = 'MATERIALIZED VIEW')
and exists (select 1 from ggate.adpr_client_extensions x where x.target_schema_name = a.owner and x.replicating is null)
group by rollup(a.owner) order by 2;

select a.owner, sum(s.bytes) sz
from all_indexes a, dba_segments s where 1=1
and a.index_name = s.segment_name
and a.owner = s.owner
and exists (select 1 from all_objects x where x.object_name = a.table_name and x.object_type = 'MATERIALIZED VIEW')
and exists (select 1 from ggate.adpr_client_extensions x where x.target_schema_name = a.owner and x.replicating is null)
group by rollup(a.owner) order by 2;

====================================================================================
All MV creation is in a pacakge: PKG_REPORTING_MAINTENANCE
		Use PRC_DROP_MV and PRC_DEPLOY_MV to invoke it.
Below are actually tables named after MV_
 MV_PRODUCT
 MV_CLIENT_PRODUCT
 MV_CONFIGURATION

Application doesnt directly access MVs. There are views on top of MVs - layer added in case we need to change / add logic to MVs.

MV_USERROLEAREATABLE   : What files the user has access to
MV_CONFIGURATION : List of existing dyanamic labels
MV_CONFIGURATION_GENERIC / MV_CONFIGURATION_SPECIFIC : Dynamic labels for all tables / specific tables
MV_CLIENTPRODUCT : Summary of extensions, product version, configurations for each client that has custom catalog.
MV_PRODUCT : Summary of extensions and configurations used within each product version.

TEXT triggers: maintains client table extensions information updated between tables.
TMV triggers: to maintain the MV when actual tables are updated.
TMV_COUNT triggers: to maintain the catclient.client_custom_count.
                       (sum of #custom files + custom fields + custom relations)
					 MVs look at this field to determine if a client has or has not a custom catalog.

secuserarea is removed in r10 because user dont need to select subject areas anymore.

====================================================================================
sridhar query:
SELECT * FROM REGCOM.ALL_CLIENT_SC_PRODUCT@DBLINKCRS01QTOREG12Q

select * from REGCOM.ALL_CLIENT_SC_PRODUCT@DBLINKCRU40PTOREG11P
====================================================================================
-- Currently running SQLs in the database:
select PARSING_SCHEMA_NAME, sql_text
from v$sqlarea where users_executing > 0
and PARSING_SCHEMA_NAME not in ('SYS');
====================================================================================
Is there any way I can say that the job should be run between 9 AM - 5 PM everyday, at the
intervals of 15 minutes.

exec dbms_job.submit( :n, 'null;', sysdate, 'case when to_char( sysdate, ''hh24'' ) between ''09''
and ''04'' then sysdate+5/24/60 else trunc(sysdate)+1+9/24 end' );

that should work -- use CASE to say "if between 9am and 4:59:59pm" return 5 minutes later, else
tomorrow

set long 100000
select text from ALL_VIEWS@DBLINKCRTP01TOCRU20P
where view_name like 'HR25_CAND_APP_GENERAL_VW_0001';


====================================================================================
cat *out | grep PAYX_REG | awk -F, '{if($5>100) print $0}'

select SCHEMA_NAME, INSTANCE_NAME, ORGANIZATION_OID, VPD_KEY, PARENT_CODE,
(select isiclientid from racs_r1.org_nonvpd where org_id = ORGANIZATION_OID) isiclientid
from V_CLIENT_LOGON
where 1=1
and PARENT_CODE = ID_CODE
and VPD_KEY in ('PAYXSCH0075252','PAYXSCH0098002')

select CONSTRAINT_NAME, CONSTRAINT_TYPE, STATUS from user_constraints
where TABLE_NAME = 'TIMEPAIR_TAB' and CONSTRAINT_TYPE != 'C';

====================================================================================
SELECT  --a.sid, a.serial#,
a.seq#, --a.event, a.process, a.SCHEMANAME,
a.PROGRAM, a.last_call_et--, a.username--
, b.sql_text
from gv$session a, gv$sql b
WHERE a.status ='ACTIVE'
AND a.sql_id = b.sql_id
--AND upper(b.sql_text) LIKE '%EZLM_REG46_POD01%'
AND a.event = 'enq: TM - contention'
order by 1;



REPLICAT    RUNNING     GRZC250P    00:00:00      01:00:11
REPLICAT    RUNNING     GRZC251P    00:00:00      00:59:25
REPLICAT    RUNNING     GRZC252P    00:00:00      01:07:48
REPLICAT    RUNNING     GRZC253P    00:00:00      00:56:08


select sid, sql_id, blocking_session, event, p2 from gv$session where blocking_session is not null
union
select sid, sql_id, blocking_session, event, p2 from gv$session where sid in (select blocking_session from v$session);

select session_id, lock_type, mode_held, mode_requested, lock_id1, blocking_others
from dba_locks where session_id in (71,135,132) order by last_convert;

select object_id, object_name from dba_objects where object_id = <<P2 from above query>>;

====================================================================================
dev: 10.5.125.146
fit: 10.5.125.208
iat: 172.24.208.104
ipe: 10.5.26.13
uat: 172.24.44.63
prod: 172.20.176.65


DELETE FROM config_pod_mapping;
INSERT INTO config_pod_mapping (id, VALUE)
VALUES ('WS_ENDPOINT', 'http://10.5.125.208/services/jaxws/ISIJWSClientService');
MERGE INTO config_pod_mapping x
USING (SELECT DISTINCT 'RGPOD_' || b2.prd_code || '_' || c2.pod_code AS id
       FROM   catclient            c2
             ,batclientenvironment b2
       WHERE  c2.client_code = b2.client_code) y
ON (x.id = y.id)
WHEN NOT MATCHED THEN
  INSERT (x.id, x.value) VALUES (y.id, nvl('ADPRFIT04_01', ''));
COMMIT;
====================================================================================

R18.5 SOR JOB IN PRODUCTION

-- to initialize r18 sor data
declare
begin
delete from ggate.adpr_client_extensions where PRODUCT_VERSION='185';
        for j in (select distinct a.vpd_key,a.SELLING_REGION_CODE,a.INSTANCE_NAME,a.schema_name,a.parent_code,a.ORGANIZATION_OID,a.wfn_client_f,
                b.TARGET_SCHEMA,b.target_instance,c.o
                from V_CLIENT_LOGON a, adpr_payx_mapping b, appadm.isiclient c
                where a.schema_name=b.source_schema
                and substr(a.instance_name,1,6)=b.source_instance
                and a.ORGANIZATION_OID=c.clientoid(+)
                and a.parent_code=a.id_code)
        loop
            insert into ggate.adpr_client_extensions(
            cidn,reg_pod_code,node_code,product_code,
            product_version,client_desc,source_region_code,source_repl_instance,
            source_schema_name,source_deleted_date, target_deleted_date,target_schema_name,parent_code,
            isi_client_id,organization_oid,replicating,migration_date,hosting_center,extension_flag,catconfig_status,WFN_CLIENT_F) values
            (j.vpd_key,substr(j.TARGET_SCHEMA,9,2)||substr(j.target_schema,15,2),decode(lower(j.target_instance),'cru20p','20',substr(j.target_instance,5,6)),'PAYX2',
            '185','PayExpert',j.SELLING_REGION_CODE,j.INSTANCE_NAME,
            j.schema_name,null,null,j.TARGET_SCHEMA,j.parent_code,
            j.o,j.ORGANIZATION_OID,'Y',sysdate,'DC1','N','N',j.wfn_client_f);
        end loop;
        commit;
end;
/

====================================================================================
where is the payx client ?

set serveroutput on size 1000000
declare
 sql_stmt varchar2(1000);
 val pls_integer;
begin
for i in (
select owner from all_objects where object_name = 'SECURITY_USER' order by 1)
loop
  sql_stmt := 'select count(1) from ' || i.owner || '.security_user where UPPER(USER_ID) like ''%@WOLCOTT''';
  execute immediate sql_stmt into val;
  dbms_output.put_line(i.owner || ' - ' || val);
end loop;
end;
/


====================================================================================
sqlplus adpr_cruvpd/cruvpd@wfc21p
call wf4_sec_context_0001.set_app_context('JMARSH@HAPAYROLL','ER','G4SE3AG3V83007BF',
'G4SE3AG3V8300053','WF4_PAY_STATEMENTS_VW_0001',
'WF4_PAY_STATEMENTS_VW_0001.COMPANY_CODE#=#''V2X'' ,WF4_PAY_STATEMENTS_VW_0001.PAY_DATE#>=#TO_DATE(''11/01/2000'', ''MM/DD/YYYY''),
WF4_PAY_STATEMENTS_VW_0001.PAY_DATE#<=#TO_DATE(''11/30/2012'', ''MM/DD/YYYY'')','',
'2011144,1070,186,2006210','1070','en_US','en_US','0','1234080091331');

select wf4_pol_for_View_0001.date_filter_for_view('a','b') from dual

set autot trace stat
select * from wf4_pay_Statements_vw_0001;


====================================================================================
columns with 'DEDUCTION AMOUNT'
col tab_code format a40
col col_code format a30
col viewname format a30
col col_fieldname format a60
col col_label format a60
set lines 200

SELECT --tab_code,
(SELECT y.TAB_TABLE FROM CATTABLE Y WHERE Y.TAB_CODE = X.TAB_CODE) viewname,
col_fieldname,col_code, col_label
 FROM CATCOLUMN  X
 WHERE tab_code like '%@WFN@@3' and
 upper(COL_LABEL) LIKE '%DED%AMOUNT%' and
 col_datatype = 'NUM'
 order by 1, 3;

====================================================================================

How many templates this client has?

col prds forma a20
select substr(qt.tab_code, instr(qt.tab_code, '@@')) prds, count(1)
from qryquery q, qrytable qt
where q.qry_key = qt.qry_key
and q.qry_active = 't'
and q.client_code = 'VANETIME2U'
and (qt.tab_code like '%@@HRII@@152' or qt.tab_code like '%@@HRII@@153' or qt.tab_code like '%@@EET@@63')
group by rollup(substr(qt.tab_code, instr(qt.tab_code, '@@')))
order by 1;



====================================================================================
This is the process we follow to publish sample reports:

a.	[WFN] QA team will have sample templates ready and validated
b.	[ADPR] Change them to real sample reports in FIT

   the developers create or modify them as public or private
   then we convert to sample - some db level adjustments

c.	[ADPR] Extract the English values to some tables/spreadsheet
d.	[ADPR] Send the spreadsheet to the vendor
e.	[Vendor] Send back the translated values
f.	[ADPR] Import data back into our tables
g.	[ADPR] Load translations back to the original sample reports
h.  [ADPR] Create a package to deliver one or several reports

====================================================================================
HELP URL:
select PAR_DEFAULT from catparam where PAR_CODE='HELP';
====================================================================================
top 20% of check data clients;

set lines 180
col p format a8
col s format a20
col c format a30
col c format 9999999


select s, v, c, to_char(p, '00.000') p, sum(p) over(order by p) rt from (
select s, v, c, 100*ratio_to_report(c) over() p from CHECK_VPD_CNT order by c
) order by p;




====================================================================================
-- Those getting pod code changed
WITH gtt AS (
SELECT /*+ materialize */
clnt,
SubStr(cmd, InStr(cmd, ',', 1, 2)+3,InStr(cmd, ',', 1, 3)-InStr(cmd, ',', 1, 2)-4 ) pod_code
 FROM client_config_cmds_gtt)
SELECT  c.clnt, c.pod_code, b.pod_code
FROM
gtt c,
webrepadmin.catclient@dblinkcrtp01tocatp01 b
WHERE b.client_code = c.clnt
AND b.pod_code != c.pod_code

====================================================================================
Steve conn report for all r9->r12 migrating clients in MAS
C:\Users\canakalv\Desktop\w\SUPPORT\Client_products_sc_bu_reports.sql
C:\Users\CanakalV\Desktop\w\SUPPORT\Client_products_sc_bu_reports_NEW.sql

====================================================================================
SELECT inst_key, 'INSERT INTO batinstance VALUES (''' ||  to_char(3150+inst_key) ||''', '''||inst_sid||''', '''|| inst_desc||''', '''|| inst_user||''', '''||
 inst_password||''', '''|| inst_host||''', '''|| inst_port||''', '''|| 'http://11.3.250.69/ReportingWS/' ||''', '''||inst_maxreq||''', '''||
 inst_tns_rac||''', '''|| inst_shortname||''', '''|| inst_wallet_dir || ''');'
FROM batinstance ORDER BY inst_key;

====================================================================================
We have to bounce the cru04p DB, because of latch issue.

NAME                                  COUNT
-------------------------------- ----------
Active refresh sessions:                104
Sessions waiting for JS latch:           94


$ srvctl status database -d cru04p
Instance cru04p01 is running on node dc2prf002db04
Instance cru04p02 is running on node dc2prf002db05
Instance cru04p03 is running on node dc2prf002db03

$ srvctl status service -d cru04p
Service cru04p_svc1 is running on instance(s) cru04p01, cru04p03


====================================================================================
====================================================================================

Program     Status      Group       Lag           Time Since Chkpt

create table gg_status(
 gg_host    varchar2(20),
 gg_product varchar2(10),
 gg_program varchar2(10),
 gg_status varchar2(10),
 gg_group  varchar2(10),
 gg_lag    varchar2(10),
 gg_chkp   varchar2(10),
 gg_ipaddr  varchar2(15),
 last_upd  timestamp default systimestamp
);

create index idx1_gg_status on gg_status (gg_host, gg_product, gg_group);

etime
ezlm
acs
ts
payx
registry




http://www.guardian.co.uk/environment/2010/jan/04/woodburning-stoves-the-truth
http://blog.yannickjaquier.com/oracle/goldengate-hands-on-in-one-hour.html


File Name in UI	Table Name in DB		Field Label in UI	Col name in DB
Employee Basic Info		CPD_PERSON		Rate Type			CPD_PERSON.RATE_TYPE_CODE		CPD_PERSON.HOURLY_IND
Employee Basic Info		CPD_PERSON		Pay Rate			CPD_PERSON.PAY_RATE				CPD_PERSON.HOURLY_RATE
Employee Basic Info		CPD_PERSON		Reference Pay Rate	CPD_PERSON.REF_PAY_RATE			CPD_PERSON.REF_HOURLY_RATE
Employee Job History	CPD_JOB_HISTORY	Pay Type 			CPD_JOB_HISTORY.PAY_TYPE_CODE	CPD_JOB_HISTORY.HOURLY_IND
Employee Job History	CPD_JOB_HISTORY	Pay Rate			CPD_JOB_HISTORY.PAY_RATE		CPD_JOB_HISTORY.HOURLY_RATE
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

select *
  from secrole
 where role_key in
       (select distinct role_key
          from secrolecol
         where tab_code in
               (select distinct tab_code
                  from qrytable
                 where qry_key in (select qry_key
                                     from qryquery
                                    where qry_ext_templateid like 'VAN%'
                                      and qry_active = 't'
                                      and qry_mode in ('SMP', 'STD'))));

----------------------

set softdelete
SELECT 'UPDATE catclient SET pod_code = ''SOFTDELETE'' WHERE client_code = ''' || client_code || ''';'
FROM (
SELECT Count(A.CLIENT_CODE) FROM
webrepadmin.catclient@dblinkcrtp01tocrw21p a,
webrepadmin.qryquery@dblinkcrtp01tocatp01 ab,
webrepadmin.catclient@dblinkcrtp01tocatp01 b
WHERE a.pod_code = 'PROD' AND
b.pod_code ='SOFTDELETE' AND
a.client_code = b.client_code
) ORDER BY 1;

----------------------------------
Sample reports pacakge:
 select * from admscriptversion where svr_description like '%ADPR02.00%WFNMESMP.12.0%' order by svr_timestamp desc;


--------------------------------------------
Remove customs for a single client:

SELECT bcg.* from
batconfigurationgroup bcg,
batclientconfiguration bcc
WHERE bcg.cgg_key = bcc.cgg_key
AND bcc.client_code = 'GDS2';

SELECT bc.CFG_TABLE, bc.CFG_FIELDNAME, bcn.CFG_LONG_LABEL
FROM batclientconfiguration bcc, batconfiguration bc, BATCONFIGURATION_NLS bcn
WHERE bcc.cgg_key = bc.cgg_key
AND bc.cfg_key = bcn.cfg_key
AND bc.cfg_table like 'WS_EMP_BASIC_INFO_VW'
AND bcc.client_code = 'GDS2';

select * from batclientconfiguration where  CLIENT_CODE='TMSFIT15';
delete from batclientconfiguration where CGG_KEY=2900 and CLIENT_CODE='TMSFIT15';
DELETE FROM BATCONFIGURATION_NLS where CFG_KEY in (
 select CFG_KEY from BATCONFIGURATION WHERE CGG_KEY=2900);
delete from BATCONFIGURATION WHERE CGG_KEY=2900;
delete from batconfigurationgroup WHERE CGG_KEY=2900;

SELECT bc.CFG_TABLE, bc.CFG_FIELDNAME, bcn.CFG_LONG_LABEL
FROM batclientconfiguration bcc, batconfiguration bc, BATCONFIGURATION_NLS bcn
WHERE bcc.cgg_key = bc.cgg_key
AND bc.cfg_key = bcn.cfg_key
AND bcc.client_code = 'TMSFIT15'
and bc.CFG_TABLE = 'WS_EMP_PERF_GOAL_VW';

---------------------------------------------------------

CLIENTS WITH ACS MISMATCH AND RAN REPORTS IN LAST 2 WEEKS:

WITH clintsa AS (
SELECT Upper(a.isi_client_id) isiclientid, a.client_oid
FROM
(SELECT isi_client_id, client_oid FROM (
SELECT DISTINCT Upper(isi_client_id) isi_client_id, client_oid
FROM cru_user.adpr_portal_mas_client_vw@DBLINKCRTP01TOSDR01P
minus
SELECT DISTINCT Upper(isi_client_id) isi_client_id, client_oid
FROM ACS_MAS_COMMON.acs_client_pod_map@dblinkcrtp01tocru20p)
) a
WHERE EXISTS
(SELECT 1 FROM
  v_client_logon_local x
  WHERE a.client_oid = x.organization_oid
        AND x.activation_flag = '1')
)
SELECT isiclientid, client_oid FROM clintsa a
WHERE EXISTS (
 sELECT 1 FROM webrepadmin.catclient@dblinkcrtp01tocatp01 X,
               webrepadmin.qryquery@dblinkcrtp01tocatp01 Y,
               webrepadmin.secsession@dblinkcrtp01tocatp01 z
 WHERE A.ISICLIENTID = X.CLIENT_CODE AND X.POD_CODE = 'PROD'
 AND x.CLIENT_CODE = y.client_code AND y.qry_active = 't'
 AND x.client_code = z.client_code AND z.session_timestamp > To_Date('05/11/2013', 'MM/DD/YYYY'))
UNION
SELECT isiclientid, client_oid FROM clintsa a
WHERE EXISTS (
 sELECT 1 FROM webreppilot.catclient@dblinkcrtp01tocatp01 X,
 webreppilot.qryquery@dblinkcrtp01tocatp01 y,
 webreppilot.secsession@dblinkcrtp01tocatp01 z
 WHERE A.ISICLIENTID = X.CLIENT_CODE AND X.POD_CODE = 'PILOT'
 AND x.CLIENT_CODE = y.client_code AND y.qry_active = 't'
 AND x.client_code = z.client_code AND z.session_timestamp > To_Date('05/11/2013', 'MM/DD/YYYY'))
UNION
SELECT isiclientid, client_oid FROM clintsa a
WHERE EXISTS (
 sELECT 1 FROM webrW.catclient@dblinkcrtp01tocatp02 X,
 webrW.qryquery@dblinkcrtp01tocatp02 y,
 webrW.secsession@dblinkcrtp01tocatp02 z
 WHERE A.ISICLIENTID = X.CLIENT_CODE AND X.POD_CODE = 'RWADPR'
 AND x.CLIENT_CODE = y.client_code AND y.qry_active = 't'
 AND x.client_code = z.client_code AND z.session_timestamp > To_Date('05/11/2013', 'MM/DD/YYYY'))
UNION
SELECT isiclientid, client_oid FROM clintsa a
WHERE EXISTS (
 sELECT 1 FROM webrepadmin.catclient@dblinkcrtp01tocrw21p X,
 webrepadmin.qryquery@dblinkcrtp01tocrw21p y,
 webrepadmin.secsession@dblinkcrtp01tocrw21p z
 WHERE A.ISICLIENTID = X.CLIENT_CODE AND X.POD_CODE = 'WFN4_PROD'
 AND x.CLIENT_CODE = y.client_code AND y.qry_active = 't'
 AND x.client_code = z.client_code AND z.session_timestamp > To_Date('05/11/2013', 'MM/DD/YYYY'))


 =================================================
                                 We need following information for P to Q process.

1)SOURCE ISICLIENT ID.
2) SOURCE ISICLIENT ORGOID
3)SOURCE VANTAGE DB instance.
4)TARGET ISICLIENT ID
5) TARGET ISICLIENT ORGOID
6) TARGET VANTAGE DB instance.

ADPR P to Q process steps.


These are the steps:
1.            PROD: export SOURCE client using ME – ADPR Engineering
a.            We don’t need executions, so need to set “output.days=30” on “conf/migration.properties” file.
2.            UAT: run the procedure to wipe down TARGET client data:
a.            exec prc_delete_client('CLIENTE_CODE_TARGET','t');
b.            This procedure will delete all client objects: reports, executions, schedulers, folders, users, preferences and sessions.
3.            UAT: import the SOURCE client using ME (using the same client code from source) – ADPR Engineering
4.            UAT: update client code and append UAT to users and emails:
a.            exec prc_vantage_update_client('CLIENT_CODE_SOURCE','CLIENT_CODE_TARGET', 'UAT');

=======================================


exec configure_client('NYPOST', '1830', 'DCPILOT','f', '', 'NASPORTAL', '202', 'f', '', '0F18AC8F6B809C52');
exec configure_client('NYPOST', '1830', 'DCPILOT','t', '_0287', 'BASE', '185', 't', '@DBLINK2CRU', '0F18AC8F6B809C52');
MERGE INTO BATCLIENTENVIRONMENT B
USING (SELECT 'NYPOST' AS CLIENT_CODE , 'BASE' AS prd_code, '4000' AS inst_key FROM dual) X
ON (b.client_code = x.client_code AND b.prd_code = x.prd_code AND b.inst_key = x.inst_key)
WHEN MATCHED THEN
  UPDATE SET b.CPE_KEY = 4, b.BCE_DBLINK_FLAG = 'f', b.BCE_DBLINK_VALUE = '', b.BCE_SCHEMA='NEWYORKP'
WHEN NOT MATCHED THEN
  INSERT (BCE_KEY,CLIENT_CODE,PRD_CODE,INST_KEY,CPE_KEY,BCE_DBLINK_FLAG,BCE_DBLINK_VALUE,BCE_SCHEMA)
    VALUES (SEQ_BCE_KEY.NEXTVAL,'NYPOST','BASE',4000,4,'f','','NEWYORKP');
MERGE INTO BATCLIENTENVIRONMENT B
USING (SELECT 'NYPOST' AS CLIENT_CODE , 'BASE' AS prd_code, '4001' AS inst_key FROM dual) X
ON (b.client_code = x.client_code AND b.prd_code = x.prd_code AND b.inst_key = x.inst_key)
WHEN MATCHED THEN
  UPDATE SET b.CPE_KEY = 5, b.BCE_DBLINK_FLAG = 'f', b.BCE_DBLINK_VALUE = '', b.BCE_SCHEMA ='NEWYORKPCTEST'
WHEN NOT MATCHED THEN
INSERT (BCE_KEY,CLIENT_CODE,PRD_CODE,INST_KEY,CPE_KEY,BCE_DBLINK_FLAG,BCE_DBLINK_VALUE,BCE_SCHEMA)
    VALUES (SEQ_BCE_KEY.NEXTVAL,'NYPOST','BASE',4001,5,'f','','NEWYORKPCTEST');
COMMIT;


====================================

HOW TO GATHER TRACE:

sqlplus hwse_admin/hwse_admin@cru02q
alter session set tracefile_identifier=HWSE0005TEST;
alter session set timed_Statistics=true;
alter session set statistics_level=all;
alter session set max_dump_file_size=unlimited;
exec dbms_monitor.session_trace_enable(null,null,true,true);
exec HWSE_ADMIN.HWSE_REFRESH('HWSE_REG0005');
select ‘close cursor’ from dual;
exit;

==============================================
How I ran AWR report:

SELECT * FROM gv$database

select * from dba_hist_snapshot WHERE INSTANCE_NUMBER= 2 order by snap_id desc

select *
from table(dbms_workload_repository.awr_report_text(3403570398,2,25740,25741));

select output from table(dbms_workload_repository.awr_report_text( :dbid, :inst_num, :bid, :eid, :rpt_options ))


select * from table(dbms_xplan.display_awr('c3uxb66x3kswf',null,null,'ALL'));
select * from table(dbms_xplan.display_awr('SQL_ID',null,DBID,'ALL'));

===============================================

In order to prevent these tickets getting stalled, please try the following resolution options prior to forwarding the ticket to me.  If any of the pending tickets are EHRMS or EHRMS/HWSE cross products, please go back and attempt these steps.

EHRMS or EHRMS/HWSE cross products semi join hint:

•	Open the request in the sql tools
•	Add the following hint to the sql just after the first SELECT clause:
/*+ Opt_param(‘_always_semi_join’,’off’) */
•	Run report, if successfully executes with the hint:
o	R9:  Attach the hinted sql to the req as the resolution
o	R12:  An update on qryquery can be used to resolve
?	Get the executing qry_key: select qry_key from batreq where req_key=’yourReqKey’;
?	Determine the parent qry_key: select qry_key_versionof from qryquery where qry_key=’yourQryKey’;
?	Have hosting run update:
update qryquery set qry_session_sql_setup = 'begin execute immediate(''alter session set "_always_semi_join"=off''); end;' where qry_key_versionof = 'yourParentQryKey';

EHRMS or EHRMS/HWSE cross products rewrites:

If the hint process did not work, the next step is to rewrite the sql.

•	R12 – Send to Fernando, he has an automated way to perform rewrites.
•	R9 – I will have to rewrite manually

=============================================
DB parallel install

create or replace procedure hwse_election_ind_change(schema_name varchar2)
authid current_user
as
 vstr varchar2(1000);
 vcnt pls_integer;
begin
  select count(1) into vcnt from all_indexes where index_name = 'IND1_ELECTION_DATA_VW' and owner = schema_name;
  if (vcnt <> 0) then
    vstr := 'DROP INDEX ' || schema_name || '.IND1_ELECTION_DATA_VW';
    execute immediate vstr;
  end if;

  vstr := 'CREATE INDEX ' || schema_name || '.IND1_ELECTION_DATA_VW ON ' || schema_name || '.ELECTION_DATA_VW (PARTICIPANT_ID, BENEFIT_AREA_ID, CLIENT_ASSIGNED_ID, CIDN) TABLESPACE INDEX1';
  execute immediate vstr;
end;
/


declare
  vjobname varchar2(100);
  vjobcmd varchar2(1000);
begin
for i in (select distinct index_owner from all_ind_columns where index_name = 'IND1_ELECTION_DATA_VW'
--and index_owner in (select distinct TARGET_SCHEMA_NAME from adpr_client_extensions where REPLICATING is null)
)
loop

  vjobname := 'ELEIND_PKGINSTALL_' || i.index_owner;
  vjobcmd := 'BEGIN hwse_election_ind_change(''' || i.index_owner || '''); END;';

  DBMS_SCHEDULER.create_job (
    job_name        => vjobname,
    job_type        => 'PLSQL_BLOCK',
    job_action      => vjobcmd,
    start_date      => SYSTIMESTAMP + INTERVAL '10' minute,
    enabled         => TRUE,
    comments        => 'Job defined for ELEIND_PKGINSTALL');

end loop;
end;
/


How to check progress:
----------------------
sqlplus HWSE_ADMIN/HWSE_ADMIN@cru02s
SELECT count(1) FROM dba_scheduler_jobs WHERE JOB_NAME LIKE 'ELEIND_PKGINSTALL%';

---> the above sql would give 0 records after the installation is complete.
     Keep checking until it is returns 0 records. It may take 30-40 mins to complete.
     After it returns 0 records, run below command to clean up:

sqlplus HWSE_ADMIN/HWSE_ADMIN@cru02s
drop procedure hwse_election_ind_change;
exit


===================================================
  How to check hrb-payx cross product reports with their webservice tables:

select min(b.req_timestamp)
--b.req_status, C.CLIENT_CODE, b.req_key
from
webrepadmin.batreq@dblinkcrtp01tocrw21p b,
webrepadmin.CATCLIENT@dblinkcrtp01tocrw21p C,
webrepadmin.qryquery@dblinkcrtp01tocrw21p q,
webrepadmin.qrytable@dblinkcrtp01tocrw21p qt
where 1=1
and b.client_code = c.client_code
and b.req_status = 'OK'
and c.pod_code = 'WFN4_PROD'
and q.client_code = b.client_code
and q.qry_key = b.qry_key
and qt.qry_key = q.qry_key
and qt.tab_code like '%@@HRB@@25'
AND EXISTS (SELECT 1 FROM
webrepadmin.QRYQUERY@dblinkcrtp01tocrw21p QX,
webrepadmin.QRYTABLE@dblinkcrtp01tocrw21p QTX
WHERE QX.QRY_KEY = QTX.QRY_KEY AND QTX.TAB_CODE LIKE '%@@PAYX2@@185'
AND qt.qry_key = q.qry_key and qx.qry_key = q.qry_key
)
--and b.req_timestamp > trunc(sysdate)-1
and b.req_key in (
  select distinct req_key from
  cruvpd.wsrequest_130311@dblinkcrtp01tocru20p
);

=================================================
SELECT /*csv*/ * FROM scott.emp;
SELECT /*xml*/ * FROM scott.emp;
SELECT /*html*/ * FROM scott.emp;
SELECT /*delimited*/ * FROM scott.emp;
SELECT /*insert*/ * FROM scott.emp;
SELECT /*loader*/ * FROM scott.emp;
SELECT /*fixed*/ * FROM scott.emp;
SELECT /*text*/ * FROM scott.emp;
=================================================
Find out clients suitable for source enabling: (replicatin elimination)

SELECT * FROM (
SELECT
Row_Number() OVER (PARTITION BY instance_name ORDER BY numrep DESC, client_code ASC) rn, a.*
FROM (
WITH catalogs AS (
SELECT client_code,client_orgoid, 'WFN4_PROD' pod,
(SELECT Count(1) FROM webrepadmin.qryquery@dblinkcru40ptocrw21p x
  WHERE x.client_code = a.client_code AND x.qry_active = 't') numrep
FROM webrepadmin.catclient@dblinkcru40ptocrw21p a
WHERE pod_code = 'WFN4_PROD'
UNION
SELECT client_code,client_orgoid, 'MAS_PROD1' pod,
(SELECT Count(1) FROM ADPRMASPRD01.qryquery@dblinkcru40ptocrw21p x
  WHERE x.client_code = a.client_code AND x.qry_active = 't') numrep
FROM ADPRMASPRD01.catclient@dblinkcru40ptocrw21p a
WHERE pod_code = 'MAS_PROD1'
UNION
SELECT client_code,client_orgoid, 'MAS_PROD2' pod,
(SELECT Count(1) FROM ADPRMASPRD02.qryquery@dblinkcru40ptocrw22p x
  WHERE x.client_code = a.client_code AND x.qry_active = 't') numrep
FROM ADPRMASPRD02.catclient@dblinkcru40ptocrw22p a
WHERE pod_code = 'MAS_PROD2'
)
SELECT DISTINCT c.pod, c.client_code, p.client_name, '''' || p.selling_region_code selling_region_code, '''' || p.parent_code parent_code, c.numrep,
       Decode(p.activation_flag, 1, 'ACS', 'NON-ACS') acs,
       p.schema_name, p.instance_name,
       (SELECT DISTINCT source_enabled FROM adpr_client_extensions y
        WHERE y.ORGANIZATION_OID = p.ORGANIZATION_OID
        AND product_code = 'PAYX2' AND product_version = '185') source_enabled
FROM catalogs c, t10 p, curr_isi_client_load i
WHERE p.organization_oid = c.client_orgoid
AND p.id_code = p.parent_code
AND i.org_id = p.organization_oid
AND i.product_code = 'PAYX2'
AND NOT EXISTS
  (SELECT 1 FROM curr_isi_client_load x
    WHERE x.org_id = p.organization_oid
    AND x.product_code IN ('NASPORTAL', 'HRIIPORTAL', 'WFNPORTAL'))
AND NOT EXISTS
  ( SELECT 1 FROM  client_config_exclude x
    WHERE x.org_oid = p.organization_oid)
--AND Decode(p.activation_flag, 1, 'ACS', 'NON-ACS') = 'ACS'
AND c.numrep < 500
) a WHERE source_enabled != 'Y'
) WHERE rn < 11
ORDER BY instance_name, rn;








Generate commands to source enable:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
sqlplus ggate/ggate@cru40p

-- Make sure there are no multiple vpd keys for the same client.
insert into adpr_secusr.PAYX_CLIENT_DETAILS@dblinkcru40ptopxc15p
select distinct v.vpd_key, v.schema_name, v.organization_oid, r.ISICLIENTID, sysdate, sysdate
from v_client_logon v, racs_r1.org_nonvpd r
where v.id_code = v.parent_code and r.org_id = v.organization_oid
and upper(r.isiclientid) in (
<<client list >>
) order by 2,1;
commit;


update adpr_client_extensions set source_enabled = 'Y' where upper(isi_client_id) in (
<<client list >>
);
commit;


-- GENERATE BELOW COMMANDS WITH masconf and cross check with sorconf
sqlplus webrepadmin/webrepadmin@CRW21P
set serveroutput on
exec configure_client('ADVATECINT', '51', 'MAS_PROD1','t', '_0001', 'PAYX2', '185', 'f', '', 'CA00BFE00BA17B6B', '');
update batclientproduct set BCP_HAS_PAYX2_ACS_INTEGRATION = 't' where client_code = 'ADVATECINT' and prd_code = 'PAYX2' and ver_code = '185';
  :
  :
commit;

sqlplus ADPRMASPRD01/ADPRMASPRD01@CRW21P
set serveroutput on
exec configure_client('ADVATECINT', '51', 'MAS_PROD1','t', '_0001', 'PAYX2', '185', 'f', '', 'CA00BFE00BA17B6B', '');
update batclientproduct set BCP_HAS_PAYX2_ACS_INTEGRATION = 't' where client_code = 'ADVATECINT' and prd_code = 'PAYX2' and ver_code = '185';
  :
  :
commit;



========================================================

payxapp.clientdatabase@DBLINKCRTP01TOPXS01P
==========================================================

URL: https://tms.adp.com/public/index.htm

Login: csoaressnapprod@snapon
Password: Pa55word

============================================================
replication elim testing:

sqlplus skipvpd/skipvpdadpadp@pxc02y
select COMPANY_CODE, count(1) from VPDCLSCH0075000046.check_hdr
where vpd_key in ( select vpd_key from VPDCLSCH0075000046.security_user
where upper(substr(user_id, instr(user_id, '@')+1)) = 'INNOVMKT') group by company_code order by 2;
============================================================

-- WFN external standard reports
select s.*
     , cr.rtb_resource_group
     , r.res_type
     , r.res_oid
     , r.res_name
  from (
          select q.qry_key
                ,q.qry_name
                ,q.qry_active
                ,q.qry_ext_templateid
                ,(select distinct substr(tab_code, instr(tab_code, '@@') + 2) from qrytable where qry_key = q.qry_key) as prd
                ,(select distinct tab_code from qrytable where qry_key = q.qry_key) as tab_code
            from qryquery q
          where q.qry_class = 'EXT'
            and q.qry_mode = 'STD'
            and exists (select 1 from qrytable x where x.qry_key = q.qry_key and (x.tab_code like '%@@WFNPAYX@@4' or x.tab_code like '%@@WFNPAYX@@5'))
       ) s
       , catresourcetable cr
       , catresource r
where s.tab_code = cr.tab_code
   and cr.res_key = r.res_key
order by qry_name
       , qry_ext_templateid
       , rtb_resource_group
       , res_type;


-- WFN sample reports
select s.*
  from ( select q.qry_key
               ,q.qry_name
               ,q.qry_active
               ,q.qry_class
               ,q.qry_ext_templateid
               ,(select res_name from catresource where res_key = q.res_key) res_name
               ,(select distinct substr(tab_code, instr(tab_code, '@@') + 2) from qrytable where qry_key = q.qry_key) as prd
           from qryquery q
          where q.client_code = 'ADPADMIN'
            and q.qry_mode = 'SMP'
            and q.user_key = (select user_key from secuser where user_login = 'EDUK3ADMIN@ADP')
            and q.qry_status = 90
            and q.qry_active = 't'
       ) s
where (prd = 'WFN@@4' or prd = 'WFN@@5' or prd is null)
order by 7,2,6,5;


-- Vantage standard reports
select s.*
  from ( select q.qry_key
               ,q.qry_name
               ,q.qry_active
               ,q.qry_ext_templateid
           from qryquery q
          where q.client_code = 'ADPADMIN'
            and q.qry_mode = 'SMP'
            and q.user_key = (select user_key from secuser where user_login = 'FBRESSLER@ADP')
            and q.qry_status = 90
            and q.qry_active = 't'
		--	and q.qry_name like 'CA Sick Pa%'
       ) s
order by 2;

select * from qryquery q where client_code = 'ADPADMIN' and qry_mode = 'SMP'
and qry_name like 'PR-Audit-Deceased Employees%'
and q.user_key = (select user_key from secuser where user_login = 'FBRESSLER@ADP')
and qry_active = 't'
and qry_status = '90';

=========================================================
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:user="http://users.jws.registry.adp.com/">
   <soapenv:Header>
      <user:ClientID>SEPRIMARY</user:ClientID>
      <user:OrgOID></user:OrgOID>
      <user:callerID>NETSECURE</user:callerID>
      <user:CallingAppID>NETSECURE</user:CallingAppID>
   </soapenv:Header>
   <soapenv:Body>
      <user:getRoles>
         <!--Optional:-->
         <associateOID></associateOID>
         <!--Optional:-->
         <userID>PSTONEBURNER@SEPRIMARY</userID>
         <!--Optional:-->
         <productCode>CRT</productCode>
      </user:getRoles>
   </soapenv:Body>
</soapenv:Envelope>





-- # of configured clients on this pod
select count(distinct client_code) from
ggate.curr_isi_client_load@dblinkcatp02tocrtp01
where client_code in (
select distinct c.client_code
from catclient c, batclientproduct bcp,  batclientenvironment bce
where c.client_code = bcp.client_code
and c.client_code = bce.client_code
and c.pod_code = (select pod_code from batpod where pod_current = 't')
);


-- # of clients with at least one active report template
select count(distinct client_code) from
ggate.curr_isi_client_load@dblinkcatp02tocrtp01
where client_code in (
select distinct c.client_code
from catclient c, batclientproduct bcp,  batclientenvironment bce, qryquery q
where c.client_code = bcp.client_code
and c.client_code = bce.client_code
and c.pod_code = (select pod_code from batpod where pod_current = 't')
and q.client_code = c.client_code
and q.QRY_ACTIVE = 't');

-- # of clients who logged in at least once
select count(distinct client_code) from
ggate.curr_isi_client_load@dblinkcatp02tocrtp01
where client_code in (
select distinct c.client_code
from catclient c, batclientproduct bcp,  batclientenvironment bce, secsession s
where c.client_code = bcp.client_code
and c.client_code = bce.client_code
and c.pod_code = (select pod_code from batpod where pod_current = 't')
and s.client_code = c.client_code);

============================================

#!/bin/ksh
# set array called nameservers
set -A nameservers 192.168.1.1 192.168.1.5 202.54.1.5

echo " num elements: " ${#nameservers[@]

# print all name servers
for i in ${nameservers[@]
do
	echo $i
done

========================================================




select DISTINCT (SELECT pod_code FROM batpod WHERE pod_current = 't') pod_code
  , '''' || c.client_code,
  (select decode(count(1), 0, 'n', 'y')
   from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
   where x.client_code = c.client_code
   and x.product_code = 'PAYX2') has_payx,
  (select decode(count(1), 0, 'n', 'y')
   from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
   where x.client_code = c.client_code
   and x.product_code = 'EZLABORMANAGER') has_ezlm,
   (select decode(count(1), 0, 'n', 'y')
   from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
   where x.client_code = c.client_code
   and x.product_code = 'HRB') has_hrb,
   (select decode(count(1), 0, 'n', 'y')
   from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
   where x.client_code = c.client_code
   and x.product_code in ('IPAY', 'IPAYERADMIN')) has_ipay,
   (select decode(count(1), 0, 'n', 'y')
   from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
   where x.client_code = c.client_code
   and x.product_code in ('MYRESOURCE', 'MYTOTALSOURCE')) has_ts,
   (select decode(count(1), 0, 'n', 'y')
   from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
   where x.client_code = c.client_code
   and x.product_code in ('NASPORTAL')) has_enterprise,
   (select decode(count(1), 0, 'n', 'y')
   from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
   where x.client_code = c.client_code
   and x.product_code in ('HRIIPORTAL')) has_vantage,
   (select decode(count(1), 0, 'n', 'y')
   from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
   where x.client_code = c.client_code
   and x.product_code in ('TMS')) has_tms
from catclient c, batclientenvironment bce
where 1=1
and c.pod_code = (select pod_code from batpod where pod_current = 't')
and c.client_code = bce.client_code
and  exists (
  select 1 from qryquery q
  where q.client_code = c.client_code
  and q.qry_active = 't')
and exists (
  select 1 from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
  where x.client_code = c.client_code
  and x.PRODUCT_CODE in ('NASPORTAL', 'HRIIPORTAL', 'TMS')
)
and exists (
  select 1 from ggate.curr_isi_client_load@dblinkcrw21ptocru40p x
  where x.client_code = c.client_code
  and x.product_code = 'CRT'
) ORDER BY 2;



==================================================================
-- Failed SDG reports:
select req_key
  from batreq b
inner join batsched_audit d on d.qry_key = b.qry_key
                            and d.user_key = b.user_key
where d.SDG_KEY is not null
   and b.req_status in ('OK', 'OK+')
   and b.req_active = 't'
   and b.req_timestamp < (systimestamp - 0.07)
   and b.req_timestamp > sysdate - 1
   and not exists
(select 1 from batsdgtracking where req_key = b.req_key)
   and (b.req_timestamp > d.sch_eff_start and
       (b.req_timestamp < d.sch_eff_start or d.sch_eff_start is null))
order by req_timestamp desc;

===========================================================

GG Compare and sync:
ggate@dc2prcrptgg1:/ggate01/dbtools/payx/comp18> ./mtbcmp18.sh vpdkey PAYXSCH0031013
172.24.32.206
to synch up: ./syncup.sh




-- KILL GG COMPARE SCRIPTS
SELECT 'ALTER SYSTEM KILL SESSION '''||a.sid||', '||a.serial#||''';', a.last_call_et/60
from gv$session a, gv$sql b
WHERE a.status ='ACTIVE'
AND a.sql_id = b.sql_id
AND Upper(username) = 'GGATE'
AND a.osuser = 'www' AND a.machine = 'dc2prcrptetl2'
AND b.sql_text LIKE '%dual%'
 order by 1;
======================================================

COMPARE COUNT SQL:
select '###,TIBINDEPENDENTBANKERS,EZLM_REG31_POD01,dblinkcru10ptozc201p,34630,TIB1,USER_TAB,' ||
(s-t) from
( SELECT (SELECT COUNT(1) cnt FROM TIBINDEPENDENTBANKERS.TIMEPAIR_TAB@dblinkcru10ptozc201p ) s,
         (SELECT COUNT(1) cnt FROM EZLM_REG31_POD01.TIMEPAIR_TAB WHERE cidn = '34630') t
  FROM dual)
WHERE t!=s

======================================================

SELECT custid,
            isiclientid,
            datacenterid,
            server,
            userid,
            bulkloadafter,
            creationdate,
            --eienabled,
            version,
            orgid
       FROM (
	   SELECT cc.custid,
            cc.isiclientid,
            cc.datacenterid,
            db.server,
            db.userid,
            a.bulkloadafter,
            to_date('1/1/2011','DD/MM/YYYY'),
            cc.ENABLEOIDPROCESSING,
            db.version,
            cc.ORGID
       FROM CUSTCONNECT.custconnect_tab@DBLINKCRS01STOZS002S cc
            INNER JOIN (SELECT custid,
                               server,
                               userid,
                               'v18' AS version
                          FROM v18config.customerdatabase_tab@DBLINKCRS01STOZS002S db
                        UNION ALL
                        SELECT custid,
                               server,
                               userid,
                               'v19' AS version
                          FROM v19config.customerdatabase_tab@DBLINKCRS01STOZS002S db) db
               ON db.custid = cc.custid
            INNER JOIN COMMANDCENTER.ALLCONFIGS@DBLINKCRS01STOZS002S ac
               ON ac.custid = cc.custid
            LEFT OUTER JOIN CUSTCONNECT.adpreportingintegration_tab@DBLINKCRS01STOZS002S a
               ON a.custid = cc.custid
   ORDER BY cc.custid
	   )
   ORDER BY custid;
=========================================================

pstree -G
cat /proc/sys/kernel/thread-max
strace -o output.txt ping 10.21.47.51
lsof  -- list of open files.. any file open by current running processes

ifconfig -a  ## assigns an address to a n/w interface
tcpdump -i eth2
netstat -an
netstat -tap   ## What programs are serving from your system.. to check rogue connection
===========================================================
DELETE FROM config_pod_mapping
WHERE rowid IN (
SELECT rowid FROM config_pod_mapping
MINUS
SELECT MAX(rowid) FROM config_pod_mapping GROUP BY id
);

===========================================================
insert into secsession (session_id, val_name, val_value)
select session_id, val_name, UTL_RAW.CAST_TO_VARCHAR2(val_value)
from secsessionvallong where session_id = '1325487457911' and val_name = 'HTTP_PROFILEDN';
commit;

select session_id, val_name, UTL_RAW.CAST_TO_VARCHAR2(val_value)
from secsessionvallong where session_id = '1424114554450' and val_name = 'USER_AGENT';

select session_id, val_name, UTL_RAW.CAST_TO_VARCHAR2(dbms_lob.substr(val_value, 2000, 6001))
from secsessionvallong where session_id = '1514102782430' and val_name = 'ACS_RESOURCES';

===========================================================

-- Count report templates excluding External STD reports
select count(1) from qryquery qq
where client_code = 'COUPA'
and qry_active = 't'
--and qry_status = '90'
and exists (select 1 from qryfield qt where qt.qry_key = qq.qry_key)
and exists (select 1 from qrytable qt, qryquery q2, batclientproduct b
            where q2.qry_key = qt.qry_key
            and b.client_code = q2.client_code
            and qq.qry_key = q2.qry_key
            and qt.tab_code like '%@@' || b.prd_code || '@@' || b.ver_code || '%');

-- Count report templates
select client_code || ',' || count(1)
  from (select qry_key, client_code
          from qryquery
         where qry_active = 't'
           and client_code IN
               (select client_code from ggate.prod_tab@dblinkcatp01tocru40p)
           and user_key in
               (select su.user_key
                  from secuser su
                 where exists
                 (select 1
                          from secsession src_ss
                         where src_ss.client_code IN
                               (select client_code from ggate.prod_tab@dblinkcatp01tocru40p)
                           and src_ss.user_key = su.user_key))
        union
        select distinct myr.qry_key_copyof as qry_key, myr.client_code
          from qryquery myr
          join qryquery std on myr.qry_key_copyof = std.qry_key
                           and myr.client_code = std.client_code
                           and std.qry_class = 'EXT'
                           and std.qry_mode = 'STD'
         where myr.qry_key_copyof is not null
           and myr.qry_class = 'EXT'
           and myr.qry_mode = 'MYR'
           and myr.qry_active = 't'
           and myr.client_code IN
               (select client_code from ggate.prod_tab@dblinkcatp01tocru40p)) qq
where exists (select 1 from qryfield qt where qt.qry_key = qq.qry_key)
   and exists
(select 1
          from qrytable qt
         inner join qryquery q2 on q2.qry_key = qt.qry_key
         inner join batclientproduct b on b.client_code = q2.client_code
         where qq.qry_key = q2.qry_key
           and qt.tab_code like
               '%@@' || b.prd_code || '@@' || b.ver_code || '%')
group by client_code order by 1;



--- Counts batreq

select br.client_code || ',' || count(1)
   from batreq br
  inner join qryquery qq1 on qq1.qry_key = br.qry_key
  inner join qryquery qq2 on qq2.qry_key_versionof = qq1.qry_key_versionof
   left join catenvironment ce on ce.cpe_key = br.cpe_key
   left join batinstance bi on bi.inst_key = br.inst_key
  where br.req_active = 't'
    and br.client_code IN
        (select client_code from ggate.prod_tab@dblinkcatp01tocru40p)
    and br.req_timestamp >= (SYSDATE - 90)
    and qq2.qry_active = 't'
    and qq2.client_code = br.client_code
    and exists
  (select 1 from qrytable qt where qt.qry_key = qq2.qry_key)
  group by br.client_code order by 1;


-- Number of CUSTOM REPORT TEMPLATES
select count(distinct qry_key) from qryquery q where qry_active = 't'
and exists (select 1 from qrytable qt where q.qry_key = qt.qry_key and qt.tab_code like '%@@WFN@@9');

-- Number of MYR executions
select count(br.req_key) from batreq br
  inner join qryquery qq1 on qq1.qry_key = br.qry_key
  inner join qryquery qq2 on qq2.qry_key_versionof = qq1.qry_key_versionof
where qq2.qry_active = 't' and qq2.qry_class = 'EXT' and qq2.qry_mode = 'MYR'
and exists (select 1 from qrytable qt where qq2.qry_key = qt.qry_key and qt.tab_code like '%@@WFN%@@9');

-- Number of STD executions
select count(br.req_key) from batreq br
  inner join qryquery qq1 on qq1.qry_key = br.qry_key
  inner join qryquery qq2 on qq2.qry_key_versionof = qq1.qry_key_versionof
where qq2.qry_active = 't' and qq2.qry_class = 'EXT' and qq2.qry_mode = 'STD'
and exists (select 1 from qrytable qt where qq2.qry_key = qt.qry_key and qt.tab_code like '%@@WFN%@@9');


SELECT MIGRATION_TYPE, Trunc(Avg(migtime_sec), 4) avg_migration_time_sec FROM (
SELECT acmd.acm_key, acm.MIGRATION_TYPE, Trunc((Max(acmd.QRY_MIG_END_DT)-Min(acmd.QRY_MIG_START_DT))*24*60*60) migtime_sec
FROM admclientmigration acm JOIN admclientmigrationdetail acmd
ON 1=1 AND acm.acm_key = acmd.acm_key AND acm.mig_status != 'RUN'
--AND acmd.qry_active = 't'
AND ((To_Char(acmd.qry_MIG_START_DT , 'MM/DD/YYYY') = '01/19/2015' AND
     acmd.qry_MIG_START_DT < To_DATE('01/19/2015 12:00:00', 'MM/DD/YYYY HH24:MI:SS'))
OR  (To_Char(acmd.qry_MIG_START_DT , 'MM/DD/YYYY') = '02/06/2015' AND
     acmd.qry_MIG_START_DT >= To_DATE('02/06/2015 06:00:00', 'MM/DD/YYYY HH24:MI:SS'))
    )
GROUP BY acmd.acm_key, acm.MIGRATION_TYPE
)
GROUP BY MIGRATION_TYPE ORDER BY 1;



WFN REPORTS EXECUTION TIMINGS:
col tab_code form a50
col avgduration form 999999
col maxduration form 999999
col minduration form 999999
col countreports form 999999
col durationband form a15
set lines 160
break on tab_code skip 1
with wfnReportsTimings as 
(
select distinct b.req_key, b.qry_key, b.tab_code,
    (select 
 trunc(abs( extract( second from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) 
          + extract( minute from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 
          + extract( hour from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 * 60 
          + extract( day from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 * 60 * 24
            ))
     from batreqlog brl where b.req_key = brl.req_key) duration
from (
select distinct b.req_key, b.qry_key, qt.tab_code
from batreq b, qrytable qt
where b.qry_key = qt.qry_key and b.req_status = 'OK'
and qt.tab_code like '%@@WFN@@9'
and b.req_timestamp > trunc(sysdate)-6) b
) 
select tab_code, durationband, cnt, trunc(ratio_to_report(sum(cnt)) over (partition by tab_code) * 100) pct
from (
select tab_code, durationband, count(1) cnt from (
select tab_code, (case when duration<120 then '0. < 2  min'
                      when duration<300 then  '1. 2-5  min'
                      when duration<1800 then '2. 5-30 min'
                      else                    '3. >30  min' 
                  end) durationband from wfnReportsTimings 
) group by tab_code, durationband 
) group by tab_code, durationband, cnt order by 1,2,3;



===========================================================
      begin
        PKG_REPORTING_MAINTENANCE.SWITCHTOBACKUPSET1MV;
        PKG_REPORTING_MAINTENANCE.DROPMV;
      end;
      /

      YOUR WORK HERE

      begin
        PKG_REPORTING_MAINTENANCE.DEPLOYMV;
        PKG_REPORTING_MAINTENANCE.SWITCHTOLIVEMV;
      end;
      /

===========================================================
SVN Location:               http://svn.es.ad.adp.com/svn/ADPIntel/trunk/adpi-CM/IAT/IAT_20130918/Database/
DB User Info:                http://svn.es.ad.adp.com/svn/ADPIntel/trunk/adpi-CM/IAT/IAT_20130918/Database/DB_User_Info.txt
General Instructions: http://svn.es.ad.adp.com/svn/ADPIntel/trunk/adpi-CM/IAT/IAT_20130918/Database/How%20to%20Apply.txt
wfn svn(old):
C:\work\SVN\Reporting\Implementation\Products\WFN\WFN3\build5_docs
http://sharepoint.adpcorp.com/Sites/wfn/Project Documents/05 - Analysis/Common HR/Impact Analysis/Position ID Design Proposal.docx


===========================================================
select count(1) from migmappings where prd_code_target = 'WFN' and ver_code_target = '5';
 3794
select count(1) from migmapcalcfieldsel where prd_code_target = 'WFN' and ver_code_target = '5';
702
select count(1) from migjoinorder where prd_code_target = 'WFN' and ver_code_target = '5';
432

===========================================================
Command used to detect inactive clients on mas pod1

with clientlist as (select client_code from (
select c.client_code from catclient c
where C.POD_CODE = 'MAS_PROD1'
and not exists (select 1 from qryquery q where q.client_code = c.client_code)
minus
select client_code from GGATE.ADP_TERMINATED_CLIENTS@DBLINKCRW21PTOCRU40P)
minus
select CLIENT_CODE from GGATE.CURR_ISI_CLIENT_LOAD@DBLINKCRW21PTOCRU40P where PRODUCT_CODE = 'NASPORTAL'
)
--select 'update catclient set pod_code = ''MAS_PROD2'' where client_code = ''' || CLIENT_CODE || ''';' from CLIENTLIST order by 1
select 'exec isiwsinterfacetest.KEEPclientresourcegroup(''' || CLIENT_CODE || ''', ''ADPRPROD02_03'');' from CLIENTLIST order by 1

===========================================================



select distinct
i.givenname ,   --> this goes to secuser.user_firstname
i.sn ,           --> this goes to secuser.user_lastname
i.adpmiddleinit ,  --> this goes to user_middleinitial
i.mail              --> this goes to user_email
from isiuser i
where upper(i.userid) = 'MFRIEDMAN@GRFS';


===============================================================
TABLES that need MV refreshes

SELECT DISTINCT aa FROM (
SELECT u1.NAME, u1.REFERENCED_NAME aa, u2.REFERENCED_NAME bb
FROM user_dependencies u1,user_dependencies u2
WHERE u1.name IN (
  SELECT object_name FROM  USER_OBJECTS WHERE object_type LIKE 'MATERIALIZED VIEW'
) AND u1.referenced_name = u2.name (+)
AND u1.name != u1.referenced_name)
ORDER BY 1;


BATCONFIGURATION
BATCONFIGURATIONGROUP
BATCONFIGURATION_NLS
BATPOD
CATAREATABLE
CATCLIENT
CATCOLUMN
CATEFFECTIVE
CATKEY
CATPRODUCTCODE
CATRELAT
CATTABLE
CATTABLE_NLS
CATVERSION
SECROLE
SECROLECOL

================================================================


WITH numbers(n) AS (
SELECT 1 FROM dual
UNION ALL
SELECT n+1 FROM numbers WHERE n<100)
SELECT * FROM numbers;

SELECT LEVEL AS n
FROM dual
CONNECT BY LEVEL < 100;

=====================================


CAPROCK on adpr side vs payx side commands:
exec configure_client('CAPROCK', '20', 'WFN_FIT41','t', '_0002', 'HRB', '25', 'f', '', '011PQM3FBNB00063', 'US');
exec configure_client('CAPROCK', '20', 'WFN_FIT41','t', '_0102', 'EZLM', '1118', 't', '@CDBLINKCRU20QTOCRU01Q', '011PQM3FBNB00063', 'US');
exec configure_client('CAPROCK', '20', 'WFN_FIT41','t', '_0230', 'PAYX2', '185', 'f', '', '011PQM3FBNB00063', 'US', 'f');

exec configure_client('CAPROCK', '30', 'WFN_FIT41','t', '_0002', 'HRB', '25', 'f', '', '011PQM3FBNB00063', 'US');
exec configure_client('CAPROCK', '30', 'WFN_FIT41','t', '_0102', 'EZLM', '1118', 't', '@CDBLINKPXC07QTOCRU01Q', '011PQM3FBNB00063', 'US');
exec configure_client('CAPROCK', '30', 'WFN_FIT41','t', '_0003', 'PAYX2', '185', 'f', '', '011PQM3FBNB00063', 'US', 't');
=========================================

col client_code format a20
col last_login format a30
col num_reports format 99999999
select c.client_code,
(select count(distinct q.qry_key) from qryquery q, qrytable qt where q.client_code = c.client_code
and q.qry_active = 't' and q.qry_key = qt.qry_key) num_reports,
(select max(session_timestamp) from secsession s
where s.client_code = c.client_code and s.session_parent_id is null) last_login
from catclient c
where c.client_code not in ('ADPADMIN', 'CSRADMIN')
and c.pod_code = (select pod_code from batpod where pod_current = 't')
and exists (select 1 from secsession s where s.client_code = c.client_code
and s.session_parent_id is null and s.session_timestamp > trunc(sysdate)-90)
order by 3;


================================================

set default resource group as US for payx 185 clients:

update catclient c1
set c1.res_key = (select res_key from catresource where res_name like 'US Locale')
where exists (select 1
from catclient c, batclientproduct b
where c.client_code = b.client_code
and c1.client_code = c.client_code
and c.pod_code = (select pod_code from batpod where pod_current = 't')
and b.prd_code = 'PAYX2' and b.ver_code = '185'
and c.res_key is null);


======================================================

select to_char(PAY_DATE, 'MM/DD/YYYY'), count(1) from VPDCLSCH0010000160.check_history where vpd_key = 'PAYXSCH0034727'
group by to_char(PAY_DATE, 'MM/DD/YYYY') order by to_date(to_char(PAY_DATE, 'MM/DD/YYYY'), 'MM/DD/YYYY')
======================================================

with multip as (
select --+ materialize
organization_oid from v_client_logon
where id_code = parent_code and payexpert_version like '18%'
group by organization_oid having count(*) > 1)
select distinct t3.c
from racs_r1.org_nonvpd o, multip m, t3
where t3.c = o.isiclientid
and o.org_id = m.organization_oid;

=====================================================

        51 PXC15P_ADPR_SVC1
        52 wfc51p_adpr_svc1
        53 wft51p_adpr_svc1
        54 pxc01p_adpr_svc1
        55 pxc02p_adpr_svc1
        56 pxc03p_adpr_svc1
        57 pxc04p_adpr_svc1
        58 pxc05p_adpr_svc1
        59 pxc06p_adpr_svc1
        60 pxc07p_adpr_svc1
        61 pxc08p_adpr_svc1
        62 pxc09p_adpr_svc1
        63 pxc10p_adpr_svc1
        64 pxc11p_adpr_svc1
        65 pxc12p_adpr_svc1
        66 pxc13p_adpr_svc1
        67 pxc14p_adpr_svc1
        68 pxc16p_adpr_svc1
        69 pxc17p_adpr_svc1
        70 pxc18p_adpr_svc1
        71 pxc19p_adpr_svc1
        72 pxc20p_adpr_svc1
        73 pxc21p_adpr_svc1
        74 pxc22p_adpr_svc1
        75 pxc23p_adpr_svc1
        76 pxc24p_adpr_svc1
        77 pxc25p_adpr_svc1
        78 pxt01p_adpr_svc1
=========================================================
Multi-parent check in PAYX:



SELECT organization_oid,client_code,instance_name,has_adpr, Sum( numkeysonthisinst ) OVER (PARTITION BY organization_oid) totalvpdkeys,
numkeysonthisinst,
vpdkeylist
FROM (
SELECT organization_oid,
(SELECT DISTINCT isiclientid FROM racs_r1.org_nonvpd x WHERE x.org_id = organization_oid) client_code,
instance_name,
Decode((SELECT 'Y' FROM dual WHERE EXISTS (SELECT 1 FROM curr_isi_client_load x WHERE x.org_id = organization_oid)), 'Y', 'Y', 'N') has_adpr,
REGEXP_COUNT(vpdkeylist, ',')+1 numkeysonthisinst,
vpdkeylist
FROM (
WITH multiparents AS
(SELECT organization_oid,
       vpd_key, --schema_name,
       instance_name
FROM v_client_logon v
WHERE id_code = parent_code
AND PAYEXPERT_VERSION LIKE '18%'
AND instance_name NOT IN ('pxc21p_svc1', 'pxc23p_svc1', 'pxc24p_svc1')
AND organization_oid IN (
 SELECT organization_oid from v_client_logon where instance_name like 'pxc%'
 and parent_code=id_code and organization_oid is not NULL
 AND organization_oid != 'FFFFFFFFFFFFFFFF'
 group by organization_oid having count(*) >1)

)
SELECT
 organization_oid,
 instance_name,
 listagg(vpd_key, ',') within GROUP (ORDER BY vpd_key) vpdkeylist
FROM multiparents
 GROUP BY organization_oid, instance_name
)
) ORDER BY 5 DESC, 6 DESC, 2 ASC;


=============================================================



SELECT ORB.BUSINESS_UNIT_CD, COUNT(1) --COUNT(DISTINCT O.ORG_ID)
FROM REGPOD11.ORG O,
     REGPOD11.ORG_ROLE OL,
     REGPOD11.ORG_ROLE_BU ORB,
(SELECT OL.ORG_ID POD_ORG_ID,
        PS.ISI_VERSION POD_ISI_VERSION
 FROM REGCOM.ORG_LOCATION OL,
      REGCOM.POD_SATELLITE PS
 WHERE OL.POD_NM=PS.POD_NM AND PS.SCHEMA_NAME = 'REGPOD11') POD
WHERE O.ORG_ID = OL.ORG_ID
AND OL.ORG_ROLE_ID = ORB.ORG_ROLE_ID
--AND ORB.BUSINESS_UNIT_CD = 'NAS'
AND OL.ORG_ID = POD.POD_ORG_ID
GROUP BY ORB.BUSINESS_UNIT_CD;


SELECT O.ORG_ID, ORB.BUSINESS_UNIT_CD, okva.region_code, okva.company_code, count(akve.EMPLOYEE_ID)
FROM REGPOD14.ORG O,
     REGPOD14.ORG_ROLE OL,
     REGPOD14.ORG_ROLE_BU ORB,
	 regpod14.associate_key_value_enterprise akve,
	 regpod14.org_key_value_autopay okva,
(SELECT OL.ORG_ID POD_ORG_ID,
        PS.ISI_VERSION POD_ISI_VERSION
 FROM REGCOM.ORG_LOCATION OL,
      REGCOM.POD_SATELLITE PS
 WHERE OL.POD_NM=PS.POD_NM AND PS.SCHEMA_NAME = 'REGPOD14') POD
WHERE O.ORG_ID = OL.ORG_ID
AND OL.ORG_ROLE_ID = ORB.ORG_ROLE_ID
AND ORB.BUSINESS_UNIT_CD = 'NAS'
AND OL.ORG_ID = POD.POD_ORG_ID
--and o.org_id = '003081DF3A500253'
and akve.ORG_ROLE_ID = ol.org_role_id
and ol.ORG_ROLE_ID = okva.org_role_id
group by O.ORG_ID, ORB.BUSINESS_UNIT_CD, okva.region_code, okva.company_code;

============================================================

PERIOD_END_DATE POLICY CHECKING....


DECLARE
  dblink VARCHAR2(100);
  vstr VARCHAR2(1000);
  vschm VARCHAR2(50);
  venable VARCHAR2(10);
  TYPE ty IS RECORD (owner VARCHAR2(30), schm VARCHAR2(50), ENABLE VARCHAR2(10));
  TYPE tty IS TABLE OF ty;
  t ty;
  t1 tty;
BEGIN
FOR I IN (
SELECT source_repl_instance
                 FROM adpr_client_extensions
                WHERE product_code = 'PAYX2'
                  AND product_version = '185'
                  --AND source_repl_instance != 'pxc15p_svc1'
             GROUP BY source_repl_instance
             ORDER BY 1
)
LOOP
  dblink := 'DBLINKCRU40PTO' || Upper(SubStr(i.source_repl_instance, 1, InStr(i.source_repl_instance,'_svc1')-1));
  --Dbms_Output.put_line(dblink);
  vstr := 'SELECT object_owner, object_name, enable FROM DBA_POLICIES@' || dblink || ' WHERE POLICY_NAME = ''DATE_FILTER_FOR_VIEW'' AND ' ||
        '(object_name LIKE ''PX185_CHK_VW_SUMMARY_VW%'' OR object_name LIKE ''PX185_CHKERNHRMEMDED_VW%'' OR object_name LIKE ''PX185_CHECK_HISTORY%'')';
  --Dbms_Output.put_line(vstr);
  EXECUTE IMMEDIATE vstr BULK COLLECT INTO t1;

  FOR x IN 1 .. t1.Count
  LOOP
  IF (t1(x).enable = 'YES') THEN
     Dbms_Output.put_line(i.source_repl_instance || ' -  ' || t1(x).schm || ' - ' || t1(x).enable);
  END IF;
  END LOOP;
END LOOP;

  dblink := 'DBLINKCRU40PTOCRU20P';
  vstr := 'SELECT object_owner, object_name, enable FROM DBA_POLICIES@' || dblink || ' WHERE POLICY_NAME = ''DATE_FILTER_FOR_VIEW'' AND ' ||
        '(object_name LIKE ''PX185_CHK_VW_SUMMARY_VW%'' OR object_name LIKE ''PX185_CHKERNHRMEMDED_VW%'' OR object_name LIKE ''PX185_CHECK_HISTORY%'')';

  EXECUTE IMMEDIATE vstr BULK COLLECT INTO t1;

  FOR x IN 1 .. t1.Count
  LOOP
  IF (t1(x).enable = 'YES') THEN
     Dbms_Output.put_line('CRU20P - ' || t1(x).owner || ' -  ' || t1(x).schm || ' - ' || t1(x).enable);
  END IF;
  END LOOP;

END;
/

------------------------------------------------------
					call ezlm_r1118_sec_context_4501.set_app_context('HCHAVEZ@KASSLAW','ER','0WPN06J529C0233N','KASSLAW');

v$sql_plan_statistics
v$sql_plan_statistics_all

alter session set timed_statistics=true;
alter session set statistics_level=all;
set time on timing on linesize 300 pagesize 10000
set arraysize 1000
exec dbms_Session.set_identifier('VIJAY_TEST');
select sys_context('userenv', 'instance') from dual;

alter system set "_sqlmon_max_planlines"=800 scope=both;

/*+ LEADING(TABLE1) NO_MERGE(TABLE4) gather_plan_statistics */ /* fabiobressler hard parse #1 */ 
/*+ gather_plan_statistics */ 

select inst_id, sid, serial#,  sql_child_number, sql_id, prev_sql_id from gv$session
where client_identifier='VIJAY_TEST' and status='ACTIVE';

select s.sql_id, s.sql_child_number
from gv$session s, gv$sql l
where s.inst_id = l.inst_id and s.sql_id = l.sql_id and s.sql_child_number=l.child_number
and UPPER(l.sql_Text) like '%VIJAY_EVENT_ELIGBLTY_VW%';

set lines 300 pagesize 0
select * from table(dbms_xplan.display_cursor('00wjjts22ggw4',0,'ALLSTATS LAST'));
set serveroutput off
select * from table(dbms_xplan.display_cursor(null,null,'ALLSTATS'));



select * from table(dbms_xplan.display_cursor('fhzq79k9pyhq5',0,'ALL'));

select * from table(dbms_xplan.display_cursor('fhzq79k9pyhq5',0,'ALLSTATS LAST'));

SELECT  * FROM
  TABLE(DBMS_XPLAN.DISPLAY_CURSOR('75chksrfa5fbt',0,'ALLSTATS LAST +PEEKED_BINDS +PROJECTION +ALIAS +PREDICATE +COST +BYTES'));


-- To get sql_id from running session:
select sid, serial#, sql_id from v$session where client_identifier='FAB' and status='ACTIVE';
fg8mqhd29z4q6

-- Get plan for a sql_id:
select * from table(dbms_xplan.display_cursor('fg8mqhd29z4q6',0,'ALLSTATS LAST')); --> fg8mqhd29z4q6_plan.txt / fg8mqhd29z4q6_plan_stats.txt

-- Get active workareas: 
col OPERATION_TYPE for a25
select operation_id, operation_type, expected_size, work_area_size, number_passes, round(tempseg_size/1024/1024/1024,2) temp_size_gb from v$sql_workarea_active where sql_id='fg8mqhd29z4q6' order by 1;

-- Check the final number_passes + temp consumed by each step
col OPERATION_TYPE for a25
col MAX_PASSES for a15
select operation_id, operation_type, last_execution as max_passes, round(max_tempseg_size/1024/1024/1024,2) max_temp_size_gb from v$sql_workarea where sql_id='fg8mqhd29z4q6';

-- Get bind variables
col NAME for a20
col DATATYPE_STRING for a20
col VALUE_STRING for a50
select name, position, datatype_string, value_string from v$sql_bind_capture where sql_id='fg8mqhd29z4q6';




After the sql execution has run for a while (5-15min),
	ctrl-c the execution and get the execution plan in the second session using the command below.
	When you kill the session, the counters may not be updated completely in some cases, so keep that in mind on review.
	If the plan is not available, it may have aged out very quickly so you will have to try everything again.

	At this point you can review the plan to determine where most of the time is spent using the A-Time column.
	The time is cumulative in the heirarchy.

Note
-----
   - Warning: basic plan statistics not available. These are only collected when:
       * hint 'gather_plan_statistics' is used for the statement or
       * parameter 'statistics_level' is set to 'ALL', at session or system level

----------------------------------------------------------
col cn format 99
col ratio format 99
col ratio1 format A6
--set pagesize 1000
set linesize 140
break on sql_id on cn
col lio_rw format 999
col "operation" format a60
col a_rows for 999,999,999
col e_rows for 999,999,999
col elapsed for 999,999,999

Def v_sql_id=&SQL_ID

select
       -- sql_id,
       --hv,
       childn                                         cn,
       --ptime, stime,
       case when stime - nvl(ptime ,0) > 0 then
          stime - nvl(ptime ,0)
        else 0 end as elapsed,
       nvl(trunc((lio-nvl(plio,0))/nullif(a_rows,0)),0) lio_ratio,
       --id,
       --parent_id,
       --starts,
       --nvl(ratio,0)                                    TCF_ratio,
       ' '||case when ratio > 0 then
                rpad('-',ratio,'-')
             else
               rpad('+',ratio*-1 ,'+')
       end as                                           TCF_GRAPH,
       starts*cardinality                              e_rows,
                                                       a_rows,
       --nvl(lio,0) lio, nvl(plio,0)                      parent_lio,
                                                         "operation"
from (
  SELECT
      stats.LAST_ELAPSED_TIME                             stime,
      p.elapsed                                  ptime,
      stats.sql_id                                        sql_id
    , stats.HASH_VALUE                                    hv
    , stats.CHILD_NUMBER                                  childn
    , to_char(stats.id,'990')
      ||decode(stats.access_predicates,null,null,'A')
      ||decode(stats.filter_predicates,null,null,'F')     id
    , stats.parent_id
    , stats.CARDINALITY                                    cardinality
    , LPAD(' ',depth)||stats.OPERATION||' '||
      stats.OPTIONS||' '||
      stats.OBJECT_NAME||
      DECODE(stats.PARTITION_START,NULL,' ',':')||
      TRANSLATE(stats.PARTITION_START,'(NRUMBE','(NR')||
      DECODE(stats.PARTITION_STOP,NULL,' ','-')||
      TRANSLATE(stats.PARTITION_STOP,'(NRUMBE','(NR')      "operation",
      stats.last_starts                                     starts,
      stats.last_output_rows                                a_rows,
      (stats.last_cu_buffer_gets+stats.last_cr_buffer_gets) lio,
      p.lio                                                 plio,
      trunc(log(10,nullif
         (stats.last_starts*stats.cardinality/
          nullif(stats.last_output_rows,0),0)))             ratio
  FROM
       v$sql_plan_statistics_all stats
       , (select sum(last_cu_buffer_gets + last_cr_buffer_gets) lio,
                 sum(LAST_ELAPSED_TIME) elapsed,
                 child_number,
                 parent_id,
                 sql_id
         from v$sql_plan_statistics_all
         group by child_number,sql_id, parent_id) p
  WHERE
    stats.sql_id='&v_sql_id'  and
    p.sql_id(+) = stats.sql_id and
    p.child_number(+) = stats.child_number and
    p.parent_id(+)=stats.id
)
order by sql_id, childn , id
/
------------------------------------------------------------
setting up trace for hwse referesh:

Conn hwse_admin@cru04p
Alter session set max_dump_file_size=unlimited;
Alter session set statistics_level=ALL;
Alter session set timed_statistics=true;
Alter session set tracefile_identifier=electionallmv;
Exec dbms_monitor.session_trace_enable(null,null,true,true);
--BEGIN HWSE_ADMIN.HWSE_REFRESH(‘HWSE_REG0325’); END;
exec dbms_mview.refresh('HWSE_REG0009.ELECTION_ALL_MV', 'C');
Select ‘close cursors’ from dual;
Exit;

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


alter session set timed_statistics=true;
alter session set statistics_level=all;
set time on timing on linesize 300 pagesize 10000
set arraysize 5000
exec dbms_monitor.session_trace_enable(null,null,true,true);
run the hwse refresh
select ‘close cursor’ from dual;
exec dbms_monitor.session_trace_disable(null,null);


====================================================
alter session set "_always_semi_join"=choose;
/*+ Opt_param(‘_always_semi_join’,’off’) */

alter session set "_unnest_subquery"=false;
/*+ METHOD_OPT('_unnest_subquery','false') */



SELECT VALUE FROM V$DIAG_INFO WHERE NAME = 'Diag Trace';
SELECT SID, SERIAL#, USERNAME FROM V$SESSION where username like 'ADPR%';
 select distinct inst_id ,username from gv$session where username like 'ADPR%' and sid = 23;

   INST_ID USERNAME
---------- ------------------------------
         1 ADPR_CRUVPD

select tracefile from v$session join v$process on (addr=paddr) and sys_context('userenv','sessionid')=audsid
Enable a trace file for a session

EXECUTE DBMS_SESSION.SESSION_TRACE_ENABLE(waits => TRUE, binds => FALSE);
EXECUTE DBMS_SESSION.SESSION_TRACE_ENABLE(waits => FALSE, binds => TRUE);

EXECUTE DBMS_SESSION.SESSION_TRACE_DISABLE();

QL> EXEC DBMS_SYSTEM.set_sql_trace_in_session(sid=>123, serial#=>1234, sql_trace=>TRUE);
SQL> EXEC DBMS_SYSTEM.set_sql_trace_in_session(sid=>123, serial#=>1234, sql_trace=>FALSE);

EXECUTE DBMS_MONITOR.SESSION_TRACE_ENABLE(session_id => 23, serial_num => 34755, waits => FALSE, binds => TRUE);





sqlplus dbadm@evbc1p01
select dbname from psdbowner where ownerid = 'COMMON' and client_oid = 'G3X2EJY9V200005B';
select count(1) from dba_tables where table_name='PS_USER_SCRTY_TBL' and owner = 'BC1P'
==================================================
select RELEASE from psdbowner  where client_oid = '<<org_id>>';

conn dbadm/******/@klz5p03
update psdbowner set CLIENT_oid = ' ' WHERE ownerid = 'COMMON' and client_oid = 'G3FJBWX795RRY4F4' and dbname='KLZ5P03';
commit;

SQL> select TABLE_NAME,owner from dba_tables where table_name='PS_USER_SCRTY_TBL' and owner = 'J92P';

TABLE_NAME OWNER
------------------------------ ------------------------------
PS_USER_SCRTY_TBL J92P

dbadm.CR_SET_SCHEMA_CONTEXT ('F3DB3F71A5800382','DPONDER_J92P');


==================================================

send mgr, getportinfo detail

ulimit -c
output -O

info GRZC473P
VIEW REPORT GRZC473P
  --> gives process id

pstack <pid>
  you can see it in dirpcs/GRZC47P.pcs

GRZC473P



gdb
  attach <pid>
  where
  detach
  quit

sqlplus ggate


create subdirs
edit params mgr
  port 9202
start mgr
info mgr
view report mgr


ps -eaf | grep GRZC473P
kill -9 <pid>

mv .prm to new location
cd dirchk
ls GRZC473P*
cp GRZC473P.cpr  GRZC473P.cpr_BKP
mv cpr file to new location



GGSCI (dc2prcrptgg3) 1> info mgr

Manager is running (IP port dc2prcrptgg3.9203).


cd dirrps
ls *450*
rm GRZC450P.pcr
======================================================

SQL> select cr.res_oid,
       cr.res_name,
       (SELECT tab_label FROM cattable WHERE tab_code = crt.tab_code)  || crt.tab_code tablabel
       from CATRESOURCETABLE crt, catresource cr
where crt.tab_code like '%@@185'
AND crt.res_key = cr.res_key;




=====================================================










VIJAY_EQUATION_2013:

(MovingAverage[MA,Volume,10,0,D]>500000) AND
(Bar[Low,M,1]<Bar[Low,M]) AND
(Bar[High,M,1]<Bar[High,M]) AND
((Bar[Close,D] - Bar[Low,M,1]) / Bar[Low,M,1] <= 0.07) AND
(Bar[Close,W]>((MovingAverage[MA,High,28,-1,D]+MovingAverage[MA,Low,28,-1,D]+MovingAverage[MA,Close,28,-1,D])/3)) AND
((Bar[Close,W]-((MovingAverage[MA,High,28,-1,D]+MovingAverage[MA,Low,28,-1,D]+MovingAverage[MA,Close,28,-1,D])/3))/
((MovingAverage[MA,High,28,-1,D]+MovingAverage[MA,Low,28,-1,D]+MovingAverage[MA,Close,28,-1,D])/3) >0.03) AND
((Bar[Close,W]-((MovingAverage[MA,High,28,-1,D]+MovingAverage[MA,Low,28,-1,D]+MovingAverage[MA,Close,28,-1,D])/3))/
((MovingAverage[MA,High,28,-1,D]+MovingAverage[MA,Low,28,-1,D]+MovingAverage[MA,Close,28,-1,D])/3) <0.04)


((Bar[Close,W]-((MovingAverage[MA,High,28,0,D]+MovingAverage[MA,Low,28,0,D]+MovingAverage[MA,Close,28,0,D])/3))/
((MovingAverage[MA,High,28,0,D]+MovingAverage[MA,Low,28,0,D]+MovingAverage[MA,Close,28,0,D])/3) <-0.01) OR
(Bar[Low,D]<Bar[Low,M,1])
=====================================================



(MovingAverage[MA,Volume,10,0,D]>500000) AND
(Bar[Low,M,1]<Bar[Low,M]) AND
(Bar[High,M,1]<Bar[High,M]) AND
((Bar[Close,D] - Bar[Low,M,1]) / Bar[Low,M,1] <= 0.07)

(Bar[Low,D]<Bar[Low,M,1])

Return Confirmation Number

115465651
Original Order Number

172204127
===============================

ACL Rights:

BEGIN
   DBMS_NETWORK_ACL_ADMIN.ADD_PRIVILEGE (
    acl          => 'adprconnect.xml',
    principal    => 'ADPRMASFIT06',
    is_grant     => TRUE,
    privilege    => 'connect',
    position     => null);
   COMMIT;
END;
/

BEGIN
   DBMS_NETWORK_ACL_ADMIN.ADD_PRIVILEGE (
    acl          => 'adprconnect.xml',
    principal    => 'ADPRMASFIT06',
    is_grant     => TRUE,
    privilege    => 'resolve',
    position     => null);
   COMMIT;
END;
/

BEGIN
   DBMS_NETWORK_ACL_ADMIN.ASSIGN_ACL (
    acl          => 'adprconnect.xml',
    host         => '*');
   COMMIT;
END;
/

================================================
wfnfit1  6 instance  2 upgraded to wfn4 (for wfn6)
wfnfit2  3 instance  supporting WFN_FIT4

  wfn
  WFN_FIT2 pod new env..

wfc55q -> wfn_fit4


Please configure the WFN5 FIT1 clients(WFC21Q,WFC22q and WFC10Q_SVC1) on ADPRMASFIT06@crw01q.

Here is the pod information:
POD_CODE=’WFN_FIT2
Catalog:ADPRMASFIT06@crw01q
ADPR Code: 10.5.166.130/Reporting
Reportservice links:

ADPR_My_Report_WS_Url    --  http://10.5.166.123:9080/ReportServices/MyReportService
ADPR_Run_Report_WS_Url   --  http://10.5.166.123:9080/ReportServices/ReportOutputService

===========================================

SELECT DISTINCT A.vpd_key,
                A.ORGANIZATION_OID,
                b.TARGET_SCHEMA,
                c.ISICLIENTID
           FROM v_client_logon_local A,
                adpr_payx_mapping b,
                racs_r1.org_nonvpd c
           WHERE A.schema_name = b.source_schema
                 AND SubStr (A.instance_name, 1, 6) = b.source_instance
                 AND A.ORGANIZATION_OID = c.ORG_ID(+)
                 --AND A.ORGANIZATION_OID = 'G325QGGGF64003JR'
                 AND b.target_schema = 'PAYX_REG02_POD31'

===============================================
update spccolumn set col_label =  regexp_replace(col_label, '[^\x80-\xFF]', ' ') where spc_key = 388;


To kill the PAYX Compare jobs:
Login to ETL2 box as infor user and run below commands in this order:
kill -9 `ps -eaf | grep ggcompare| grep payx | awk '{print $2}'`
kill -9 `ps -eaf | grep sqlplus | grep ggate | grep WFC51S | awk '{if($3==1)print $2}'`

wfn6
PORTALWFN41	wfc51p_svc1
PORTALWFN42	wft21p_svc1
PORTALWFN42	wft51p_svc1
wfn5
PORTALWFN43	wfc23p_svc1
PORTALWFN44	wfc24p_svc1
PORTALWFN45	wfc21p_svc1
PORTALWFN45	wfc22p_svc1
PORTALWFN47	wfc52p_svc1
PORTALWFN48	wfc53p_svc1
PORTALWFN49	wfc54p_svc1


-- Which users ran reports of IPAY product that succeeded in last 30 days
SELECT (SELECT user_login FROM secuser WHERE user_key = b.user_key) userlogin, b.req_key, b.req_timestamp, b.req_rows
FROM batreq b, qrytable qt
WHERE b.qry_key = qt.qry_key
AND qt.tab_code LIKE '%@@IPAY@@0'
AND b.client_code = 'MYPAYROLL'
AND b.req_timestamp > Trunc(SYSDATE)-30
AND b.req_rows > 0 ORDER BY req_timestamp;

ALTER SESSION SET ddl_lock_timeout=1800;

grant DEBUG CONNECT SESSION to adpr_cruvpd;
grant DEBUG ANY PROCEDURE to adpr_cruvpd;



-----------------

check vpd used:
-- show VPD Policy results
COL object_owner format a12
COL object_name format a12
COL policy format a6
COL sql_fulltext format a26
COL predicate format a12
SELECT object_owner,
       object_name,
        policy,
        sql_fulltext,
        predicate
   FROM gv$vpd_policy p, gv$sql s
  WHERE p.sql_id = s.sql_id
    AND predicate IS NOT NULL;

-------------------

Reports + files and sections

select qry_title,
decode(qryquery.res_key,3004,'US',3012,'CA','Both') country,
area_name as "Subject Area"
     , case when cattable.tab_hidden = 'f' then cattable.tab_label
            else (select rel_label1 from catrelat where tab_code2 = cattable.tab_code and rel_Section = 't' and rownum = 1)
        end "File"
     , decode(cattable.tab_hidden,'t',cattable.tab_label) "Section"
from
 catareatable, catarea, cattable,qrytable,qryquery
where catareatable.area_key = catarea.area_key
and catareatable.tab_code = cattable.tab_code
and cattable.tab_active = 't'
and qrytable.tab_code = cattable.tab_code
and qrytable.qry_key = qryquery.qry_key
and qryquery.qry_mode = 'SMP'
and qryquery.qry_active = 't'
and qrytable.tab_code like '%@@WFN@@5'
order by 1,4,5

only files and fields


select distinct
area_name as "Subject Area"
     , case when cattable.tab_hidden = 'f' then cattable.tab_label
            else (select rel_label1 from catrelat where tab_code2 = cattable.tab_code and rel_Section = 't' and rownum = 1)
        end "File"
     , decode(cattable.tab_hidden,'t',cattable.tab_label) "Section"
from
 catareatable, catarea, cattable,qrytable,qryquery
where catareatable.area_key = catarea.area_key
and catareatable.tab_code = cattable.tab_code
and cattable.tab_active = 't'
and qrytable.tab_code = cattable.tab_code
and qrytable.qry_key = qryquery.qry_key
and qryquery.qry_mode = 'SMP'
and qryquery.qry_active = 't'
and qrytable.tab_code like '%@@WFN@@5'
order by 1,2,3

-------------------------------------------------------------------


HRB Queries ran more than 10 mins and less than 15 mins:

SELECT
(SELECT USER_LOGIN FROM secuser WHERE user_key = b.user_key) user_login, req_key || ':'|| qry_key, duration, whenran
FROM (
SELECT b.user_key, b.req_key, Q.QRY_KEY, MAX(BL.RLOG_TIMESTAMP) whenran,
       ( MAX(BL.RLOG_TIMESTAMP) - MIN(BL.RLOG_TIMESTAMP) ) duration
FROM BATREQLOG BL, BATREQ B , qryquery q, qrytable qt, catclient c
WHERE 1=1
AND BL.REQ_KEY = B.REQ_KEY
AND b.client_code = c.client_code
AND c.pod_code = (SELECT pod_code FROM batpod WHERE pod_current= 't')
AND B.QRY_KEY = Q.QRY_KEY
AND q.qry_key = qt.qry_key
AND qt.tab_code IN (
SELECT tab_code FROM cattable WHERE tab_table IN (
'HR25_EARN_EARN_INFO_VW',
'HR25_PERFORMANCE_VW',
'HR25_WORK_CORP_GROUP_VW',
'HR25_WORK_JOB_INFO_VW',
'HR25_WORK_STATUS_INFO_VW'))
AND q.qry_active = 't'
AND b.req_timestamp > to_date('01/01/2013', 'MM/DD/YYYY')
GROUP BY b.user_key, b.REQ_KEY, Q.QRY_KEY
) b
WHERE b.duration > to_dsinterval('0 0:10:00')
AND b.duration < to_dsinterval('0 0:15:00')
ORDER BY whenran;


---------------------------------------------------------------------
--  wfn6 pilot clients
select c.client_code
from catclient c, batclientproduct bcp, batclientenvironment bce, batinstance bi
where c.client_code = bcp.client_code
and bcp.client_code = bce.client_code
and c.pod_code = (select pod_code from batpod where pod_current = 't')
and bcp.prd_code = 'WFN' and bcp.ver_code = '5'
and bce.prd_code = bcp.prd_code
and bce.inst_key = bi.inst_key
and (upper(bi.inst_sid) like 'WFC53P%'  OR
     upper(bi.inst_sid) like 'WFT21P%'  OR
     upper(bi.inst_sid) like 'WFT51P%')
;




----------------------------------------------------------------------------

CREATE OR REPLACE PROCEDURE my_putline (
   str         IN   VARCHAR2
 , len         IN   INTEGER := 80
 , expand_in   IN   BOOLEAN := TRUE
)
IS
   v_len     PLS_INTEGER     := LEAST (len, 255);
   v_len2    PLS_INTEGER;
   v_chr10   PLS_INTEGER;
   v_str     VARCHAR2 (2000);
BEGIN
   IF LENGTH (str) > v_len
   THEN
      v_chr10 := INSTR (str, CHR (10));

      IF v_chr10 > 0 AND v_len >= v_chr10
      THEN
         v_len := v_chr10 - 1;
         v_len2 := v_chr10 + 1;
      ELSE
         v_len2 := v_len + 1;
      END IF;

      v_str := SUBSTR (str, 1, v_len);
      DBMS_OUTPUT.put_line (v_str);
      my_putline (SUBSTR (str, v_len2), len, expand_in);
   ELSE
      -- Save the string in case we hit an error and need to recover.
      v_str := str;
      DBMS_OUTPUT.put_line (str);
   END IF;
EXCEPTION
   WHEN OTHERS
   THEN
      /* TVP 9/99: Might want to use buffer size to STOP program */
      IF expand_in
      THEN
         DBMS_OUTPUT.ENABLE (1000000);
         DBMS_OUTPUT.put_line (v_str);
      ELSE
         RAISE;
      END IF;
END my_putline;
/

---------------------------------------------------



hwse data sizings:

SELECT 'select count(1) from SHAWGRP.' || object_name || '@DBLINKCRU04PTOHWS12P;'
FROM all_objects WHERE owner = 'HWSE_REG0116' AND object_type = 'MATERIALIZED VIEW'
AND object_name LIKE 'ELECTION%';

set serveroutput on size 1000000
declare
 s varchar2(1000);
 c1 pls_integer;
 c2 pls_integer;
begin
for i in
(SELECT object_name FROM all_objects
WHERE owner = 'HWSE_REG0116' AND object_type = 'MATERIALIZED VIEW'
AND object_name not LIKE 'ELECTION%' and object_name not like 'ELECTION_ALL_MV'
and object_name not like 'ADDRESS_USAGE1' order by 1
)
loop
 begin
  s := 'select count(1) from SHAWGRP.' || i.object_name || '@DBLINKCRU04PTOHWS12P';
  execute immediate s into c1;
  s := 'select count(1) from HWSE_REG0116.' || i.object_name;
  execute immediate s into c2;
  dbms_output.put_line(i.object_name || ',' || c1 ||',' || c2 || ',' || ceil(100*(c2+1)/(c1+1)));
  exception
    when others then
	  dbms_output.put_line (i.object_name || ' has error');
end;
end loop;
end;
/


desc dba_segments;

select SEGMENT_TYPE, count(1) from dba_segments where OWNER = 'HWSE_REG0116' group by SEGMENT_TYPE;
col totsize format 99999999999999

select SUM(BYTES) totsize from dba_segments where 1=1
--and OWNER = 'HWSE_REG0116'
and OWNER in (select * from table(select SCH_NAMES from MV_REFRESH_JOB))
and SEGMENT_TYPE = 'TABLE'
and segment_name like '%#_VW' escape '#';

with sname as
(select --+ materialize
 index_name from dba_indexes where owner = 'HWSE_REG0116' and table_name in
(select distinct segment_name from dba_segments where 1=1
and SEGMENT_TYPE = 'TABLE'
and owner = 'HWSE_REG0116' and segment_name like '%#_VW' escape '#')
),
schnames as
(select * from table(select SCH_NAMES from MV_REFRESH_JOB))
select SUM(BYTES) totsize
from dba_segments where 1=1
and OWNER in (select * from schnames)
and SEGMENT_TYPE = 'INDEX'
and segment_name in (select index_name from sname);




select distinct replace(replace(replace(r, 'from', ''), '[extension]', ''), '[dblink]', '') from (
select distinct regexp_substr(COL_ASKATRUNTIMESQL, 'from(.*)\[dblink\]') r from (
select distinct lower(COL_ASKATRUNTIMESQL)  COL_ASKATRUNTIMESQL
from catcolumn where tab_code like '%@@BASE@@185'));

select * from catcolumn where tab_code like '%@@BASE@@185' and lower(COL_ASKATRUNTIMESQL)  like '%b185_election%'



select owner, sum(BYTES) totsize from dba_segments where 1=1
and OWNER in (select * from table(select SCH_NAMES from MV_REFRESH_JOB))
and SEGMENT_TYPE = 'INDEX' --'TABLE'
and segment_name like '%#_VW' escape '#'
group by rollup(owner)
order by 2;



select source_schema_name, isi_client_id from ggate.adpr_client_extensions
where target_schema_name = '&1';

-------------------------------------------------


ggate@PXS01Q> select distinct INSTANCE_NAME, FARM_NAME from wfnsys.v_client_logon
  2  where (SCHEMA_VERSION like '05%' or SCHEMA_VERSION like '06%' or SCHEMA_VERSION like '07%')
  3  order by 1;
WFC10Q_SVC1          PORTALWFN48
WFC21Q_SVC1          PORTALWFN48
WFC22Q_SVC1          PORTALWFN44
WFC26Q_SVC1          PORTALWFN44
WFC51D_SVC1          PORTALWFN43
WFC53Q_SVC1          PORTALWFN50




select * from (
select replace(upper(inst_sid), '_ADPR_SVC1', ''), login, reps, row_number() over (partition by inst_sid order by reps desc) rn from (
select bi.inst_sid, (select user_login from secuser where user_key = br.user_key) login, count(1) reps
from catclient c, batclientproduct bcp, batclientenvironment bce, batinstance bi, batreq br
where c.client_code = bcp.client_code
and bcp.client_code = bce.client_code
and c.pod_code = (select pod_code from batpod where pod_current = 't')
and bcp.prd_code = 'WFN' and bcp.ver_code = '5'
and bce.prd_code = bcp.prd_code
and bce.inst_key = bi.inst_key
and br.client_code = c.client_code
and br.req_rows > 0
and br.req_timestamp > trunc(sysdate)-30
group by bi.inst_sid, br.user_key
) where login not like '%@ADP' and login like '%@%') where rn < 4
order by 1,2;

WFC10Q_SVC1                    ADPRQA@CRUWFN5C5                                            8          3
WFC10Q_SVC1                    MJANJUA@CRUWFN5C5                                          25          1
WFC10Q_SVC1                    PRACTITIONER@ACAMARK                                        9          2
WFC21Q_SVC1                    JGOUPIL@CAFITSOW2                                           5          2
WFC21Q_SVC1                    KKOTA@ADP@CAFITSOW2                                        29          1
WFC21Q_SVC1                    RFIT41@WFNFIT41RK                                           4          3
WFC22Q_SVC1                    MJANJUAFITUA@ADP@CAFITEZLM                                  2          1
WFC22Q_SVC1                    MJANJUAFITUA@ADP@VANDERLAND                                 1          2
WFC51D_SVC1                    CREPORTS@T8V8                                              99          2
WFC51D_SVC1                    JGOUPIL5@ADP@T8V8                                          70          3
WFC51D_SVC1                    PRACTITIONER@FITWFN6                                      173          1
WFC53Q_SVC1                    DEAST@LPFEZFGK                                             11          2
WFC53Q_SVC1                    DEAST@LPFEZFGY                                             10          3
WFC53Q_SVC1                    RAVINDERWFN6@PTSJOBS                                       19          1
WFC23D                         PRACTITIONER@USAWFN5                                      274          2
WFC23D                         SCHEDUS@USAWFN5                                           454          1
WFC23D                         VEGETTO@USAWFN5                                            82          3
WFC51Q                         MJANJUAFITUA@ADP@CRUCAN5                                    3          2
WFC51Q                         SCHEDCA@CRUCAN5                                           104          1


CREATE OR REPLACE PROCEDURE P0 IS
  e_01476 EXCEPTION; pragma exception_init ( e_01476, -1476 );
BEGIN
  RAISE e_01476;
END P0;
/
--------------------------------------------

select lis_key from batreq where REQ_KEY='1415701704500';
9459
select LIS_HOST,LIS_OUTPUT_PATH from batlistener where LIS_KEY = '6935';
dc2prwfn4arwb10/11.3.250.195
/adpr/listener_adprmasprd03/xml/

dc2prwfn4arwb07:/adpr/listener_adprmasprd03/xml/14134/18226 # ls -lt 680*
-rw-r--r-- 1 www nobody  8192 May 14 13:18 680.xls
-rw-r--r-- 1 www nobody  6414 May 14 13:18 680.xml
-rw-r--r-- 1 www nobody 19965 May 14 12:38 680_definition.xml





wfp21p
cru20Q
=======
GENPAK
ADMIN
CCAS
HARMANCTEST
COMMON
GENPAKCTEST
HARMAN
CCASCTEST

CRU03Q
======
ADMIN
COMMON
ADPR01CTEST
ADPR01

select COL_LABEL from catcolumn where TAB_CODE = 'EMP_STI_HISTORY@@TMS@@10' and COL_FIELDNAME = 'AWARD_AMOUT';
select * from tms10_core_files_fields_keys where  TAB_TABLE = 'WS_EMP_STI_HIST_VW' and COL_FIELDNAME = 'AWARD_AMOUT';
update tms10_core_files_fields_keys
set rkey = 'adpr.EmployeeSTIHistory.CPD_STI_HISTORY.STI_AMT.AwardAmount' , COL_LABEL = 'Award Amount'
where COL_FIELDNAME = 'AWARD_AMOUT' and TAB_TABLE = 'WS_EMP_STI_HIST_VW';




          
 merge into adpr_client_extensions a using (select 1 as dummy from dual )s
    on (s.dummy = 1 and  a.organization_oid = 'G3ZJXWA5WE9HFJNS' and a.product_code = 'WFN' and a.product_version = '07' )
 WHEN MATCHED THEN
    UPDATE SET  migration_date =  sysdate ,cidn = 'WNVPD0026966', reg_pod_code = '0001'
          ,source_Schema_name = 'WFN41SCH000451'  ,target_Schema_name = 'WFN41SCH000451'
          ,source_repl_instance = 'WFC51Q' ,gg_macro_name = 'WFN_FIT41'
          ,isi_client_id = 'ADPRACK1' ,replicating = 'Y' ,node_code = 52 ,prod_locale = 'US'
    where organization_oid = 'G3ZJXWA5WE9HFJNS' and  product_code = 'WFN'
          and (upper(cidn) <> 'WNVPD0026966' or reg_pod_code <> '0001'
          or upper(source_Schema_name) <> 'WFN41SCH000451'  or upper(isi_client_id) <> 'ADPRACK1'
          or upper(source_repl_instance) <> 'WFC51Q' or node_code <> '52' or nvl(prod_locale,' ') <> 'US'   )
 WHEN NOT MATCHED THEN
    INSERT (a.CIDN,a.REG_POD_CODE,a.NODE_CODE,a.PRODUCT_CODE,a.PRODUCT_VERSION,a.SOURCE_REPL_INSTANCE
           ,a.SOURCE_SCHEMA_NAME,a.TARGET_SCHEMA_NAME, a.GG_MACRO_NAME
           ,a.ISI_CLIENT_ID,a.ORGANIZATION_OID,a.REPLICATING,a.MIGRATION_DATE,a.prod_locale )
    VALUES ( 'WNVPD0026966', '0001', '52' ,'WFN' , '07','WFC51Q'
            ,'WFN41SCH000451' , 'WFN41SCH000451', 'WFN_FIT41', 'ADPRACK1', 'G3ZJXWA5WE9HFJNS', 'Y', sysdate,'US') ;
 commit;
    UPDATE adpr_client_extensions  SET  migration_date =  sysdate ,replicating = 'N'
    where organization_oid ='G3ZJXWA5WE9HFJNS' and  product_code = 'WFN' and replicating = 'Y' and product_version <> '07';
    UPDATE adpr_client_extensions  SET  migration_date =  sysdate ,replicating = 'Y'
    where organization_oid ='G3ZJXWA5WE9HFJNS' and  product_code = 'WFN' and replicating = 'N' and product_version = '07';




select '[' || user_id || ']' from payx_reg01_pod79.security_user where lower(user_id) like '%sgloekler@wpacyber%';


r_isi_std_prod_sumsc2

UPDATE config_pod_mapping SET Value = regexp_replace(Value, 'CRW21P', 'CRW11P', 1, 0, 'i') WHERE Upper(Value) LIKE '%CRW21P%';
UPDATE wfn_sor_refresh_inp SET catalog_inst = 'CRW11P' WHERE Upper(catalog_inst) = 'CRW21P';
COMMIT;

----------------
uat client secuser update

MERGE INTO adprnasuat01.secuser@dblinkcru40ptocrc21u s
USING (SELECT *
       FROM   isiusers_uat
       WHERE  associate_id IS NOT NULL
              --AND isi_user_id IS NOT NULL
              AND org_id = 'G31A7X1PDAK0EC8B') a
ON (s.user_orgoid = a.org_id AND s.user_aoid = a.associate_id)
WHEN matched THEN
  UPDATE SET s.user_firstname = a.given_nm,
             s.user_lastname = a.family_nm,
             s.user_middleinitial = substr(a.middle_nm, 1, 5),
             s.user_email = a.mail;

col user_login format a40
col user_aoid format a30
col user_email format a100
select
distinct USER_LOGIN, USER_AOID, USER_EMAIL
from ADPRNASUAT01.secuser@dblinkcru40ptocrc21u
where USER_ORGOID = 'G31A7X1PDAK0EC8B'
and USER_EMAIL is not null order by 1;



select count(1) from regpod15.associate@DBLINKCRU40PTOREG11U where associate_id = 'G3YS5CKG67EJ6YAA';
create public database link DBLINKCRU40PTOREG11U
connect to ggate identified by ggate using
'(DESCRIPTION=(ADDRESS_LIST=(LOAD_BALANCE=YES)(FAILOVER=ON)(ADDRESS=(PROTOCOL=TCP)(HOST=dc2prf017db-scan.whc)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=reg11u_svc1)))';

select distinct
i.givenname ,   --> this goes to secuser.user_firstname
i.sn ,           --> this goes to secuser.user_lastname
i.adpmiddleinit ,  --> this goes to user_middleinitial
i.mail              --> this goes to user_email
from isiuser i
where upper(i.userid) = 'MFRIEDMAN@GRFS';

------------------
Running in parallel:
set time on timing on
set echo on
set linesize 300 pagesize 50000
WHENEVER SQLERROR EXIT SQL.SQLCODE

ALTER SESSION ENABLE PARALLEL DDL;
ALTER SESSION FORCE PARALLEL DDL PARALLEL 16;

/*+ opt_param('_always_semi_join','choose') */
create table secsessionval_new PARALLEL 16 as select /*+ FULL(a) */ * from secsessionval ...
alter table secsessionval_new noparallel;

alter table t add constraint idex_t primary key (..) disable;
create unique index idex_t on t(xx) tablespace INDEX1 PARALLEL 16;
alter index idex_t NOPARALLEL;
alter table idex_t enable primary key;

create index i1 on t(..) tablespace index1 parallel 16;
alter index i1 noparallel;

alter table t noparallel;

rename table t to tx;

alter index ix unusable;
update tx set col1 = null where col in (...);
commit;
alter index ix rebuild parallel 16;
alter index ix noparallel;
---------------------------------------------------
etime database ooid check:

k01yagsdf9kwpx7wfz15od90lq

select distinct coidtxt from PRSNCMMNIDENTASSIGN;
select distinct coidtxt from EF3OWNER.PRSNCMMNIDENTASSIGN;
select productversion from UR3OWNER.suiteproduct where suiteproductnm = 'WTK';

select productversion from [SCHEMA_NAME].suiteproduct where suiteproductnm='WTK';

select distinct coidtxt from EET_REG0005.PRSNCMMNIDENTASSIGN;

select SCHEMA_NAME, INSTANCE_NAME from wfnsys.client_schema where instance_name like 'wfc6%' order by 1

declare
 type tcoid is table of varchar2(100);
 lcoid tcoid;
begin
for i in (select username from all_users where username like '%OWNER' order by 1)
loop
  begin
  execute immediate 'select distinct coidtxt from ' || i.username || '.PRSNCMMNIDENTASSIGN' bulk collect into lcoid;
  for j in 1 .. lcoid.count
  loop
  dbms_output.put_line(i.username || ' : ' || lcoid(j));
  end loop;
  exception
    when others then
	  dbms_output.put_line(' .. schema error... ');
  end;
end loop;
end;
/


IPAY:
IPAY:
[dc2prcrptetl1:/export/home/infor/vijay] sqlplus appadm/ipayetl@crttvoi
[dc2prcrptetl1:/export/home/infor/vijay] tnsformat crttvoi
CRTTVOI=(DESCRIPTION =
    (ADDRESS_LIST =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 172.24.65.201)(PORT = 1521)))
    (CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = payp01)))
[dc2prcrptetl1:/export/home/infor/vijay]

-- WFN Training client zero down job
SELECT cs.client_refid, wc.organization_oid, wc.isi_client_id
  FROM WFNSYS.client_salesdemo@DBLINKCRW11DTOPYXD02 cs, WFNSYS.wfn_client@DBLINKCRW11DTOPYXD02 wc
 WHERE cs.client_refid = wc.client_refid
   AND (cs.salesdemo_type = 'TR' OR cs.salesdemo_type = 'ETR')
   AND cs.adpr_status = 'S';

   -- adprwfn41dit@crw11d
exec pkg_refresh_client.deploy_job('DBLINKCRW11DTOWFC21D, DBLINKCRW11DTOWFC22D', 1, 6);
-- ADPRMASDIT01@crw11d
exec pkg_refresh_client.deploy_job('DBLINKCRW11DTOWFC21D, DBLINKCRW11DTOWFC22D', 1, 6);


\\hpsfs01\dev\ADPR\eTime\Replication Elimination\Install

exception when others then
 dbms_output.put_line('sqlerrm: '||SQLERRM);
 dbms_output.put_line('backtrace: '||DBMS_UTILITY.FORMAT_ERROR_BACKTRACE);



col client_code format a30
col inst_sid format a15
col tmscnt format 999999
col hriicnt format 999999
select distinct b.client_code, bi.inst_sid, bi.inst_key,
(select count(1) from qryquery q, qrytable qt
where q.qry_key = qt.qry_key and qt.tab_code like '%@@TMS@@10'
and q.client_code = b.client_code) tmscnt,
(select count(1) from qryquery q, qrytable qt
where q.qry_key = qt.qry_key and qt.tab_code like '%@@HRII@@%'
and q.client_code = b.client_code) hriicnt
from batclientproduct b, batclientenvironment be, batinstance bi
where b.prd_code = 'TMS'
and b.client_code = be.client_code and be.prd_code = b.prd_code
and be.inst_key = bi.inst_key
and exists (select 1 from batclientproduct x
where x.client_code = b.client_code
and x.prd_code ='HRII') order by 1;


UPDATE qryquery SET qry_session_sql_setup = 'alter session set optimizer_features_enable=''10.2.0.4''' WHERE qry_key_versionof IN (SELECT qry_key_versionof FROM qryquery WHERE qry_key=
  (SELECT qry_key from batreq WHERE req_key = '1431725190620'));


-- Reports and files
select qq.qry_key reportkey,
       qq.qry_name reportname,
       su.user_login owner,
       qt.qrtab_key filekey,
       ct.tab_label filelabel,
       qt.qrtab_order fileorder,
       ctparent.tab_label parentfile
  from qryquery qq
inner join secuser su on su.user_key = qq.user_key
inner join qrytable qt on qt.qry_key = qq.qry_key
left join qrytable qtparent on qtparent.qrtab_key = qt.qrtab_keysup
inner join cattable ct on qt.tab_code = ct.tab_code
left join cattable ctparent on qtparent.tab_code = ctparent.tab_code
where qq.qry_active = 't'
   and qq.client_code = 'WUH'
order by qq.user_key, qq.qry_name, qt.qrtab_order

-- Reports and filters
select qq.qry_key reportkey,
       qq.qry_name reportname,
       su.user_login owner,
       cc.col_label catfield,
       qf.qrfie_label field,
       qfe.flt_operator operator,
       qfe.flt_compwith,
       qfe.flt_value value,
       qfe.flt_logoper,
       qfe.flt_casesensitive casesensitive,
       qfe.flt_dateformat dateformat,
       qar.dat_datatype,
      qar.aar_name
  from qryquery qq
inner join secuser su on su.user_key = qq.user_key
inner join qryfilterel qfe on qfe.flt_key = qq.flt_key
left join catcolumn cc on qfe.tab_code = cc.tab_code and qfe.col_code = cc.col_code
left join qryfield qf on qf.qrfie_key = qfe.qrfie_key
left join qryaskatruntime qar on qar.aar_key = qfe.aar_key
where qq.qry_active = 't'
   and qq.client_code = 'WUH'
order by qq.user_key, qq.qry_name, qfe.flt_seq

-- Report schedules
select qq.qry_key reportkey,
       qq.qry_name reportname,
       su.user_login owner,
       bs.*
  from qryquery qq
inner join secuser su on su.user_key = qq.user_key
  inner join batsched bs on bs.qry_key = qq.qry_key
where qq.qry_active = 't'
   and qq.client_code = 'WUH'
order by qq.user_key, qq.qry_name

-- Reports and dynamic joins
select qq.qry_key reportkey,
       qq.qry_name reportname,
       su.user_login owner,
       qt.qrtab_key filekey,
       ct.tab_label filelabel,
       qt.qrtab_order fileorder,
       case when qt.qrel_key is not null then 'Y' else 'N' end dynamicjoin,
       qr.tab_code_parent,
       qr.tab_code_child,
       qr.qrel_name,
       qr.qrel_freetext,
       ctparent.tab_label parentfile
  from qryquery qq
inner join secuser su on su.user_key = qq.user_key
inner join qrytable qt on qt.qry_key = qq.qry_key
left join qrytable qtparent on qtparent.qrtab_key = qt.qrtab_keysup
inner join cattable ct on qt.tab_code = ct.tab_code
left join cattable ctparent on qtparent.tab_code = ctparent.tab_code
left join qryrelat qr on qt.qrel_key = qr.qrel_key
where qq.qry_active = 't'
   and qq.client_code = 'WUH'
order by qq.user_key, qq.qry_name, qt.qrtab_order


-----------------------
Development teams efforts in supporting production client issues, IAT certification & testing issues, FIT certification and testing support issues.
It includes production regular maintenance and troubleshooting tasks like custom jobs, client config jobs, replication activities, source control, environment related code maintenance activities. etc..
Also includes time spent on researching and answering various questions that act as basis for various high-level decision making in internal/external teams.

Aetna Choice POS II CDHP with HSA - Family  75.68   VS  13.63  / 73
Aetna Dental PPO/PDN Option 2 - Family  37.43     VS    11.90  / 39
VSP - Family  11.3
hsa - 227
pai - 1m family   5.76


tUITION ASSISTANCE: 18663173409
-------------------------------

Myke on stats collection script on crh02p:

Work should be performed on crh02p – two nodes:

11.3.68.114     dc2prtgf1db05-vip.whc.dc02.us.adp
11.3.68.115     dc2prtgf1db06-vip.whc.dc02.us.adp

Here are the steps that need to be performed:

1.	Undo_retention=18000 on all instances

2.	db_cache_size minimum to 2G on all instances

3.	shared_pool_size minimum to 1G on all instances

4.	Run the following to disable default stats jobs and maint windows:
exec dbms_scheduler.disable('BSLN_MAINTAIN_STATS_JOB');
alter system set resource_manager_plan='' sid='*' scope=both;
EXEC dbms_auto_task_admin.disable( 'auto optimizer stats collection', NULL, NULL);
execute dbms_scheduler.set_attribute('WEEKNIGHT_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('WEEKEND_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('SATURDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('SUNDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('MONDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('TUESDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('WEDNESDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('THURSDAY_WINDOW','RESOURCE_PLAN','');
execute dbms_scheduler.set_attribute('FRIDAY_WINDOW','RESOURCE_PLAN','');

5.	Run the following to fix the stats for the hrb schemas (Please run them concurrently):
exec dbms_stats.gather_schema_stats(ownname=>'HRB_REG0002', cascade=>true, estimate_percent=>40, method_opt=>'FOR ALL COLUMNS SIZE 1' ,degree => 8 );
exec dbms_stats.gather_schema_stats(ownname=>'HRB_REG0001', cascade=>true, estimate_percent=>40, method_opt=>'FOR ALL COLUMNS SIZE 1' ,degree => 8 );

6.	Migrate the ADPR kill job to the new nodes.  The job can be found in the crontab for each instance of crh01p (172.24.224.60).


---------------
12967046
qry comparison templates having custom fields:
select distinct qfb.qry_key
from qryfield qf
inner join qryfield qfb on qfb.qrfie_key = qf.qrfie_key_compare
where qf.qry_key IN
('1332744251089', '1332744250880', '1332744250280', '1332744249501',
'1332744248602', '1332744248002', '1330622182752')
and qfb.col_code like '%_CST_%'


------------------------------------
IE8< AND Safari6.1 users

SELECT DISTINCT
s.client_code, s.USER_ORGOID, s.cname, s.country, s.user_login,
SubStr(userinfo, 1, InStr(userinfo, '~')-1) user_fullname,
SubStr(userinfo, InStr(userinfo, '~')+1) user_email,
 IEVERSION, s.user_aoid, s.session_id,
listagg(Decode(b.prd_code, 'WFNPAYX', '', 'WFNEZLM', '', b.prd_code), ',') within GROUP (ORDER BY 1) prds
FROM (
SELECT DISTINCT s.client_code, s.USER_ORGOID,
       (SELECT DISTINCT displayname FROM racs_r1.i_isiclient WHERE CLIENTOID = c.client_orgoid) cname,
       Decode(c.res_key, 1127, 'US', 1155, 'CA', '1680', 'XB', '1655', 'XB', '1660', 'XB', 'N/A') country,
       (SELECT GIVENNAME ||' '|| sn || '~' || mail userinfo FROM racs_r1.i_isiuser x WHERE x.associateoid = s.user_aoid) userinfo,
       s.user_login, --s.user_lastname, s.user_firstname, s.user_email,
       s.user_aoid, sv.session_id,
       (CASE
        WHEN sv.val_value LIKE '%MSIE%' THEN regexp_substr(sv.val_value, 'MSIE ....')
        WHEN sv.val_value LIKE '%Safari%' THEN regexp_substr(sv.val_value, 'Version/(.*)')
        ELSE 'N/A'
       END) ieversion
FROM webrepadmin.secuser@dblinkcru40ptocrw11p s,
	 webrepadmin.catclient@dblinkcru40ptocrw11p c,
   webrepadmin.secsessionval@dblinkcru40ptocrw11p sv,
   (SELECT user_key, Max(session_id) msession_id FROM webrepadmin.secsession@dblinkcru40ptocrw11p GROUP BY user_key) ms
WHERE s.client_code = c.client_code
AND c.pod_code = (SELECT pod_code FROM webrepadmin.batpod@dblinkcru40ptocrw11p WHERE pod_current = 't')
AND s.user_key = ms.user_key
AND ms.msession_id = sv.session_id
AND sv.val_name = 'USER_AGENT'
AND (sv.val_value LIKE '%MSIE 5.%' OR
sv.val_value LIKE '%MSIE 6.%' OR
sv.val_value LIKE '%MSIE 7.%' OR
sv.val_value LIKE '%MSIE 8.0%' OR
sv.val_value LIKE '%Version/3%Safari%' OR
sv.val_value LIKE '%Version/4%Safari%' OR
sv.val_value LIKE '%Version/5%Safari%' OR
sv.val_value LIKE '%Version/6.0%Safari%' OR
sv.val_value LIKE '%Version/6.1%Safari%'
)) s,
webrepadmin.batclientenvironment@dblinkcru40ptocrw11p b
WHERE 1=1 AND s.client_code = b.client_code
GROUP BY s.client_code, s.USER_ORGOID, s.cname, s.country, s.user_login,
SubStr(userinfo, 1, InStr(userinfo, '~')-1),
SubStr(userinfo, InStr(userinfo, '~')+1),
IEVERSION, s.user_aoid, s.session_id


----------------------------------------------------------



PAYX CLIENTS STILL REPLICATING AND CHECK IF THEY CAN BE FLIPPED:

select count(distinct c.client_code) from
webrepadmin.catclient@dblinkcru40ptocrw11p c,
webrepadmin.batclientenvironment@dblinkcru40ptocrw11p bce
where c.pod_code = 'WFN4_PROD'
and c.client_code = bce.client_code
and bce.prd_code ='PAYX2' and bce.inst_key = '20'
and exists (select 1 from ggate.curr_isi_client_load x where x.client_code = c.client_code and x.product_code = 'PAYX2')
UNION
select count(distinct c.client_code) from
ADPRMASPRD01.catclient@dblinkcru40ptocrw11p c,
ADPRMASPRD01.batclientenvironment@dblinkcru40ptocrw11p bce
where c.pod_code = 'MAS_PROD1'
and c.client_code = bce.client_code
and bce.prd_code ='PAYX2' and bce.inst_key = '20'
and exists (select 1 from ggate.curr_isi_client_load x where x.client_code = c.client_code and x.product_code = 'PAYX2')
UNION
select count(distinct c.client_code) from
ADPRMASPRD02.catclient@dblinkcru40ptocrw12p c,
ADPRMASPRD02.batclientenvironment@dblinkcru40ptocrw12p bce
where c.pod_code = 'MAS_PROD2'
and c.client_code = bce.client_code
and bce.prd_code ='PAYX2' and bce.inst_key = '20'
and exists (select 1 from ggate.curr_isi_client_load x where x.client_code = c.client_code and x.product_code = 'PAYX2')
UNION
select count(distinct c.client_code) from
ADPRMASPRD03.catclient@dblinkcru40ptocrw13p c,
ADPRMASPRD03.batclientenvironment@dblinkcru40ptocrw13p bce
where c.pod_code = 'MAS_PROD3'
and c.client_code = bce.client_code
and bce.prd_code ='PAYX2' and bce.inst_key = '20'
and exists (select 1 from ggate.curr_isi_client_load x where x.client_code = c.client_code and x.product_code = 'PAYX2')
;

------------------------------------------------------------------


select * from batportalenvironment be inner join batportalenvironmentparam bp on be.bpe_key=bp.bpe_key order by 1,2;
update batclientproduct set bpe_key=42 where  client_code='TMSFIT7';


SELECT S.NAME, V.VALUE FROM V$STATNAME S, V$MYSTAT V
WHERE S.STATISTIC# = V.STATISTIC# AND S.NAME LIKE 'parse%';

------------------------------------------------------------------
Load EZLM data to SOR.

INSERT INTO adpr_client_extensions(cidn, reg_pod_code, node_code, PRODUCT_CODE, PRODUCT_VERSION,
SOURCE_SCHEMA_NAME, SOURCE_REPL_INSTANCE,TARGET_SCHEMA_NAME,
ISI_CLIENT_ID, ORGANIZATION_OID, REPLICATING)
SELECT custid, SubStr(TARGET_SCHEMA, 9,2)||SubStr(TARGET_SCHEMA, 15,2), 'CRU10P', 'EZLM',
(CASE WHEN upper(version) LIKE '%V18%' THEN '1118'
      WHEN upper(version) LIKE '%V17%' THEN '1117'
      ELSE ''
END), DB_USERID, DB_INSTANCE, TARGET_SCHEMA, Upper(ISICLIENTID),
 c.org_id,
'Y' FROM adpr_ezlm_client aec, curr_isi_client_load c
WHERE c.product_code = 'EZLABORMANAGER'
AND c.client_code = Upper(aec.ISICLIENTID)

COMMIT;

------------------------------------------------------------------

ADPR Competitor clients...

select client_code,
	   user_login,
       req_title,
       req_timestamp,
       req_rows,
	   req_key,
listagg(ADPSERVICECENTERS, ',') within group (order by 1) sc
from (
select distinct B.client_code,
	   user_login,
       req_title,
       req_timestamp,
       req_rows,
	   req_key,
	   ADPSERVICECENTERS
  from batreq b, secuser s, racs_r1.i_isiclient@dblinkcrw11ptocru40p x
where (
(lower(req_title) like '%paychex%') or
(lower(req_title) like '%insperity%') or
(lower(req_title) like '%trinet%') or
(lower(req_title) like '%paychex%') or
(lower(req_title) like '%wageworks%') or (lower(req_title) like '%wage works%') or
(lower(req_title) like '%towerswatson%') or (lower(req_title) like '%towers watson%') or
(lower(req_title) like '%ceridian%') or
(lower(req_title) like '%ultimate%'))
and upper(x.o) = b.client_code
and b.user_key = s.user_key
and req_timestamp > sysdate - 90)
group by client_code,
	   user_login,
       req_title,
       req_timestamp,
       req_rows,
	   req_key
order by req_timestamp desc;


------------------------------------------------------------------


KIll jOB:
select 'alter system kill session ''' || sid || ',' || serial# || ',@' || inst_id || ''';' from gv$session where last_Call_et/60 > 5 and status='ACTIVE' and module not like '%lis_key%' and username like 'ADPR%';

High CPU usage:
sar 3 5
select s.username,s.machine,s.status,s.sql_id,s.sid,logon_time from v$session s, v$process p where s.paddr=p.addr and p.spid in (15114,37064,5363,5414,5576);

select SQL_TEXT from gv$sql where SQL_ID='79mbjc78gywx1' ;

----------------------------------------------------------------------


WFN lock:
update wfn_client set mig_status='C' where vpd_key='^^vpd_key' and (mig_status<>'C' or mig_status is null);
UNLOCK:
mig_status='M'


DATABASE_FARM_MAP
client_schema


SELECT prn, Sum(d) FROM (
SELECT client_code, prn, d, Rank() OVER (PARTITION BY client_code ORDER BY d DESC) rnk FROM (
SELECT client_code, prn, Count(1) d FROM (
SELECT client_code, qry_key_source, Ntile(6) OVER (ORDER BY client_code, qry_key_source) prn FROM (
SELECT a.client_code, a.MIGRATION_TYPE, a.acm_key, ad.QRY_KEY_SOURCE, ad.qry_key_target,
a.MIG_START_DT, a.MIG_END_DT, Trunc(((a.mig_end_dt-a.mig_start_dt))*24*60*60) migdur
--ad.QRY_COPY_START_DT, ad.QRY_COPY_END_DT, Trunc((ad.QRY_COPY_END_DT-ad.QRY_COPY_START_DT)*24*60*60*1000) copytime_ms,
--ad.QRY_MIG_START_DT, ad.QRY_MIG_END_DT, trunc((ad.QRY_MIG_END_DT-ad.QRY_MIG_START_DT)*24*60*60*1000) migtime_ms,
--Trunc( ((ad.QRY_COPY_END_DT-ad.QRY_COPY_START_DT) + (ad.QRY_MIG_END_DT-ad.QRY_MIG_START_DT)) *24*60*60*1000) totmigtime_ms
FROM admclientmigration a JOIN admclientmigrationdetail ad ON (a.acm_key = ad.acm_key)
WHERE 1=1 --AND a.client_code = '1SMARTIE' --AND a.acm_key = '63107'
AND a.migration_type = 'CUSTOM'
AND a.create_date BETWEEN
To_Date('03/21/2015 07:05:00', 'MM/DD/YYYY HH24:MI:SS') AND To_Date('03/21/2015 08:20:00', 'MM/DD/YYYY HH24:MI:SS')
)) GROUP BY client_code, prn )) --WHERE rnk = 1 --ORDER BY 1,2,3
 GROUP BY prn



pf202 Troubleshooting:

begin dbadm.CR_SET_SCHEMA_CONTEXT ('G3CJYHS1CH5BRJ3H','BMORGAN_TO8P'); execute immediate 'alter session set "_always_semi_join"=choose'; end;
/

SELECT OWNERID FROM PS.PSDBOWNER WHERE CLIENT_OID = 'G3CJYHS1CH5BRJ3H';
SELECT RPTACCESS FROM TO8P.PSOPRDEFN WHERE oprid = 'BMORGAN';

--------------------------
-------------------------
NAS Customs:
NAS custom updates always comes through xls spreadsheets.
Custom to be deployed new version as well.. Migration.
-------------------------


iPAY Clients:

select count(distinct org_id) from regcom.all_client_sc_product@DBLINKCRU40PTOREG11PDG p
WHERE p.PRODUCT='iPay' and p.PRODUCT_STATUS = 'active'
and exists (select 1 from t_org_flag t where
t.org_id = p.org_id and upper(t.flag_id) like '%TEST%');

on 4/15/15: 676 test and 133486 real clients are having active iPay product.


flag=`echo $a|awk '{print match($0,"pass")}'`;
if [ $flag -gt 0 ];then


echo "$a" | grep "pass" && (echo "Found.";exit 0) || (echo "Not found.";exit 1)

if [ `echo $a | grep -c "pass" ` -gt 0 ]
then
  echo "Success"





conn skipvpd/skipvpdadpadp@wfc63p_svc1

SET DEFINE '^'

SET SERVEROUTPUT ON SIZE UNLIMITED
SET VERIFY OFF ECHO OFF FEED on LINESIZE 1000 TRIMSPOOL ON

DEFINE CLIENTKEY=G254VP97EPMFA7Q5
DEFINE TGTVPDKEY=PAYXSCH0101986
DEFINE ADPRLINK=ADPRX
DEFINE TGTSCH=WFN6SCH008030
DEFINE PARENT_CODE=1TK
DEFINE REGION=0036
DEFINE CLIENT_REFID=434373
DEFINE WORKFLOW_ID=3602864_30205

PROMPT Setting variables...
BEGIN
    DBMS_OUTPUT.PUT_LINE('CLIENT KEY  : ^^CLIENTKEY') ;
    DBMS_OUTPUT.PUT_LINE('DB Link Name   : ^^ADPRLINK') ;
    DBMS_OUTPUT.PUT_LINE('Target Schema  : ^^TGTSCH') ;
    DBMS_OUTPUT.PUT_LINE('Target VPD Key : ^^TGTVPDKEY') ;
    DBMS_OUTPUT.PUT_LINE('Parent Code  : ^^PARENT_CODE') ;
    DBMS_OUTPUT.PUT_LINE('Selling Region : ^^REGION') ;
    DBMS_OUTPUT.PUT_LINE('client_refid : ^^client_refid') ;
    DBMS_OUTPUT.PUT_LINE('workflow_id : ^^workflow_id') ;
    ^^TGTSCH..sp_set_vpd_ctx('SRCVPDKEY', 'ADP - Upgrade') ;
    ^^TGTSCH..sp_set_app_ctx(spv_bypass_all_trig => 'Y') ;
END ;
/



=========================
running notes:
Breath from belly
Exhale out forcefully
Flight time and cover distance in flight
Knee lift for strong leading knee
Butt kick for rear leg rotation
Land with vertical knee to feet
Dont over extend the forward feet.. instead let the knee lead all the way.
Use upper arms for back and forth movement instead of lower arm / hands. Keep steady wrist.
Breath in whlile you take off and exhale while loading
Slight forward lean from feet - no bending at hip..
Drive movement from hip, keep it stable
Look ahead - not down
Lead with knee, Feet landing close to body, under the flexing knee and loading under body
==================================

BSM ALERTS Troubleshooting sqls:

select osuser, count(*) from gv$session where status = 'ACTIVE' group by osuser;

select req_key ||','|| req_timestamp from batreq where req_timestamp>trunc(sysdate) and req_status = 'RUN';
select client_identifier||','||module||','||action||','||last_call_et||','||SQL_EXEC_START||','||status from gv$session where osuser not in ('www') and status = 'ACTIVE';

select req_key||','||req_timestamp||','||req_status from batreq where req_timestamp>sysdate-(1/24);

col user_login format a50
select b.req_status, count(1)
select b.req_key , b.req_timestamp, b.req_status
from batreq b, secuser s
where b.user_key = s.user_key
and b.req_timestamp > sysdate - (1/24)
and s.user_login = 'PRODVANTAGEUSER@VANBVT2'
group by b.req_status order by 1;

col user_login format a50
select s.user_login, count(1)
from secsession s
where s.SESSION_TIMESTAMP > sysdate - (1/24)
group by s.user_login order by 1;

select b.req_key , b.req_timestamp, b.req_status
from batreq b, secuser s
where b.user_key = s.user_key
and b.req_timestamp > sysdate - (3/24)
and s.user_login = 'BPMUSERADPR@ADPRWFN8C3'
order by 2;

PROD 1 = BPMUserADPR@ADPRWFN8C3
BPMUSERADPR@ADPRWFN8C3
BPMUSERADPR@C06P0075


m03:
BPMUSERADPR@ADPRWFN8C6
BPMUSERADPR@WEEK3ADPR

SELECT sample_time||','||sql_id||','||sql_exec_start||','||event||','||SESSION_state||','||BLOCKING_SESSION_STATUS
||','||program||','||MODULE||','||action||','||client_id||','||machine
FROM v$active_session_history
WHERE sample_time > sysdate-50/(24*60)
--and user_login = 'PRODVANTAGEUSER@VANBVT2'
--AND program LIKE '%rman%'
--and sample_time BETWEEN To_Date('07/10/2015 00:00:00', 'MM/DD/YYYY HH24:MI:SS') AND To_Date('07/10/2015 00:05:00', 'MM/DD/YYYY HH24:MI:SS')
-- AND event LIKE '%enq: TX - row lock contention%'
ORDER BY 1;

select sql_id, last_call_et from gv$session where (last_call_et/60/60)>1 and status = 'ACTIVE' and osuser = 'www';

select osuser||','||sql_id ||','|| to_char(SQL_EXEC_START, 'MM/DD/YYYY HH24:MI:SS')||','|| to_char(PREV_EXEC_START, 'MM/DD/YYYY HH24:MI:SS')||','|| MODULE||','|| ACTION||','|| CLIENT_INFO||','|| BLOCKING_SESSION_STATUS||','||event
 from gv$session where osuser not in ('oracle') and status = 'ACTIVE' order by 1;


 =============================
 create procedure put_line (
                 string_in IN VARCHAR2,
                 split_in  IN PLS_INTEGER DEFAULT 255
                 ) as
begin
   for i in 1 .. ceil(length(string_in)/split_in) loop
      dbms_output.put_line(substr(string_in,split_in*(i-1)+1,split_in));
   end loop;
end;
/

create or replace public synonym put_line for put_line;
grant execute on put_line to public;

==============================

Migration package location:
\\Hpsfs01\DEV\ADPR\MIG\r12\ADPR.04.038.PKGCLIMIG.12.00



merge into nasclientsreg n
using (
select client_code, org_id, listagg(region_code, ',') within group (order by 1) region_code from (
SELECT distinct upper(o.ISI_ORG_CD) client_code , O.ORG_ID, okva.value region_code
FROM regpod11.ORG@DBLINKCRU40PTOREG11PDG O,
     regpod11.ORG_ROLE@DBLINKCRU40PTOREG11PDG ORL,
     --isi_reg11.org_key_value_autopay okva,
     regpod11.prov_sys_key@DBLINKCRU40PTOREG11PDG psk,
     regpod11.org_key_value@DBLINKCRU40PTOREG11PDG okva,
     regpod11.app_property@DBLINKCRU40PTOREG11PDG ap,
     regcom.org_location@DBLINKCRU40PTOREG11PDG ol
WHERE ol.pod_nm = ap.value
AND ap.name ='POD_NM'
and ol.org_id = o.org_id
AND o.data_valid = 'Y'
and o.org_id = orl.org_id
and orl.ORG_ROLE_ID = okva.org_role_id
AND psk.PROV_SYS_KEY_ID = okva.prov_sys_key_id
AND psk.key_nm = 'Region Code'
AND upper(o.isi_org_cd) in ( select client_code from nasclientsreg)
) group by client_code, org_id
)r
on (n.client_code = r.client_code)
when matched then
  update set n.region = r.region_code;



exec dbms_Stats.RESTORE_TABLE_STATS('HRB_REG0002','EV_CHANGE',to_timestamp('08-14-2015 00:00','MM-DD-YYYY HH24:MI'));
SELECT 'alter system kill session ''' || sid || ',' || serial# ||',' ||'@'||inst_id||''' immediate;'
from gv$session where username='ADPR_CRUVPD' and status='ACTIVE' and last_Call_Et/60  > 20;
select 'alter system kill session ''' || a.sid || ',' || a.serial# ||',' ||'@'||a.inst_id||''' immediate;' from gv$session a, dba_objects b
where a.event like '%scattered%' and a.username='ADPR_CRUVPD' and a.status='ACTIVE' and a.ROW_WAIT_OBJ#=b.object_id and b.owner='HRB_REG0002' and b.object_name='EV_CHANGE';

-------------------

HWSE clients on NAS Q instances:

select be.client_code from batclientenvironment be
where be.BCE_DBLINK_VALUE = '@DBLINK2CRU'
and be.prd_code = 'BASE'
and exists (select 1 from batinstance bi, batclientenvironment be1
where be1.inst_key = bi.inst_key
and be.client_code = be1.client_code
and bi.INST_SHORTNAME like '%Q');

-------------------

GG changes in IAT:

ACS:
	stop extract GXPRT21s
	stop mgr
	Take backup and modify extract prm file gxprt21s.prm with host entry:
	RMTHOST 11.1.153.48
	start mgr
	start extract GXPRT21S

EZLM:
	stop extract GXZC030S
	stop mgr
	Take backup and modify extract prm file gxzc030s.prm with host entry:
	RMTHOST 11.1.153.48
	start mgr
	start extract GRZC030S

	stop extract GXZC030S
	stop mgr
	Take backup and modify extract prm file gxzc001s.prm with host entry:
	RMTHOST 11.1.153.48
	start mgr
	start extract GRZC001S


TOTALSOURCE:
	stop TS extract GXPEOS01
	stop mgr
	Take backup and modify extract prm file gxpeos01.prm with host entry:
	RMTHOST 11.1.153.48
	start mgr
	start TS extract GXPEOS01


365 -> Gajuwaka
265 ->	Pattabhireddy
200 -> 9500
300sq yards, 5500/sq yard
RK Shanmuka ventures
------------------------------------------

git calls:

Configure Git for the first time

git config --global user.name "Canakala, Vijaya (CORP)"
git config --global user.email "Vijaya.Canakala@adp.com"

Working with your repository
I just want to clone this repository
If you want to simply clone this empty repository then run this command in your terminal.

git clone https://CanakalV@cdlprttnstash01.es.ad.adp.com/scm/ad/adpr_payx.git

My code is ready to be pushed
If you already have code ready to be pushed to this repository then run this in your terminal.

cd existing-project
git init
git add --all
git commit -m "Initial Commit"
git remote add origin https://CanakalV@cdlprttnstash01.es.ad.adp.com/scm/ad/adpr_payx.git
git push origin master

My code is already tracked by Git
If your code is already tracked by Git then set this repository as your "origin" to push to.
cd existing-project
git remote set-url origin https://CanakalV@cdlprttnstash01.es.ad.adp.com/scm/ad/adpr_payx.git
git push origin master

------------------


CREATE TABLE WFN_V_CLIENT_LOGON2 TABLESPACE data1
AS SELECT * FROM wfnsys.v_client_logon@dblinkcru40ptopxs01p
WHERE id_code = parent_code;


-- Below clients should be set to Replication side because they have multi-vpd keys
SELECT * FROM adpr_client_extensions WHERE organization_oid IN (
SELECT ORGANIZATION_OID-- vpd_key,
--Count(1)
FROM (
SELECT CLIENT_NAME,ORGANIZATION_OID, SCHEMA_NAME, INSTANCE_NAME, VPD_KEY
FROM V_CLIENT_LOGON_LOCAL2
WHERE SCHEMA_VERSION LIKE '18.5%' AND id_code = parent_code)
GROUP BY  ORGANIZATION_OID--, vpd_key
HAVING Count(1)>1
) AND product_code = 'PAYX2'
AND source_enabled = 'Y'





#2
-- Below clients can be on source side but not yet set to source side:
INSERT INTO t(c)
SELECT DISTINCT ORGANIZATION_OID FROM adpr_client_extensions sor WHERE organization_oid IN (
SELECT ORGANIZATION_OID-- vpd_key,
--Count(1)
FROM (
SELECT CLIENT_NAME,ORGANIZATION_OID, SCHEMA_NAME, INSTANCE_NAME, VPD_KEY
FROM V_CLIENT_LOGON_LOCAL2
WHERE SCHEMA_VERSION LIKE '18.5%' AND id_code = parent_code)
GROUP BY  ORGANIZATION_OID--, vpd_key
HAVING Count(1)=1
) AND product_code = 'PAYX2'
AND source_enabled = 'N'
AND NOT EXISTS (SELECT 1 FROM WFN_V_CLIENT_LOGON2 x
WHERE sor.organization_oid = x.organization_oid AND pod_id LIKE 'PORTALWFN%')
AND EXISTS (SELECT 1 FROM curr_isi_client_load x
WHERE sor.organization_oid = x.org_id AND x.product_code = 'CRT')


merge INTO t
USING (SELECT DISTINCT org_id, client_code FROM curr_isi_client_load) c
ON (t.c = c.org_id)
WHEN matched THEN
UPDATE SET t.o=c.CLIENT_CODE;



#3
-- mark below clients enabled for SOURCE side in the nightly job:

SELECT client_code--, client_orgoid
FROM webrepadmin.catclient@dblinkcru40ptocrw11p WHERE client_orgoid IN
--SELECT Count(1) FROM
(
SELECT --c.client_code,
c.client_orgoid
FROM webrepadmin.batclientenvironment@dblinkcru40ptocrw11p b,
     webrepadmin.catclient@dblinkcru40ptocrw11p c
WHERE b.inst_key = 20 AND b.prd_code = 'PAYX2' AND c.pod_code IN ('WFN4_PROD', 'MAS_PROD1', 'MAS_PROD2', 'MAS_PROD3')
AND b.client_code = c.client_code AND c.client_orgoid IS NOT NULL
INTERSECT
SELECT ORGANIZATION_OID
FROM (
SELECT --CLIENT_NAME,ORGANIZATION_OID, SCHEMA_NAME, INSTANCE_NAME, VPD_KEY
 ORGANIZATION_OID, VPD_KEY
 FROM V_CLIENT_LOGON_LOCAL2
WHERE SCHEMA_VERSION LIKE '18.5%' AND id_code = parent_code AND instance_name LIKE 'px%')
GROUP BY  ORGANIZATION_OID
HAVING Count(1)=1
) ORDER BY 1;


-----------------------------------------

Query to get: all reports with all numeric fields with the advanced grouping set to Total

select qq.qry_key, qq.qry_name, qq.qry_title, su.user_login
  from qryquery qq
  inner join secuser su on qq.user_key = su.user_key
where qq.client_code = 'HORMELFOOD'
   and qq.qry_active = 't'
   and exists (select 1 from qryfield where qry_key = qq.qry_key and qrfie_aggregate = 'SUM');


--------------------------------------------


TMPFILE=tmp.tmp
rm -f $TMPFILE
while read db
do

echo "exit" | sqlplus -L adpr_cruvpd/cruvpd@$db | grep Connected > /dev/null
if [ $? -ne 0 ]
then
  #echo "Failed to connect $db ...."
  continue;
fi
sqlplus -s adpr_cruvpd/cruvpd@$db<<! >> $TMPFILE
set head off pages 0 lines 120 echo off verify off feedback off timing off
SELECT DISTINCT --object_name,
    '$db' ||' '||
    replace(substr(object_name,1,instr(object_name, '_')-1), 'WF', '')  ||' '||
    substr(object_name, -4)
FROM user_objects WHERE regexp_like(object_name, 'WF9_TIMEOFF_BALANCE.*(\d{4})$') order by 1;
!
done < fit_db.list

while read db wfnver extn
do
echo "Installing WFN${wfnver} code on db: ${db} region: ${extn}"
logfile=install_wf9_timeoff_balance_${db}_${extn}.log
sqlplus -s adpr_cruvpd/cruvpd@${db}<<! | tee -a $logfile
@wf9_timeoff_balance.sql ${extn}
show errors
!
done < $TMPFILE

echo "Installation Complete"

---------------------------------------------------

On Catcolumn
When you have col_label_oriented = ‘f’ then application will use the KEY
When you have col_label_oriented = ‘t’ then application will use the VALUE

-----------------------------------------------------



OBA long reports:


col tab_code form a50
col avgduration form 999999
col maxduration form 999999
col minduration form 999999
col countreports form 999999
col durationband form a15
col "% of Reports" form a15
col "# Reports" form 999999
col hr form 99999
col "Duration Band" form a20
set lines 160
break on tab_code skip 1
with wfnReportsTimings as 
(
select distinct b.req_key, b.qry_key, --, b.tab_code,
    (select 
 trunc(abs( extract( second from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) 
          + extract( minute from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 
          + extract( hour from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 * 60 
          + extract( day from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 * 60 * 24
            ))
     from batreqlog brl where b.req_key = brl.req_key) duration
from (
select distinct b.req_key, b.qry_key--, qt.tab_code
from batreq b, qrytable qt
where b.qry_key = qt.qry_key --and b.req_status = 'OK'
and qt.tab_code like '%@@OBA@@8'
and b.req_timestamp > trunc(sysdate)-100) b
) 
select durationband "Duration Band", cnt "# Reports", trunc(ratio_to_report(sum(cnt)) over () * 100) || '%' "% of Reports"
from (
select durationband, count(1) cnt from (
select req_key, (case when duration<120 then '0. < 2  min'
                      when duration<300 then  '1.  2-5  min'
                      when duration<1800 then '2.  5-30 min'
                      when duration<3600 then '3. 30-60 min'
                      when duration<7200 then '4.  1-2 hour'
                      when duration<14400 then '5.  2-4 hour'  
                      else                    '6.  > 4 hour' 
                  end) durationband from wfnReportsTimings 
) group by durationband
    ) group by durationband, cnt order by 1;
    
------

col "% of Reports" form a15
col "# Reports" form 999999
col hr form 99999
col "Duration Band" form a20
set lines 120
with wfnReportsTimings as 
(
select distinct b.req_key, b.qry_key, hr, --, b.tab_code,
    (select 
 trunc(abs( extract( second from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) 
          + extract( minute from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 
          + extract( hour from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 * 60 
          + extract( day from (max(brl.rlog_timestamp)-min(brl.rlog_timestamp))  ) * 60 * 60 * 24
            ))
     from batreqlog brl where b.req_key = brl.req_key) duration
from (
select distinct b.req_key, b.qry_key, extract(hour from req_timestamp) hr
from batreq b, qrytable qt
where b.qry_key = qt.qry_key --and b.req_status = 'OK'
and qt.tab_code like '%@@OBA@@8'
and b.req_timestamp > trunc(sysdate)-100) b
) 
select durationband "Duration Band", hr,  cnt "# Reports", trunc(ratio_to_report(sum(cnt)) over () * 100, 2) || '%' "% of Reports"
from (
select durationband, hr, count(1) cnt from (
select req_key, hr, (case when duration<120 then '0. < 2  min'
                      when duration<300 then  '1.  2-5  min'
                      when duration<1800 then '2.  5-30 min'
                      when duration<3600 then '3. 30-60 min'
                      when duration<7200 then '4.  1-2 hour'
                      when duration<14400 then '5.  2-4 hour'  
                      else                    '6.  > 4 hour'   
                  end) durationband from wfnReportsTimings 
) group by durationband, hr
    ) group by durationband, hr, cnt order by 1,2;
    
    
    
    
-----------------------

We are using the below logic  for WFN clients to check if they are eligible for “Comp HR” Benefit.
 
(SELECT  CLIENT_OID ooid,1 as COMP_HR FROM PAASDP001_PORTAL.portal_CLIENT_product@DBLINKCRU40PTOpsw2x01p  where product_id in ( 190, 191,225)
UNION
SELECT  CLIENT_OID ooid,1 as COMP_HR FROM PAASDP002_PORTAL.portal_CLIENT_product@DBLINKCRU40PTOpsw2x01p  where product_id in ( 190, 191,225)
UNION
SELECT  CLIENT_OID ooid,1 as COMP_HR FROM PAASDP003_PORTAL.portal_CLIENT_product@DBLINKCRU40PTOpsw2x01p  where product_id in ( 190, 191,225)
UNION
SELECT  CLIENT_OID ooid,1 as COMP_HR FROM PAASDP004_PORTAL.portal_CLIENT_product@DBLINKCRU40PTOpsw2x01p  where product_id in ( 190, 191,225))
 

https://wfn-fit.nj.adp.com/
pFITADPR10@FITADPR10/adpadp10

practitioner@wfn11xbdsr



------------------



WFN Referenced Objects

 WITH refitems1 AS (SELECT /*+ materialize */ DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE name LIKE 'WF11%0007' AND REFERENCED_OWNER = 'ADPR_CRUVPD'
  AND REFERENCED_TYPE!='SYNONYM')
 ,refitems2 AS (SELECT /*+ materialize */  DISTINCT  REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND name IN (SELECT * FROM refitems1)
  AND REFERENCED_TYPE!='SYNONYM'
 )
 ,refitems3 AS (SELECT /*+ materialize */  DISTINCT  REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND name IN (SELECT * FROM refitems2)
  AND REFERENCED_TYPE!='SYNONYM'
 )
 ,all_ref_syns AS (
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND REFERENCED_TYPE = 'SYNONYM'
  AND name IN (SELECT * FROM refitems2)
 UNION
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND REFERENCED_TYPE = 'SYNONYM'
  AND name IN (SELECT * FROM refitems1) 
 UNION
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE name LIKE 'WF11%0007' AND REFERENCED_OWNER = 'ADPR_CRUVPD'
  AND REFERENCED_TYPE='SYNONYM'
)
 ,wfnobjrefs AS (SELECT DISTINCT us.synonym_name, us.table_name, ao.object_type FROM user_synonyms us, all_objects ao
 WHERE us.synonym_name IN (SELECT * FROM all_ref_syns)
 AND us.table_name = ao.object_name AND ao.owner = us.table_owner
 AND object_type = 'VIEW')
SELECT DISTINCT REFERENCED_OWNER, referenced_name, REFERENCED_TYPE FROM all_dependencies WHERE owner = 'WFN9SCH000053' 
AND name IN (SELECT table_name FROM wfnobjrefs) AND REFERENCED_OWNER NOT IN ('SYS')
AND REFERENCED_TYPE != 'TABLE'







 WITH refitems1 AS (SELECT /*+ materialize */ DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE name LIKE 'WF11%0007' AND REFERENCED_OWNER = 'ADPR_CRUVPD'
  AND REFERENCED_TYPE!='SYNONYM')
 ,refitems2 AS (SELECT /*+ materialize */  DISTINCT  REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND name IN (SELECT * FROM refitems1)
  AND REFERENCED_TYPE!='SYNONYM'
 )
 ,refitems3 AS (SELECT /*+ materialize */  DISTINCT  REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND name IN (SELECT * FROM refitems2)
  AND REFERENCED_TYPE!='SYNONYM'
 )
 ,all_ref_syns AS (
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND REFERENCED_TYPE = 'SYNONYM'
  AND name IN (SELECT * FROM refitems2)
 UNION
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND REFERENCED_TYPE = 'SYNONYM'
  AND name IN (SELECT * FROM refitems1) 
 UNION
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE name LIKE 'WF11%0007' AND REFERENCED_OWNER = 'ADPR_CRUVPD'
  AND REFERENCED_TYPE='SYNONYM'
)
 ,wfnobjrefs1 AS (SELECT /*+ materialize */ 
  DISTINCT us.synonym_name, us.table_name, ao.object_type FROM user_synonyms us, all_objects ao
 WHERE us.synonym_name IN (SELECT * FROM all_ref_syns)
 AND us.table_name = ao.object_name AND ao.owner = us.table_owner
 )
 ,wfnobjrefs2 AS (SELECT /*+ materialize */  DISTINCT   REFERENCED_OWNER, referenced_name, REFERENCED_TYPE
  FROM all_dependencies WHERE owner = 'WFN9SCH000053'  
  AND name IN (SELECT table_name FROM wfnobjrefs1 WHERE object_type = 'VIEW') AND REFERENCED_OWNER NOT IN ('SYS')
 )
 ,wfnobjrefs3 AS (SELECT /*+ materialize */  DISTINCT   REFERENCED_OWNER, referenced_name, REFERENCED_TYPE
  FROM all_dependencies WHERE owner = 'WFN9SCH000053'  
  AND name IN (SELECT REFERENCED_NAME FROM wfnobjrefs2 WHERE REFERENCED_TYPE!='TABLE' AND REFERENCED_OWNER != 'PUBLIC') 
  AND REFERENCED_OWNER NOT IN ('SYS')
 )
 ,wfnobjrefs4 AS (SELECT /*+ materialize */  DISTINCT   REFERENCED_OWNER, referenced_name, REFERENCED_TYPE
  FROM all_dependencies WHERE owner = 'WFN9SCH000053'  
  AND name IN (SELECT REFERENCED_NAME FROM wfnobjrefs3 WHERE REFERENCED_TYPE!='TABLE' AND REFERENCED_OWNER != 'PUBLIC') 
  AND REFERENCED_OWNER NOT IN ('SYS')
 )
 SELECT '4' depth, REFERENCED_NAME, REFERENCED_TYPE FROM wfnobjrefs4 WHERE REFERENCED_TYPE LIKE 'TABLE%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT '3' depth, REFERENCED_NAME, REFERENCED_TYPE FROM wfnobjrefs3 WHERE REFERENCED_TYPE like 'TABLE%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT '2' depth, REFERENCED_NAME, REFERENCED_TYPE FROM wfnobjrefs2 WHERE REFERENCED_TYPE like 'TABLE%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT '1' depth, table_name, object_type FROM wfnobjrefs1 WHERE object_type like 'TABLE%'  and object_type not likE '%PARTITION%';
 
 
to get list of dependent objects for wfn-adpr:

 WITH refitems1 AS (SELECT /*+ materialize */ DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE name LIKE 'WF11%0007' AND REFERENCED_OWNER = 'ADPR_CRUVPD'
  AND REFERENCED_TYPE!='SYNONYM')
 ,refitems2 AS (SELECT /*+ materialize */  DISTINCT  REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND name IN (SELECT * FROM refitems1)
  AND REFERENCED_TYPE!='SYNONYM'
 )
 ,refitems3 AS (SELECT /*+ materialize */  DISTINCT  REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND name IN (SELECT * FROM refitems2)
  AND REFERENCED_TYPE!='SYNONYM'
 )
 ,all_ref_syns AS (
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND REFERENCED_TYPE = 'SYNONYM'
  AND name IN (SELECT * FROM refitems2)
 UNION
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE  REFERENCED_OWNER = 'ADPR_CRUVPD' AND REFERENCED_TYPE = 'SYNONYM'
  AND name IN (SELECT * FROM refitems1) 
 UNION
 SELECT DISTINCT REFERENCED_NAME FROM user_dependencies 
  WHERE name LIKE 'WF11%0007' AND REFERENCED_OWNER = 'ADPR_CRUVPD'
  AND REFERENCED_TYPE='SYNONYM'
)
 ,wfnobjrefs1 AS (SELECT /*+ materialize */ 
  DISTINCT us.synonym_name, us.table_name, ao.object_type FROM user_synonyms us, all_objects ao
 WHERE us.synonym_name IN (SELECT * FROM all_ref_syns)
 AND us.table_name = ao.object_name AND ao.owner = us.table_owner
 )
 ,wfnobjrefs2 AS (SELECT /*+ materialize */  DISTINCT   REFERENCED_OWNER, referenced_name, REFERENCED_TYPE
  FROM all_dependencies WHERE owner = 'WFN9SCH000053'  
  AND name IN (SELECT table_name FROM wfnobjrefs1 WHERE object_type = 'VIEW') AND REFERENCED_OWNER NOT IN ('SYS')
 )
 ,wfnobjrefs3 AS (SELECT /*+ materialize */  DISTINCT   REFERENCED_OWNER, referenced_name, REFERENCED_TYPE
  FROM all_dependencies WHERE owner = 'WFN9SCH000053'  
  AND name IN (SELECT REFERENCED_NAME FROM wfnobjrefs2 WHERE REFERENCED_TYPE!='TABLE' AND REFERENCED_OWNER != 'PUBLIC') 
  AND REFERENCED_OWNER NOT IN ('SYS')
 )
 ,wfnobjrefs4 AS (SELECT /*+ materialize */  DISTINCT   REFERENCED_OWNER, referenced_name, REFERENCED_TYPE
  FROM all_dependencies WHERE owner = 'WFN9SCH000053'  
  AND name IN (SELECT REFERENCED_NAME FROM wfnobjrefs3 WHERE REFERENCED_TYPE!='TABLE' AND REFERENCED_OWNER != 'PUBLIC') 
  AND REFERENCED_OWNER NOT IN ('SYS')
 )
/* SELECT  depth, REFERENCED_NAME, REFERENCED_TYPE FROM wfnobjrefs4 WHERE REFERENCED_TYPE  LIKE 'VIEW%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT  depth, REFERENCED_NAME, REFERENCED_TYPE FROM wfnobjrefs3 WHERE REFERENCED_TYPE  like 'VIEW%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT depth, REFERENCED_NAME, REFERENCED_TYPE FROM wfnobjrefs2 WHERE REFERENCED_TYPE  LIKE 'VIEW%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT depth, table_name, object_type FROM wfnobjrefs1 WHERE object_type  like 'VIEW%'  and object_type not likE '%PARTITION%' */
 SELECT '<tr><td>4</td><td>'||REFERENCED_NAME||'</td><td>'||REFERENCED_TYPE||'</td></tr>' FROM wfnobjrefs4 WHERE REFERENCED_TYPE  LIKE 'VIEW%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT '<tr><td>3</td><td>'||REFERENCED_NAME||'</td><td>'||REFERENCED_TYPE||'</td></tr>' FROM wfnobjrefs3 WHERE REFERENCED_TYPE  like 'VIEW%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT '<tr><td>2</td><td>'||REFERENCED_NAME||'</td><td>'||REFERENCED_TYPE||'</td></tr>' FROM wfnobjrefs2 WHERE REFERENCED_TYPE  LIKE 'VIEW%' and REFERENCED_TYPE not likE '%PARTITION%'
 UNION
 SELECT '<tr><td>1</td><td>'||table_name||'</td><td>'||object_type||'</td></tr>' FROM wfnobjrefs1 WHERE object_type  like 'VIEW%'  and object_type not likE '%PARTITION%'
 ORDER BY 1;
 
 
 
 
 

 subject:"\Internal\*"
subject:DBaaS
subject:"shift POC"
subject:"Major Accounts R&D Certification"
subject:"Automated P2Q"
from:no-reply-reporting@adp.com
from:datacloud_alerts_hosted@adp.com
from:performance_notifications@adp.com
from:adp.data.cloud.eng
from:adpi_engineering@adp.com
subject:PaaS
from:migrationcentral@adp.com
subject:"ADP Generated Message:Activation Code for Administrators"
from:root@
from:McMaster, Michael

col tab1 format a30
col tab2 form a30
col cnt form 999999999
with x as (
select /*+ materialize */ distinct q.qry_key, c.tab_table 
from qrytable qt join cattable c on (qt.tab_code = c.tab_code)
join qryquery q on (qt.qry_key = q.qry_key)
where q.qry_datetime > trunc(sysdate)-3
and qt.tab_code like '%@@WFN@@11'
--and q.qry_key = '1626315835180'
)
,y as (
 select qry_key, tab_table, count(1)  over (partition by qry_key) from x
)
,z as (select tab1, tab2, cnt, (case when tab1<tab2 then tab1 else tab2 end) || (case when tab1>tab2 then tab1 else tab2 end) k from (
select y1.tab_table tab1, y2.tab_table tab2 --, y3.tab_table
, count(1) cnt from y y1, y y2 --, y y3
where y1.tab_table != y2.tab_table --and y1.tab_table != y3.tab_table and y2.tab_table != y3.tab_table
and y1.qry_key = y2.qry_key --and y2.qry_key = y3.qry_key
group by y1.tab_table, y2.tab_table --, y3.tab_table
--order by 3 desc, 1,2
) where rownum < 1000)
select * from (
select tab1, tab2, cnt, 
  rank() over (partition by k order by tab1) rnk
from z )
where rnk =1
order by 3 desc, 1,2;




cri03q 
adpidmcore01

Here is one DB that has star schema.
jdbc:oracle:thin:@Ctclbtaf3-scan.es.ad.adp.com:1521/cri05y_svc123
user: adpidmcore05/dw1ipe70



t_ev_sec
  t_dim_paygroup
  t_dim_orgn
t_dim_ev_sec
t_brdg_empl_rpt_to_hrchy

  mgr  -- direct/indiret employee hierarchy


declare
  type vatype is varray(5) of varchar2(30);
  tablist vatype;
  objowner vatype;
  vstr varchar2(4000);
  vcnt1 pls_integer;
  vcnt2 pls_integer;
begin
  tablist := vatype('HRB_OPTION', 'HRB_PLAN', 'OPTION_REL');
  objowner := vatype('HRB_REG0001', 'HRB_REG0002');
  for j in 1 .. objowner.count loop
  for i in 1 .. tablist.count loop
    vstr := 'select /*+ parallel(x default) */ count(1) from ' || objowner(j) ||'.'|| tablist(i);
    execute immediate vstr into vcnt1;
    vstr := 'select num_rows from all_tables where owner=''' || objowner(j) ||''' and table_name='''|| tablist(i) || '''';
    execute immediate vstr into vcnt2;
    dbms_output.put_line(objowner(j) || '.' || tablist(i) || '  ' || vcnt1 || ' ' || vcnt2);
  end loop;
  end loop;
end;
/


===================================================
To reset a FIT user, you can go to http://ewalletfit.ws.nj.adp.com:8080/wfconsole/common/ArWFBasicIndex.jsp and then navigate to ‘ArcotID > Issuance > Enable’ and then enter the user ID, click on enable.

The user will get reset with the last working password.

For the latest password, please refer to confluence: https://confluence.es.ad.adp.com/display/AR/Vantage+Users



select * from (
(select rank() over (partition by a.key) order by decode(a.key, 't', 1, 2), a.m desc) rnk,
a.* from mytable a where a.userid = 'myuserid'
) where rnk =1

